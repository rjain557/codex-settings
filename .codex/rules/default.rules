prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse commands\\gsd | Select-Object FullName,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\gsd-runner.ps1; $c[560..760] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem codex,scripts\\gsd-runner-codex.ps1 | Format-Table FullName,Length -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = @('scripts\\gsd-runner-codex.ps1','codex\\setupgsd.ps1'); foreach ($f in $files) { $tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path $f), [ref]$tokens, [ref]$errors) | Out-Null; if ($errors -and $errors.Count -gt 0) { Write-Output \"PARSE_FAIL: $f\"; $errors | ForEach-Object { Write-Output (\"  \" + $_.Message) } } else { Write-Output \"PARSE_OK: $f\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path 'setup-codex-global.ps1'), [ref]$tokens, [ref]$errors) | Out-Null; if ($errors -and $errors.Count -gt 0) { 'PARSE_FAIL'; $errors | ForEach-Object { $_.Message } } else { 'PARSE_OK' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Generating Codex headless runner|Installing upgraded SDLC Codex runner|Set-Content -Path \\$RunnerPath|\\$runner = @'|\\$profilePath = \\$PROFILE\" setup-codex-global.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Invoke-FullReview|Invoke-RemediationPhaseGeneration|Invoke-ParallelPreparation|Invoke-SequentialExecution|verify-phase|while \\(\\$iteration -lt \\$MaxIterations\\)|Test-StopCondition|/gsd:execute-phase|/gsd:batch-execute|/gsd:code-review\" scripts\\gsd-runner-codex.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('scripts\\gsd-runner-codex.ps1','setup-codex-global.ps1'); foreach($f in $files){$t=$null;$e=$null;[System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path $f),[ref]$t,[ref]$e)|Out-Null; if($e -and $e.Count -gt 0){\"PARSE_FAIL: $f\"; $e|%{$_.Message}} else {\"PARSE_OK: $f\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Test-Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; Get-Item \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -ErrorAction SilentlyContinue | Select-Object FullName,Length,LastWriteTime | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p1=$PROFILE.CurrentUserAllHosts; $p2=$PROFILE.CurrentUserCurrentHost; Write-Output \"CUAH=$p1\"; Write-Output \"CUCH=$p2\"; if(Test-Path $p1){Write-Output '--- CUAH content ---'; Get-Content $p1 -Tail 80}; if(Test-Path $p2){Write-Output '--- CUCH content ---'; Get-Content $p2 -Tail 80}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item setup-codex-global.ps1,scripts\\gsd-runner-codex.ps1 -ErrorAction SilentlyContinue | Select-Object FullName,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Command codex -All | Select-Object Source,Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "where.exe codex"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:APPDATA\\npm\" -Filter \"codex*\" -ErrorAction SilentlyContinue | Select-Object FullName,Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "npm config get prefix; npm bin -g"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "powershell -ExecutionPolicy Bypass -File .\\setup-codex-global.ps1 -Force"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", ". $PROFILE.CurrentUserAllHosts; Get-Command gsd-codex; Test-Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item -Path \"scripts\\gsd-runner-codex.ps1\" -Destination \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -Force; . $PROFILE.CurrentUserAllHosts; gsd-codex -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -Pattern \"missing exit code|stdout\" -CaseSensitive"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -Tail 140"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$tmp = Join-Path $env:TEMP \"codex-preflight-test.txt\"; Set-Content -Path $tmp -Value \"Reply with exactly: ok\" -Encoding UTF8; $out = Join-Path $env:TEMP \"codex-preflight-test.out\"; $err = Join-Path $env:TEMP \"codex-preflight-test.err\"; if (Test-Path $out){Remove-Item $out -Force}; if (Test-Path $err){Remove-Item $err -Force}; $codex = \"C:\\Users\\rjain\\.vscode\\extensions\\openai.chatgpt-0.4.74-win32-x64\\bin\\windows-x86_64\\codex.exe\"; $cmd = \"type `\"$tmp`\" | `\"$codex`\" exec - --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --cd `\"$PWD`\"\"; $p = Start-Process -FilePath \"cmd.exe\" -ArgumentList \"/c\", $cmd -NoNewWindow -PassThru -RedirectStandardOutput $out -RedirectStandardError $err; $p.WaitForExit(); $ec = $p.ExitCode; $ecType = if ($null -eq $ec) {\"<null>\"} else {$ec.GetType().FullName}; $outSize = if (Test-Path $out) {(Get-Item $out).Length} else {0}; Write-Output \"ExitCode=$ec\"; Write-Output \"ExitCodeType=$ecType\"; Write-Output \"OutSize=$outSize\"; if (Test-Path $out){Write-Output \"--- OUT ---\"; Get-Content $out -Tail 20}; if (Test-Path $err){Write-Output \"--- ERR ---\"; Get-Content $err -Tail 20}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item -Path \"scripts\\gsd-runner-codex.ps1\" -Destination \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -Force; . $PROFILE.CurrentUserAllHosts; $cwd=Get-Location; if (Test-Path .planning\\ROADMAP.md) { gsd-codex -DryRun } else { Write-Output 'NO_GSD_PROJECT_IN_CURRENT_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Mode,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File .planning | Sort-Object LastWriteTime -Descending | Select-Object -First 40 FullName,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File docs\\review | Sort-Object LastWriteTime -Descending | Select-Object FullName,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output\\code-review-iter-1-*.stdout | Sort-Object LastWriteTime -Descending | Select-Object -First 3 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File bbc-leadgen | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force bbc-leadgen | Select-Object Name,Mode,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --show-toplevel"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Directory -Force | Where-Object { $_.FullName -notmatch 'node_modules|\\\\.git' } | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .gitignore) { Get-Content .gitignore }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "New-Item -ItemType Directory -Force src,data,data\\raw,data\\output,artifacts,artifacts\\debug | Out-Null"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Move-Item -Force scrape-plancheck.js src\\scrape-plancheck.js; Move-Item -Force api-responses.json data\\raw\\api-responses.json; Move-Item -Force search-request-body.json data\\raw\\search-request-body.json; Move-Item -Force plan-check-all.json data\\output\\plan-check-all.json; Move-Item -Force plan-check-active.json data\\output\\plan-check-active.json; Move-Item -Force plan-check-active.csv data\\output\\plan-check-active.csv; Move-Item -Force plan-check-results.json data\\output\\plan-check-results.json; Move-Item -Force debug-*.png artifacts\\debug\\; Move-Item -Force debug-page-source.html artifacts\\debug\\"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Depth 2 data,artifacts,src | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check src\\scrape-plancheck.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:APPDATA\\npm\" -Filter \"*playwright*\" -ErrorAction SilentlyContinue | Select-Object Name,FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "where.exe playwright"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "where.exe npx"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "playwright-mcp --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Force \"lead\\laguna.beach\" | Select-Object FullName,Name,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg --files \"lead\\laguna.beach\" } else { Get-ChildItem -Recurse -File \"lead\\laguna.beach\" | ForEach-Object { $_.FullName } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"^#|^##|^###|Address|Property|Owner|Email|Phone|APN|Beds|Bath|Sq|Price|Additional|Notes|Info|Website|Parcel|Zillow|Redfin\" \"lead\\laguna.beach\\02-18-26.md\" } else { Select-String -Path \"lead\\laguna.beach\\02-18-26.md\" -Pattern \"^#|^##|^###|Address|Property|Owner|Email|Phone|APN|Beds|Bath|Sq|Price|Additional|Notes|Info|Website|Parcel|Zillow|Redfin\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"lead\\laguna.beach\\02-18-26.md\"; $start=228; $end=[Math]::Min($c.Length-1, 320); $c[$start..$end]"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg --files data lead src | Sort-Object } else { Get-ChildItem -Recurse -File data,lead,src | ForEach-Object { $_.FullName } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"plan-check-active|architect|applicant|owner|parcel|apn|laguna\" data lead src } else { Get-ChildItem -Recurse -File data,lead,src | Select-String -Pattern \"plan-check-active|architect|applicant|owner|parcel|apn|laguna\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$r=Invoke-WebRequest -UseBasicParsing \"https://lagunabeachgis.net/PublicAccess/!samples/sample-cq/index.html\"; $r.Content | Select-Object -First 1; ($r.Links | Select-Object href | Format-Table -AutoSize | Out-String)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Invoke-WebRequest -UseBasicParsing \"https://lagunabeachgis.net/PublicAccess/!obpa/obpa_dependencies.js\" | Select-Object -ExpandProperty Content | Set-Content -Path \"$env:TEMP\\obpa_dependencies.js\"; Write-Output \"$env:TEMP\\obpa_dependencies.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Invoke-WebRequest -UseBasicParsing \"https://lagunabeachgis.net/PublicAccess/!obpa/obpa_app.js\" | Select-Object -ExpandProperty Content | Set-Content -Path \"$env:TEMP\\obpa_app.js\"; Write-Output \"$env:TEMP\\obpa_app.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:TEMP\\obpa_app.js\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"https?://|/PublicAccess|search|query|hitlist|documents|api|obpa\" \"$env:TEMP\\obpa_app.js\" \"$env:TEMP\\obpa_dependencies.js\" } else { Select-String -Path \"$env:TEMP\\obpa_app.js\",\"$env:TEMP\\obpa_dependencies.js\" -Pattern \"https?://|/PublicAccess|search|query|hitlist|documents|api|obpa\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"docName|fullText|tryDocumentUri|getDocumentUri|searchPanel|document-hitlist|config|endpoint|baseUrl|api\" \"$env:TEMP\\obpa_app.js\" } else { Select-String -Path \"$env:TEMP\\obpa_app.js\" -Pattern \"docName|fullText|tryDocumentUri|getDocumentUri|searchPanel|document-hitlist|config|endpoint|baseUrl|api\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -o \"[A-Za-z0-9_./!-]*obpa[A-Za-z0-9_./!-]*|[A-Za-z0-9_./!-]*PublicAccess[A-Za-z0-9_./!-]*|[A-Za-z0-9_./!-]*/api/[A-Za-z0-9_./!-]*|[A-Za-z0-9_./!-]*search[A-Za-z0-9_./!-]*|[A-Za-z0-9_./!-]*query[A-Za-z0-9_./!-]*\" \"$env:TEMP\\obpa_app.js\" | Sort-Object -Unique | Select-Object -First 300 } else { Write-Output \"rg not found\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Invoke-WebRequest -UseBasicParsing \"https://lagunabeachgis.net/PublicAccess/!samples/sample-cq/obpa-config.json\" | Select-Object -ExpandProperty Content"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://lagunabeachgis.net/PublicAccess/api'; try { $r=Invoke-WebRequest -UseBasicParsing $u; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(1200,$r.Content.Length)) } catch { $_.Exception.Message }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$urls=@('https://lagunabeachgis.net/PublicAccess/api/','https://lagunabeachgis.net/PublicAccess/!api','https://lagunabeachgis.net/PublicAccess/!api/','https://lagunabeachgis.net/PublicAccess/!obpa/api','https://lagunabeachgis.net/PublicAccess/!obpa-api'); foreach($u in $urls){ try { $r=Invoke-WebRequest -UseBasicParsing $u -Method Head; Write-Output \"$u`t$($r.StatusCode)\" } catch { if($_.Exception.Response){ Write-Output \"$u`t$([int]$_.Exception.Response.StatusCode)\" } else { Write-Output \"$u`tERR\" } } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://lagunabeachgis.net/PublicAccess/'; $r=Invoke-WebRequest -UseBasicParsing $u; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length))"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('/PublicAccess/api/config','/PublicAccess/api/queries','/PublicAccess/api/query','/PublicAccess/api/customqueries','/PublicAccess/api/custom-queries','/PublicAccess/api/doctypes','/PublicAccess/api/documenttypes','/PublicAccess/api/documents','/PublicAccess/api/search','/PublicAccess/api/fulltext','/PublicAccess/api/status','/PublicAccess/api/version','/PublicAccess/api/swagger','/PublicAccess/api/swagger/index.html','/PublicAccess/swagger','/PublicAccess/swagger/index.html','/PublicAccess/!obpa/obpa-config.json'); foreach($p in $paths){ $u='https://lagunabeachgis.net'+$p; try { $r=Invoke-WebRequest -UseBasicParsing $u -Method Get -TimeoutSec 15; Write-Output \"$p`t$($r.StatusCode)`t$($r.Content.Substring(0,[Math]::Min(120,$r.Content.Length)).Replace(\"`n\",' ').Replace(\"`r\",' '))\" } catch { if($_.Exception.Response){ $resp=$_.Exception.Response; $code=[int]$resp.StatusCode; Write-Output \"$p`t$code\" } else { Write-Output \"$p`tERR\" } } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/Search.aspx?repo=r-1645a77d&searchcommand=%7BLF%3ABasic%20~%3D%20%22ZPC-2024-1613%22%2C%20option%3D%22DFANLT%22%7D'; $r=Invoke-WebRequest -UseBasicParsing $u; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(2500,$r.Content.Length))"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Invoke-WebRequest -UseBasicParsing \"https://portal.laserfiche.com/Portal/app/dist/search/main.js?v=11.0.2512.1384\" | Select-Object -ExpandProperty Content | Set-Content -Path \"$env:TEMP\\lf_main.js\"; Write-Output \"$env:TEMP\\lf_main.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -o \"[A-Za-z0-9_./:-]*\\.asmx[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*/api/[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Search[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Entry[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Document[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Weblink[A-Za-z0-9_./:?=&-]*\" \"$env:TEMP\\lf_main.js\" | Sort-Object -Unique | Select-Object -First 400 } else { Write-Output \"rg not found\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem $env:TEMP -Filter \"lf_main.js*\" | Select-Object FullName,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -o \"[A-Za-z0-9_./:-]*\\.asmx[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*/api/[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Search[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Entry[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Document[A-Za-z0-9_./:?=&-]*|[A-Za-z0-9_./:-]*Weblink[A-Za-z0-9_./:?=&-]*\" \"$env:TEMP\\lf_main.js\" | Sort-Object -Unique | Select-Object -First 300"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/HasSearchRights'; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body '{}'; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(500,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body.Substring(0,[Math]::Min(500,$body.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $keys=@('SearchService.aspx/HasSearchRights','SearchService.aspx/GetSearchListing','SearchService.aspx/GetSearchListingIds','SearchService.aspx/GetEntryLinks','SharedService.aspx/GetSearchSettings','FolderListingService.aspx/GetQuickSearchQuery'); foreach($k in $keys){ $i=$c.IndexOf($k); if($i -ge 0){ $s=[Math]::Max(0,$i-220); $len=[Math]::Min(700,$c.Length-$s); \"--- $k ---\"; $c.Substring($s,$len) } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/HasSearchRights'; $body='{\"repoName\":\"r-1645a77d\"}'; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2 } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListingIds'; $syn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; $body=@{repoName='r-1645a77d'; searchSyn=$syn; searchUuid=''} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(1200,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(1200,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/FolderListingService.aspx/GetQuickSearchQuery'; $body=@{repoName='r-1645a77d'; input='ZPC-2024-1613'; folderId=-1} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2 } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $syn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; $uuid=[guid]::NewGuid().ToString(); $body=@{repoName='r-1645a77d'; searchSyn=$syn; searchUuid=$uuid; sortColumn=''; startIdx=1; endIdx=50; getNewListing=$true; sortOrder='ASC'; displayInGridView=$true } | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(3000,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $pattern='getSearchResults\\('; $idx=0; $count=0; while(($i=$c.IndexOf($pattern,$idx)) -ge 0 -and $count -lt 12){ $s=[Math]::Max(0,$i-260); $len=[Math]::Min(900,$c.Length-$s); \"--- match $count at $i ---\"; $c.Substring($s,$len); $idx=$i+$pattern.Length; $count++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $pattern='__breach'; $idx=0; $k=0; while(($i=$c.IndexOf($pattern,$idx)) -ge 0 -and $k -lt 10){ $s=[Math]::Max(0,$i-260); $len=[Math]::Min(900,$c.Length-$s); \"--- breach match $k at $i ---\"; $c.Substring($s,$len); $idx=$i+$pattern.Length; $k++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/getCurrentLocations'; $body=@{repoName='r-1645a77d'} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(1500,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(1500,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SharedService.aspx/GetSearchSettings'; $body=@{repoName='r-1645a77d'} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(2500,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(2500,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetGeneralSearchOptions'; $body=@{repoName='r-1645a77d'} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(3000,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"breach|Breach|__breach|x-b|X-B\" \"$env:TEMP\\lf_main.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"searchUuid|sortColumn|startIdx|endIdx|getNewListing|sortOrder|displayInGridView|GetSearchListingIds|GetSearchListing\" \"$env:TEMP\\lf_main.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$raw=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $fmt=$raw -replace '},','},`n' -replace ';',';`n'; Set-Content \"$env:TEMP\\lf_main_fmt.js\" $fmt; rg -n \"GetSearchListing|GetSearchListingIds|submitEvent\\(|searchUuid|startIdx|endIdx|sortOrder|displayInGridView|getNewListing\" \"$env:TEMP\\lf_main_fmt.js\" | Select-Object -First 120"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $syn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; $obj=[ordered]@{repoName='r-1645a77d'; searchSyn=$syn; searchUuid=$null; sortColumn=0; startIdx=0; endIdx=20; getNewListing=$true; sortOrder=0; displayInGridView=$true}; $body=$obj|ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr = New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body2=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $body2.Substring(0,[Math]::Min(3000,$body2.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$headers=@{\"X-Requested-With\"=\"XMLHttpRequest\"}; $u1='https://portal.laserfiche.com/Portal/SearchService.aspx/GetGeneralSearchOptions'; $b1='{\"repoName\":\"r-1645a77d\"}'; $r1=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u1 -ContentType 'application/json; charset=utf-8' -Body $b1 -Headers $headers; $j1=$r1.Content|ConvertFrom-Json; $token=$j1.__breach; \"token=$token\"; $headers['__breach']=$token; $u2='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListingIds'; $syn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; $body2=@{repoName='r-1645a77d'; searchSyn=$syn; searchUuid=''} | ConvertTo-Json -Compress; try { $r2=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u2 -ContentType 'application/json; charset=utf-8' -Body $body2 -Headers $headers; \"Status2: $($r2.StatusCode)\"; $r2.Content } catch { if($_.Exception.Response){ $sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $body=$sr.ReadToEnd(); \"ERR2 $([int]$_.Exception.Response.StatusCode)\"; $body } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/Search.aspx?repo=r-1645a77d&searchcommand=%7BLF%3ABasic%20~%3D%20%22ZPC-2024-1613%22%2C%20option%3D%22DFANLT%22%7D'; $r=Invoke-WebRequest -UseBasicParsing $u; if($r.Content -match 'ZPC-2024-1613'){ 'found term in html' } else {'not found term in html'}; if($r.Content -match 'repoName'){ 'found repoName' }; ($r.Content | Select-String -Pattern 'searchcommand|repoName|searchSyn|__INITIAL|window\\.|var\\s+[A-Za-z_]+\\s*=|dataStore|settings|json' -AllMatches).Matches.Value | Select-Object -First 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/Search.aspx?repo=r-1645a77d&searchcommand=%7BLF%3ABasic%20~%3D%20%22ZPC-2024-1613%22%2C%20option%3D%22DFANLT%22%7D'; $r=Invoke-WebRequest -UseBasicParsing $u; $c=$r.Content; $idx=$c.IndexOf('repoName'); if($idx -ge 0){ $s=[Math]::Max(0,$idx-800); $len=[Math]::Min(2200,$c.Length-$s); $c.Substring($s,$len) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node -e \"try{require('playwright'); console.log('playwright-ok')}catch(e){console.log('no-playwright')}\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/FolderListingService.aspx/GetDocumentInfo'; $body=@{repoName='r-1645a77d'; dId=204118} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $b=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $b.Substring(0,[Math]::Min(3000,$b.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -o \"FolderListingService\\.aspx/[A-Za-z0-9_]+\" \"$env:TEMP\\lf_main.js\" | Sort-Object -Unique"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/FolderListingService.aspx/GetMetaData'; $body=@{repoName='r-1645a77d'; id=204118; folderId=204118} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(4000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $b=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $b.Substring(0,[Math]::Min(4000,$b.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $k='FolderListingService.aspx/GetMetaData'; $i=$c.IndexOf($k); if($i -ge 0){ $s=[Math]::Max(0,$i-260); $len=[Math]::Min(900,$c.Length-$s); $c.Substring($s,$len)}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/FolderListingService.aspx/GetMetaData'; $body=@{repoName='r-1645a77d'; entryId=204118} | ConvertTo-Json -Compress; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -ContentType 'application/json; charset=utf-8' -Body $body -Headers @{\"X-Requested-With\"=\"XMLHttpRequest\"}; \"Status: $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(4000,$r.Content.Length)) } catch { if($_.Exception.Response){ $sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $b=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $b.Substring(0,[Math]::Min(4000,$b.Length)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; foreach($k in @('GetFolderListing2','GetFolderListingIds','GetFolderListing','GetRootFolderId')){ $i=$c.IndexOf(\"FolderListingService.aspx/$k\"); if($i -ge 0){ \"---$k---\"; $s=[Math]::Max(0,$i-280); $len=[Math]::Min(1000,$c.Length-$s); $c.Substring($s,$len) } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$h=@{\"X-Requested-With\"=\"XMLHttpRequest\";\"X-Lf-Suppress-Login-Redirect\"=\"1\"}; $u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListingIds'; $syn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; $body=@{repoName='r-1645a77d'; searchSyn=$syn; searchUuid=''}|ConvertTo-Json -Compress; try{$r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -ContentType 'application/json; charset=utf-8' -Body $body; \"Status $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(3000,$r.Content.Length))} catch { if($_.Exception.Response){$sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream());$b=$sr.ReadToEnd();\"ERR $([int]$_.Exception.Response.StatusCode)\";$b.Substring(0,[Math]::Min(3000,$b.Length))} else { $_.Exception.Message }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $i=$c.IndexOf('SearchService.aspx/GetAllTags'); if($i -ge 0){ $s=[Math]::Max(0,$i-500); $len=[Math]::Min(1400,$c.Length-$s); $c.Substring($s,$len)}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; $i=$c.IndexOf('getTemplateData(e)'); if($i -ge 0){ $s=[Math]::Max(0,$i-1300); $len=[Math]::Min(2200,$c.Length-$s); $c.Substring($s,$len)}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$h=@{\"X-Lf-Suppress-Login-Redirect\"=\"1\"}; $u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $body=@{repoName='r-1645a77d'; searchSyn=''; searchUuid=''; sortColumn='Relevance'; startIdx=0; endIdx=30; getNewListing=$true; sortOrder='Descending'; displayInGridView=$true }|ConvertTo-Json -Compress; try{$r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -ContentType 'application/json; charset=utf-8' -Body $body; \"Status $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(2500,$r.Content.Length))} catch { if($_.Exception.Response){$sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream());$b=$sr.ReadToEnd();\"ERR $([int]$_.Exception.Response.StatusCode)\";$b.Substring(0,[Math]::Min(2500,$b.Length))} else { $_.Exception.Message }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$h=@{\"X-Lf-Suppress-Login-Redirect\"=\"1\"}; $u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListingIds'; $body=@{repoName='r-1645a77d'; searchSyn=''; searchUuid=''}|ConvertTo-Json -Compress; try{$r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -ContentType 'application/json; charset=utf-8' -Body $body; \"Status $($r.StatusCode)\"; $r.Content.Substring(0,[Math]::Min(2000,$r.Content.Length))} catch { if($_.Exception.Response){$sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream());$b=$sr.ReadToEnd();\"ERR $([int]$_.Exception.Response.StatusCode)\";$b.Substring(0,[Math]::Min(2000,$b.Length))} else { $_.Exception.Message }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'C:\\Users\\rjain\\.claude\\skills') { Get-ChildItem -Recurse -Force 'C:\\Users\\rjain\\.claude\\skills' | Select-Object FullName,Name,Mode,Length | Format-Table -AutoSize } else { 'NO_SKILLS_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; sortColumn=''; startIdx=0; endIdx=200; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; try { $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; \"Status: $($r.StatusCode)\"; $j=$r.Content | ConvertFrom-Json; \"Command: $($j.data.command)\"; \"Count: $($j.data.count)\"; \"Keys: $((($j.data | Get-Member -MemberType NoteProperty).Name -join ', '))\"; \"Sample listing keys: $((($j.data.listing[0] | Get-Member -MemberType NoteProperty).Name -join ', '))\"; } catch { if($_.Exception.Response){ $sr=New-Object IO.StreamReader($_.Exception.Response.GetResponseStream()); $b=$sr.ReadToEnd(); \"ERR $([int]$_.Exception.Response.StatusCode)\"; $b.Substring(0,[Math]::Min($b.Length,1200)) } else { $_.Exception.Message } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn='{LF:Basic ~= \"ZPC-2024-1613\", option=\"DFANLT\"}'; sortColumn=''; startIdx=0; endIdx=120; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; $j=$r.Content|ConvertFrom-Json; \"searchUUID=$($j.data.searchUUID)\"; \"hitCount=$($j.data.hitCount)\"; \"resultsType=$($j.data.results.GetType().FullName)\"; if($j.data.results){ \"resultsCount=$($j.data.results.Count)\"; \"firstResultRaw:\"; ($j.data.results[0] | ConvertTo-Json -Depth 8) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $apn='641-163-38'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn=\"{LF:Basic ~= \\\"$apn\\\", option=\\\"DFANLT\\\"}\"; sortColumn=''; startIdx=0; endIdx=200; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; $j=$r.Content|ConvertFrom-Json; \"hitCount=$($j.data.hitCount)\"; $results=@($j.data.results); $match=$results | Where-Object { $_.metadata -and (($_.metadata | Where-Object { $_.name -eq 'APN' -and $_.values -contains $apn }).Count -gt 0) }; \"apnMatches=$($match.Count)\"; $fieldNames = $match | ForEach-Object { $_.metadata | ForEach-Object { $_.name } } | Sort-Object -Unique; \"fields:\"; $fieldNames; \"templates:\"; ($match | ForEach-Object { $_.data[18] } | Sort-Object -Unique)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $apn='641-163-38'; $syn='{LF:Basic ~= \"' + $apn + '\", option=\"DFANLT\"}'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn=$syn; sortColumn=''; startIdx=0; endIdx=200; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; $j=$r.Content|ConvertFrom-Json; \"hitCount=$($j.data.hitCount)\"; $results=@($j.data.results); $match=$results | Where-Object { $_.metadata -and (($_.metadata | Where-Object { $_.name -eq 'APN' -and $_.values -contains $apn }).Count -gt 0) }; \"apnMatches=$($match.Count)\"; $fieldNames = $match | ForEach-Object { $_.metadata | ForEach-Object { $_.name } } | Sort-Object -Unique; 'fields:'; $fieldNames; 'templates:'; ($match | ForEach-Object { $_.data[18] } | Sort-Object -Unique)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $apn='641-163-38'; $syn='{LF:Basic ~= \"' + $apn + '\", option=\"DFANLT\"}'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn=$syn; sortColumn=''; startIdx=0; endIdx=20; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $j=((Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload).Content|ConvertFrom-Json); \"hitCount=$($j.data.hitCount)\"; for($i=0;$i -lt [Math]::Min(5,@($j.data.results).Count);$i++){ $r=$j.data.results[$i]; \"--- $i ---\"; \"name=$($r.name) entryId=$($r.entryId) template=$($r.data[18])\"; \"dataCols=\" + ($r.data -join ' | '); \"metaFields=\" + (($r.metadata | ForEach-Object { $_.name + ':' + ($_.values -join ',') }) -join ' || ') }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/FolderListingService.aspx/GetFolderListing2'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $payload=[ordered]@{repoName='r-1645a77d'; folderId=212961; getNewListing=$true; start=0; end=200; sortColumn=''; sortAscending=$true } | ConvertTo-Json -Compress; $j=((Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload -TimeoutSec 120).Content|ConvertFrom-Json); \"err=$($j.data.err) count=$($j.data.entryInfos.Count)\"; if($j.data.entryInfos.Count -gt 0){ $e=$j.data.entryInfos[0]; \"first name=$($e.name) id=$($e.id) type=$($e.type) template=$($e.templateName)\"; \"meta sample=\" + (($e.fieldInfos | ForEach-Object { $_.fieldName + ':' + (($_.values -join ',') ) }) -join ' || ') }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:TEMP\\lf_main.js\" -Raw; foreach($k in @('GetTextHtmlForPage','GetBasicDocumentInfo','GetContextHitListing','GetDocViewerSettings')){ $i=$c.IndexOf(\"DocumentService.aspx/$k\"); if($i -ge 0){ \"---$k---\"; $s=[Math]::Max(0,$i-350); $len=[Math]::Min(1300,$c.Length-$s); $c.Substring($s,$len) } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $u='https://portal.laserfiche.com/Portal/DocumentService.aspx/GetBasicDocumentInfo'; $payload=@{repoName='r-1645a77d'; entryId=223300} | ConvertTo-Json -Compress; $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; $j=$r.Content|ConvertFrom-Json; ($j.data | ConvertTo-Json -Depth 6)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $u='https://portal.laserfiche.com/Portal/DocumentService.aspx/GetTextHtmlForPage'; $payload=[ordered]@{repoName='r-1645a77d'; documentId=223300; pageNum=1; showAnn=$false; searchUuid=''} | ConvertTo-Json -Compress; $r=Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload; $j=$r.Content|ConvertFrom-Json; \"len=$($j.data.Length)\"; $txt = ($j.data -replace '<[^>]+>',' ' -replace '&nbsp;',' ' -replace '\\s+',' '); $txt.Substring(0,[Math]::Min(2000,$txt.Length))"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$u='https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $q='641-163-38 architect'; $syn='{LF:Basic ~= \"' + $q + '\", option=\"DFANLT\"}'; $payload=[ordered]@{repoName='r-1645a77d'; searchSyn=$syn; sortColumn=''; startIdx=0; endIdx=10; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $j=((Invoke-WebRequest -UseBasicParsing -Method Post -Uri $u -Headers $h -Body $payload -TimeoutSec 120).Content|ConvertFrom-Json); \"hitCount=$($j.data.hitCount)\"; for($i=0;$i -lt [Math]::Min(5,@($j.data.results).Count);$i++){ $r=$j.data.results[$i]; \"--- $i name=$($r.name) apn=$($r.data[6]) id=$($r.entryId)\"; if($r.contexthits){ ($r.contexthits | Select-Object -First 2 | ForEach-Object { $_.Context }) } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c = Get-Content 'C:\\Users\\rjain\\.claude\\commands\\gsd\\new-project.md' -Raw; if($c -match '(?s)<objective>\\s*(.*?)\\s*</objective>'){ 'MATCH'; $matches[1] } else {'NO_MATCH'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$tag='objective'; $pat = \"(?s)<$tag>\\\\s*(.*?)\\\\s*</$tag>\"; $pat"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem '.agents/skills' -Directory | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-ChildItem '.agents/skills' -Directory | Measure-Object).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem '.agents/skills' -Recurse -File -Filter SKILL.md | Select-String -Pattern '\\$ARGUMENTS|\\$1|\\$2|\\$3' | Select-Object Path,LineNumber,Line | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='.agents/skills/gsd-auto-dev/SKILL.md'; $t=Get-Content $p -Raw; $nameOk=($t -match '(?m)^name:\\s*gsd-auto-dev\\s*$'); $descOk=($t -match '(?m)^description:\\s*.+$'); $folderOk=(Split-Path (Split-Path $p -Parent) -Leaf) -eq 'gsd-auto-dev'; \"NAME_OK=$nameOk\"; \"DESC_OK=$descOk\"; \"FOLDER_OK=$folderOk\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force 'C:\\Users\\rjain\\.codex\\skills' | Select-Object Name,Mode,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Directory '.agents/skills' | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$lines=Get-Content 'lead\\laguna.beach\\02-18-26.md'; $in=$false; $rows=@(); foreach($ln in $lines){ if($ln -match '^## Contact Enrichment Checklist'){ $in=$true; continue }; if($in -and $ln -match '^---\\s*$'){ break }; if(-not $in){ continue }; if($ln -match '^\\|\\s*(.+?)\\s*\\|\\s*(ZPC-[0-9-]+)\\s*\\|\\s*([0-9\\-]+)\\s*\\|'){ $rows += [pscustomobject]@{Address=$matches[1].Trim();APN=$matches[3].Trim()} } }; \"rows=$($rows.Count)\"; $rows|Select-Object -First 3|ConvertTo-Json"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'C:\\Users\\rjain\\.codex\\skills' -Directory | Where-Object { $_.Name -like 'gsd-*' } | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-ChildItem -Path 'C:\\Users\\rjain\\.codex\\skills' -Directory | Where-Object { $_.Name -like 'gsd-*' } | Measure-Object).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$base='https://portal.laserfiche.com/Portal'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $apn='496-136-11'; $syn='{LF:Basic ~= \"'+$apn+' architect\", option=\"DFANLT\"}'; $b=[ordered]@{repoName='r-1645a77d';searchSyn=$syn;sortColumn='';startIdx=0;endIdx=25;getNewListing=$true;sortOrder=2;displayInGridView=$true}|ConvertTo-Json -Compress; $data=((Invoke-WebRequest -UseBasicParsing -Method Post -Uri ($base+'/SearchService.aspx/GetSearchListing') -Headers $h -Body $b -TimeoutSec 120).Content|ConvertFrom-Json).data; \"hits=$($data.hitCount)\"; $res=@($data.results)|Where-Object{$_.data[6]-replace '\\s+','' -eq $apn}; \"res=$($res.Count)\"; foreach($e in ($res|Select-Object -First 3)){ \"name=$($e.name)\"; foreach($ctx in @($e.contexthits|Select-Object -First 4)){ if($ctx.Context -match '(?i)architect'){ $ctx.Context } } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$base='https://portal.laserfiche.com/Portal'; $h=@{'Content-Type'='application/json';'X-Lf-Suppress-Login-Redirect'='1'}; $apn='056-204-06'; $syn='{LF:Basic ~= \"'+$apn+' architect\", option=\"DFANLT\"}'; $b=[ordered]@{repoName='r-1645a77d';searchSyn=$syn;sortColumn='';startIdx=0;endIdx=25;getNewListing=$true;sortOrder=2;displayInGridView=$true}|ConvertTo-Json -Compress; $data=((Invoke-WebRequest -UseBasicParsing -Method Post -Uri ($base+'/SearchService.aspx/GetSearchListing') -Headers $h -Body $b -TimeoutSec 120).Content|ConvertFrom-Json).data; foreach($e in @($data.results|Select-Object -First 8)){ foreach($ctx in @($e.contexthits|Select-Object -First 5)){ if($ctx.Context -match '(?i)architect|applicant'){ $ctx.Context } } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force 'C:\\Users\\rjain\\.codex' | Select-Object Name,Mode,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings') { 'EXISTS'; Get-ChildItem -Force 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings' | Select-Object Name,Mode,LastWriteTime | Format-Table -AutoSize } else { 'MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'C:\\Users\\rjain\\codex-settings') { 'EXISTS'; Get-ChildItem -Force 'C:\\Users\\rjain\\codex-settings' | Select-Object Name,Mode,LastWriteTime | Format-Table -AutoSize } else { 'MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Directory -Force \"$env:USERPROFILE\\.codex\\skills\" | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \".agents/skills\") { Get-ChildItem -Directory -Force \".agents/skills\" | Select-Object -ExpandProperty Name | Sort-Object }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git clone https://github.com/rjain557/codex-settings \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings' | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Force 'C:\\Users\\rjain\\.codex\\agents' | Select-Object FullName,Mode,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-ChildItem -Recurse -File \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\" | Measure-Object).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" branch --show-current"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Mode,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Directory -Depth 3 | Where-Object { $_.FullName -match 'gsd|command|commands' } | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Directory \"$env:USERPROFILE\\.codex\\skills\" | Select-Object Name,FullName | Sort-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\skills\\.system\") { Get-ChildItem -Directory \"$env:USERPROFILE\\.codex\\skills\\.system\" | Select-Object Name,FullName | Sort-Object Name | Format-Table -AutoSize } else { 'NO_SYSTEM_SKILLS_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \".agents\\skills\") { Get-ChildItem -Directory \".agents\\skills\" | Select-Object Name,FullName | Sort-Object Name | Format-Table -AutoSize } else { 'NO_LOCAL_AGENTS_SKILLS' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Directory \"$env:USERPROFILE\\.codex\\skills\" | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-ChildItem -Directory \"$env:USERPROFILE\\.codex\\skills\" | Where-Object { $_.Name -like 'gsd-*' }).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p = Join-Path $env:USERPROFILE '.codex\\skills\\gsd-auto-dev\\SKILL.md'; if (Test-Path $p) { Get-Content $p -TotalCount 260 } else { 'SKILL_NOT_FOUND: ' + $p }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning' | Select-Object Name,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; @('.planning\\ROADMAP.md','.planning\\STATE.md') | ForEach-Object { $p=Join-Path $root $_; \"{0}`t{1}\" -f $_,(Test-Path $p) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$skills='gsd-sdlc-review','gsd-batch-research','gsd-batch-plan','gsd-batch-execute'; $base=Join-Path $env:USERPROFILE '.codex\\skills'; $skills | ForEach-Object { $p=Join-Path $base $_; \"{0}`t{1}\" -f $_,(Test-Path $p) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p = Join-Path $env:USERPROFILE '.codex\\scripts\\gsd-runner-codex.ps1'; if (Test-Path $p) { Get-Content $p -TotalCount 260 } else { 'MISSING: ' + $p }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"ContinuousImprovement|sdlc-review|batch-research|batch-plan|batch-execute|auto-dev|/gsd:\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[260..620] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[621..980] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path docs\\review\\PRIORITIZED-TASKS.md) { Get-Content docs\\review\\PRIORITIZED-TASKS.md -TotalCount 220 } else { 'MISSING docs/review/PRIORITIZED-TASKS.md' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path docs\\review\\EXECUTIVE-SUMMARY.md) { Get-Content docs\\review\\EXECUTIVE-SUMMARY.md -TotalCount 220 } else { 'MISSING docs/review/EXECUTIVE-SUMMARY.md' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$lines = Get-Content .planning\\ROADMAP.md; $matches = @(); for($i=0;$i -lt $lines.Count;$i++){ if($lines[$i] -match '^- \\[ \\] \\*\\*Phase (\\d+): (.+)\\*\\*') { $matches += [pscustomobject]@{ Line=($i+1); Phase=[int]$Matches[1]; Title=$Matches[2] } } }; $matches | Sort-Object Phase,Line | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$lines = Get-Content .planning\\ROADMAP.md; $items = New-Object System.Collections.Generic.List[object]; for($i=0;$i -lt $lines.Count;$i++){ if($lines[$i] -match '^- \\[ \\] \\*\\*Phase (\\d+): (.+)\\*\\*') { $items.Add([pscustomobject]@{ Line=($i+1); Phase=[int]$Matches[1]; Title=$Matches[2] }) } }; $items | Sort-Object Phase,Line | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\" | Select-Object Name,Length,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-execute\\SKILL.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-research\\SKILL.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-plan\\SKILL.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$summary='docs/review/EXECUTIVE-SUMMARY.md'; $score='unknown'; if(Test-Path $summary){ $text=Get-Content $summary -Raw; if($text -match 'Health Score:\\s*(\\d+)\\s*/\\s*100'){ $score=$Matches[1] } }; $pending = rg -n \"^- \\[ \\] \\*\\*Phase (\\d+):\" .planning\\ROADMAP.md | ForEach-Object { if($_ -match 'Phase (\\d+)') { [int]$Matches[1] } }; $pending = $pending | Sort-Object -Unique; \"Health=$score\"; \"PendingPhases=\" + (($pending -join ', '))"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Command codex -ErrorAction SilentlyContinue | Select-Object Source,Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force \"$env:USERPROFILE\\.codex\\commands\\gsd\" | Select-Object Name,Length | Sort-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["powershell", "-ExecutionPolicy", "Bypass", "-File", "C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output | Sort-Object LastWriteTime -Descending | Select-Object -First 15 Name,Length,LastWriteTime | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases -Directory | Where-Object { $_.Name -match '^66-' } | ForEach-Object { \"### $($_.Name)\"; Get-ChildItem $_.FullName -File | Select-Object Name,Length | Format-Table -AutoSize; \"\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases -Directory | Where-Object { $_.Name -match '^(67|68)-' } | ForEach-Object { \"### $($_.Name)\"; Get-ChildItem $_.FullName -File | Select-Object Name,Length | Format-Table -AutoSize; \"\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Command claude -ErrorAction SilentlyContinue | Select-Object Source,Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["claude", "-p"], decision="allow")
prefix_rule(pattern=["codex", "exec"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$patterns = 'codex exec','claude -p','gsd-runner-codex','/gsd:'; $procs = Get-CimInstance Win32_Process | Where-Object { $cl = $_.CommandLine; $cl -and ($patterns | Where-Object { $cl -match [regex]::Escape($_) }) }; if($procs){ 'KILLING:'; $procs | Select-Object ProcessId,Name,CommandLine | Format-Table -AutoSize; foreach($p in $procs){ Stop-Process -Id $p.ProcessId -Force -ErrorAction SilentlyContinue } } else { 'NO_MATCHING_PROCESSES_FOUND' }; 'REMAINING:'; $left = Get-CimInstance Win32_Process | Where-Object { $cl = $_.CommandLine; $cl -and ($patterns | Where-Object { $cl -match [regex]::Escape($_) }) }; if($left){ $left | Select-Object ProcessId,Name,CommandLine | Format-Table -AutoSize } else { 'NONE' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$patterns = 'codex exec','claude -p','gsd-runner-codex','/gsd:'; $left = Get-CimInstance Win32_Process | Where-Object { $cl = $_.CommandLine; $cl -and ($patterns | Where-Object { $cl -match [regex]::Escape($_) }) }; if($left){ $left | Select-Object ProcessId,Name,CommandLine | Format-Table -AutoSize } else { 'NONE' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$current=$PID; $targets = Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -ne $current -and $_.CommandLine -and ($_.CommandLine -match 'codex exec|claude -p|gsd-runner-codex|/gsd:') }; if($targets){ $targets | ForEach-Object { Stop-Process -Id $_.ProcessId -Force -ErrorAction SilentlyContinue }; Start-Sleep -Milliseconds 400 }; $left = Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -ne $current -and $_.CommandLine -and ($_.CommandLine -match 'codex exec|claude -p|gsd-runner-codex|/gsd:') }; if($left){ $left | Select-Object ProcessId,Name,CommandLine | Format-Table -AutoSize } else { 'NONE' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -TotalCount 340"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[340..980] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\commands\\gsd\" -File | Select-Object -ExpandProperty BaseName | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\code-review.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\batch-execute.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\get-shit-done\\workflows\" -File | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\agents\" -File | Select-Object -ExpandProperty Name | Sort-Object"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\get-shit-done\\workflows\\batch-execute.md\" -TotalCount 360"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-execute\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-plan\\SKILL.md\" -TotalCount 280"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-research\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$names='gsd-research-phase','gsd-plan-phase','gsd-execute-phase'; $base=Join-Path $env:USERPROFILE '.codex\\skills'; foreach($n in $names){ $p=Join-Path $base \"$n\\SKILL.md\"; if(Test-Path $p){ \"### $n\"; Get-Content $p -TotalCount 120; \"\" } else { \"MISSING $n\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 240"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-execute\\SKILL.md\" -TotalCount 240"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\batch-plan.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"TargetScore = 100|/gsd:batch-research|/gsd:batch-plan|/gsd:sdlc-review|Pending phases before review|Success: health=\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\batch-research.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Join-Path $env:USERPROFILE '.codex\\scripts\\gsd-runner-codex.ps1'; $null=[System.Management.Automation.Language.Parser]::ParseFile($p,[ref]$null,[ref]$errs); if($errs -and $errs.Count -gt 0){ $errs | ForEach-Object { \"ERR: $($_.Message) at line $($_.Extent.StartLineNumber)\" } } else { 'SYNTAX_OK' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Join-Path $env:USERPROFILE '.codex\\scripts\\gsd-runner-codex.ps1'; $tokens=$null; $errs=$null; [void][System.Management.Automation.Language.Parser]::ParseFile($p,[ref]$tokens,[ref]$errs); if($errs -and $errs.Count -gt 0){ $errs | ForEach-Object { \"ERR: $($_.Message) at line $($_.Extent.StartLineNumber)\" } } else { 'SYNTAX_OK_CLEAN' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Invoke-RemediationPhaseGeneration|create-remediation-phases\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\batch-execute.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"code-review @git-diff|/gsd:sdlc-review|Pending phases before review|Success: health=|TargetScore = 100\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\commands\\gsd\" -File | Select-Object -ExpandProperty Name | Sort-Object | rg \"auto-dev|batch-plan|batch-research|batch-execute|sdlc-review\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\auto-dev.md\" -TotalCount 240"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Invoke-RemediationPhaseGeneration|/gsd:code-review|/gsd:sdlc-review|/gsd:batch-research|/gsd:batch-plan|Success: health=|TargetScore = 100\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\laguna-niguel\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\san-clemente\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\newport-beach\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\costa-mesa\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\san-juan-capistrano\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\dana-point\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\county-of-orange\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node agents\\irvine\\index.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem ..\\lead -Directory | ForEach-Object { $_.FullName; Get-ChildItem $_.FullName -File | Select-Object Name,Length | Format-Table -AutoSize }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path docs\\review\\EXECUTIVE-SUMMARY.md) { rg -n \"Health|BLOCKER|HIGH|MEDIUM|LOW\" docs\\review\\EXECUTIVE-SUMMARY.md } else { 'NO_EXEC_SUMMARY' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$patterns='gsd-runner-codex','codex exec','/gsd:'; Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -and ($_.CommandLine -match 'gsd-runner-codex|codex exec|/gsd:') } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -and ($_.CommandLine -match 'gsd-runner-codex|codex exec') } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$scanDate='02-19-26'; $dirs=@('newport.beach','costa.mesa','laguna.niguel','san.juan.capistrano','dana.point','san.clemente','irvine','county.of.orange'); $rows=@(); foreach($d in $dirs){$csv=\"..\\lead\\$d\\plan-check-active-$scanDate.csv\";$md=\"..\\lead\\$d\\$scanDate.md\";$count=0;if(Test-Path $csv){try{$count=(Import-Csv $csv).Count}catch{$count=-1}};$rows += [pscustomobject]@{CityFolder=$d;Leads=$count;CsvExists=(Test-Path $csv);MdExists=(Test-Path $md)}}; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = Get-ChildItem ..\\lead -Directory | ForEach-Object { Join-Path $_.FullName 'plan-check-active.csv' } | Where-Object { Test-Path $_ }; foreach($f in $files){ Write-Host \"`n=== $f ===\"; Import-Csv $f | Select-Object -First 2 | Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = Get-ChildItem ..\\lead -Directory | ForEach-Object { Join-Path $_.FullName 'plan-check-active.csv' } | Where-Object { Test-Path $_ }; $rows=@(); foreach($f in $files){ $h=(Get-Content $f -TotalCount 1); $rows += [pscustomobject]@{File=$f; Header=$h} }; $rows | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$urls=@('https://burkhartbros.com','https://burkhartbros.com/services/','https://burkhartbros.com/about/'); foreach($u in $urls){ Write-Host \"`n=== $u ===\"; try { $r=Invoke-WebRequest -Uri $u -UseBasicParsing -TimeoutSec 30; $text = ($r.Content -replace '<script[\\s\\S]*?</script>',' ' -replace '<style[\\s\\S]*?</style>',' ' -replace '<[^>]+>',' ' -replace '&nbsp;',' ' -replace '&amp;','&'); $text = ($text -replace '\\s+',' ').Trim(); if($text.Length -gt 1200){ $text.Substring(0,1200)} else { $text } } catch { \"ERROR: $($_.Exception.Message)\" }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$r=Invoke-WebRequest -Uri 'https://burkhartbros.com' -UseBasicParsing -TimeoutSec 30; $text = ($r.Content -replace '<script[\\s\\S]*?</script>',' ' -replace '<style[\\s\\S]*?</style>',' ' -replace '<[^>]+>',' ' -replace '&nbsp;',' ' -replace '&amp;','&' -replace '\\s+',' ').Trim(); Set-Content -Path \"$env:TEMP\\burkhart_home_text.txt\" -Value $text; Write-Host \"saved:$env:TEMP\\burkhart_home_text.txt\"; @('custom','home','homes','luxury','coastal','newport','laguna','new build','remodel','addition','commercial','adu') | ForEach-Object { $kw=$_; $count=([regex]::Matches($text,[regex]::Escape($kw),'IgnoreCase')).Count; \"${kw}: $count\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$r=Invoke-WebRequest -Uri 'https://burkhartbros.com' -UseBasicParsing -TimeoutSec 30; $links = [regex]::Matches($r.Content,'href\\s*=\\s*\"([^\"]+)\"','IgnoreCase') | ForEach-Object { $_.Groups[1].Value } | Where-Object { $_ -and $_ -notmatch '^#' } | ForEach-Object { if($_ -match '^https?://'){$_} elseif($_ -match '^/'){ 'https://burkhartbros.com' + $_ } else { 'https://burkhartbros.com/' + $_ } } | Where-Object { $_ -like 'https://burkhartbros.com*' } | Sort-Object -Unique; $links | Select-Object -First 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$pages=@('https://burkhartbros.com/about-us/','https://burkhartbros.com/client-experience/','https://burkhartbros.com/featured-properties/','https://burkhartbros.com/press/'); $keywords=@('custom home','custom homes','luxury','coastal','newport beach','laguna beach','newport coast','remodel','addition','commercial','tenant improvement','single family','residential'); foreach($u in $pages){ Write-Host \"`n=== $u ===\"; try { $r=Invoke-WebRequest -Uri $u -UseBasicParsing -TimeoutSec 30; $txt=($r.Content -replace '<script[\\s\\S]*?</script>',' ' -replace '<style[\\s\\S]*?</style>',' ' -replace '<[^>]+>',' ' -replace '&nbsp;',' ' -replace '&amp;','&' -replace '\\s+',' ').Trim(); if($txt.Length -gt 900){ Write-Host ($txt.Substring(0,900)) } else { Write-Host $txt }; foreach($k in $keywords){ $c=([regex]::Matches($txt,[regex]::Escape($k),'IgnoreCase')).Count; if($c -gt 0){ Write-Host \"  $k : $c\" } } } catch { Write-Host \"ERROR: $($_.Exception.Message)\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = Get-ChildItem ..\\lead -Directory | ForEach-Object { [pscustomobject]@{City=$_.Name; Path=(Join-Path $_.FullName 'plan-check-active.csv')} } | Where-Object { Test-Path $_.Path }; foreach($f in $files){ Write-Host \"`n=== $($f.City) ===\"; $rows=Import-Csv $f.Path; if($rows.Count -eq 0){ Write-Host 'no rows'; continue }; $norm = $rows | ForEach-Object { [pscustomobject]@{Type=($_.Type ?? $_.'Permit Type'); Work=($_.WorkClass ?? $_.SubType ?? $_.Category); Status=$_.Status } }; $norm | Group-Object Type | Sort-Object Count -Descending | Select-Object -First 12 Name,Count | Format-Table -AutoSize }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\irvine\\plan-check-active.csv | Sort-Object { [datetime]::Parse($_.'App Date') } -Descending | Select-Object -First 30 'Permit Number','App Date','Type','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows=Import-Csv ..\\lead\\laguna.niguel\\plan-check-active.csv | Where-Object { $_.Type -match '^Addition$|^Remodel$|Accessory Dwelling Unit' -and $_.Status -match 'Plan Check|Submitted|Additional|In Review|Fees Due' -and $_.'Applied Date' -ne '' }; $rows | ForEach-Object { try { $_ | Add-Member ParsedDate ([datetime]::Parse($_.'Applied Date')) -Force } catch { $_ | Add-Member ParsedDate ([datetime]'1900-01-01') -Force }; $_ } | Sort-Object ParsedDate -Descending | Select-Object -First 25 'Plan Number','Applied Date','Status','Type','WorkClass','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows=Import-Csv ..\\lead\\costa.mesa\\plan-check-active.csv | Where-Object { $_.Type -match '^Residential - New Construction$|^Residential-New Construction$|^Residential - Addition/Alteration$|Accessory Dwelling Unit \\(ADU\\) - New Construction' -and $_.Status -match 'In Review|Submitted|Application Accepted|Verifying Submittal|Plan Review|Corrections|Additional' -and $_.'Applied Date' -ne '' }; $rows | ForEach-Object { $_ | Add-Member ParsedDate ([datetime]::Parse($_.'Applied Date')) -Force; $_ } | Sort-Object ParsedDate -Descending | Select-Object -First 30 'Plan Number','Applied Date','Status','Type','WorkClass','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows=Import-Csv ..\\lead\\newport.beach\\plan-check-active.csv | Where-Object { $_.Type -match 'Combo Residential - New|Combo Residential - Addition/Alteration|MISC Permit - Addition/Alteration' -and $_.Status -match 'Plan Check Applied|In Process|Applied|In Application|Additional Info' -and $_.'Applied Date' -ne '' }; $rows | ForEach-Object { $_ | Add-Member -NotePropertyName ParsedDate -NotePropertyValue ([datetime]::Parse($_.'Applied Date')) -Force; $_ } | Sort-Object ParsedDate -Descending | Select-Object -First 35 'Plan Number','Applied Date','Status','Type','WorkClass','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\san.clemente\\plan-check-active.csv | Select-Object 'Permit Number',Type,SubType,Address | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows=Import-Csv ..\\lead\\laguna.niguel\\plan-check-active.csv | Where-Object { $_.Type -match '^Addition$|^Remodel$|Accessory Dwelling Unit' -and $_.'Applied Date' -ne '' }; $f=@(); foreach($r in $rows){ try{$d=[datetime]::Parse($r.'Applied Date')}catch{$d=[datetime]'1900-01-01'}; if($d -ge [datetime]'2025-01-01'){ $f += [pscustomobject]@{'Plan Number'=$r.'Plan Number';'Applied Date'=$r.'Applied Date';Status=$r.Status;Type=$r.Type;WorkClass=$r.WorkClass;Address=$r.Address;Description=$r.Description;Parsed=$d} } }; $f | Sort-Object Parsed -Descending | Select-Object -First 30 'Plan Number','Applied Date',Status,Type,WorkClass,Address,Description | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\newport.beach\\plan-check-active.csv | Where-Object { $_.Type -eq 'Combo Residential - Addition/Alteration' -and $_.'Applied Date' -ne '' } | Sort-Object { [datetime]::Parse($_.'Applied Date') } -Descending | Select-Object -First 20 'Plan Number','Applied Date','Status','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\newport.beach\\plan-check-active.csv | Where-Object { $_.Type -eq 'Combo Residential - New' -and $_.'Applied Date' -ne '' } | Sort-Object { [datetime]::Parse($_.'Applied Date') } -Descending | Select-Object -First 20 'Plan Number','Applied Date','Status','Address','Description' | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\laguna.niguel\\plan-check-active.csv | Where-Object { $_.'Applied Date' -ne '' -and ([datetime]::Parse($_.'Applied Date')) -ge [datetime]'2025-01-01' -and $_.Type -match 'Addition|Remodel|Accessory Dwelling Unit' -and $_.Description -match 'ADU|guest|2nd|second|addition|new bedroom|new garage|remodel|expand|convert' } | Sort-Object { [datetime]::Parse($_.'Applied Date') } -Descending | Select-Object -First 20 'Plan Number','Applied Date','Status','Type','Address',@{N='Scope';E={ if(($_.Description+'').Length -gt 140){($_.Description+'').Substring(0,140)+'...'} else { $_.Description } }} | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\irvine\\plan-check-active.csv | Where-Object { $_.Type -match 'Residential New SFD' -and $_.Description -match 'NEW|new|CUSTOM|custom|REBUILD|rebuild|DEMO|demo|ADU|Addition|addition' } | Sort-Object { [datetime]::Parse($_.'App Date') } -Descending | Select-Object -First 15 'Permit Number','App Date','Type','Address',@{N='Scope';E={ if(($_.Description+'').Length -gt 140){($_.Description+'').Substring(0,140)+'...'} else { $_.Description } }} | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Import-Csv ..\\lead\\newport.beach\\plan-check-active.csv | Where-Object { $_.Type -eq 'Combo Residential - Addition/Alteration' -and $_.'Applied Date' -ne '' -and $_.Description -match 'ADD|addition|2nd|second|DECK|REMODEL' } | Sort-Object { [datetime]::Parse($_.'Applied Date') } -Descending | Select-Object -First 30 'Plan Number','Applied Date','Status','Address',@{N='Scope';E={ if(($_.Description+'').Length -gt 140){($_.Description+'').Substring(0,140)+'...'} else { $_.Description } }} | Format-Table -Wrap -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem agents -Directory | ForEach-Object { Join-Path $_.FullName 'search.js' } | Where-Object { Test-Path $_ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path .planning -Force | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item .planning\\execution-log-codex.txt | Select-Object LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$targets = 56..63; $rows = foreach($n in $targets){ $prefix = '{0:D2}' -f $n; $dirs = Get-ChildItem .planning\\phases -Directory -Filter \"$prefix-*\" -ErrorAction SilentlyContinue; if(-not $dirs){ [pscustomobject]@{Phase=$n;Dir='(missing)';Plans=0;Summaries=0;Status='missing'}; continue }; foreach($d in $dirs){ $plans = @(Get-ChildItem $d.FullName -File -Filter \"$prefix-*-PLAN.md\" -ErrorAction SilentlyContinue).Count; $sums = @(Get-ChildItem $d.FullName -File -Filter \"$prefix-*-SUMMARY.md\" -ErrorAction SilentlyContinue).Count; $status = if($plans -eq 0){'no-plan-files'} elseif($sums -ge $plans){'complete'} elseif($sums -gt 0){'in-progress'} else {'not-started'}; [pscustomobject]@{Phase=$n;Dir=$d.Name;Plans=$plans;Summaries=$sums;Status=$status} } }; $rows | Sort-Object Phase,Dir | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$targets = 64..68; $rows = foreach($n in $targets){ $prefix = '{0:D2}' -f $n; $dirs = Get-ChildItem .planning\\phases -Directory -Filter \"$prefix-*\" -ErrorAction SilentlyContinue; if(-not $dirs){ [pscustomobject]@{Phase=$n;Dir='(missing)';Plans=0;Summaries=0;Status='missing'}; continue }; foreach($d in $dirs){ $plans = @(Get-ChildItem $d.FullName -File -Filter \"$prefix-*-PLAN.md\" -ErrorAction SilentlyContinue).Count; $sums = @(Get-ChildItem $d.FullName -File -Filter \"$prefix-*-SUMMARY.md\" -ErrorAction SilentlyContinue).Count; $status = if($plans -eq 0){'no-plan-files'} elseif($sums -ge $plans){'complete'} elseif($sums -gt 0){'in-progress'} else {'not-started'}; [pscustomobject]@{Phase=$n;Dir=$d.Name;Plans=$plans;Summaries=$sums;Status=$status} } }; $rows | Sort-Object Phase,Dir | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning -Force | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content agents\\county-of-orange\\index.js | Select-String -Pattern \"filterPlanCheck|filterActive|active-only\" -Context 2,2"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -TotalCount 360"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\auto-dev.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"gsd-auto-dev|gsd-runner-codex|gsd\" \"$env:USERPROFILE\\Documents\\WindowsPowerShell\\profile.ps1\" \"$PROFILE\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\scripts\" -Force | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"gsd-auto-dev|auto-dev|gsd:batch-execute|gsd-runner-codex|gsd-runner\" \"$env:USERPROFILE\\.codex\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\codex\\setup-codex-global.ps1\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"gsd-auto-dev|gsd-codex|gsd-run|gsd-batch|gsd:\" \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\" \"$env:USERPROFILE\\.claude\" \"$env:USERPROFILE\\.codex\\codex\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Resolve-CodexCommand|Using codex|Build-CodexExecCommand|codex exec|ContinuousImprovement|/gsd:batch-research|/gsd:batch-plan|/gsd:batch-execute|/gsd:execute-phase|execSkill =\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\profile.ps1\" -TotalCount 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[520..610] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Command gsd-auto-dev,gsd-codex,gsd-run -ErrorAction SilentlyContinue | Select-Object Name,CommandType,Source,Definition | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"ContinuousImprovement|TargetScore|Invoke-FullReview|Invoke-SequentialExecution|Invoke-ParallelPreparation|Get-PendingPhases|Success: health|stop reason|stop_reason\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[632..725] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[246..265] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -TotalCount 220"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function gsd-run|function gsd-codex|function gsd-run-codex\" \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\profile.ps1\" \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"name: gsd:auto-dev|/gsd:batch-execute|name: gsd-auto-dev|Codex-native|\\$execSkill = if \\(\\$UseWaveParallel\\)|Using codex|Build-CodexExecCommand|codex exec\" \"$env:USERPROFILE\\.codex\\commands\\gsd\\auto-dev.md\" \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Build-CodexExecCommand|codex exec|\\$execSkill = if \\(\\$UseWaveParallel\\)|Using codex\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"name: gsd-auto-dev|Codex-native|\\$gsd-batch-execute\" \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"name: gsd:auto-dev|/gsd:batch-execute\" \"$env:USERPROFILE\\.codex\\commands\\gsd\\auto-dev.md\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Using codex\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"codex exec\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"execSkill = if\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Build-CodexExecCommand\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"exec - --dangerously-bypass-approvals-and-sandbox\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\costa-mesa\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\laguna-beach\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\newport-beach\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\shared\\client-fit.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\dana-point\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\san-juan-capistrano\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\laguna-niguel\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\san-clemente\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Find-ClaudePath|Invoke-Claude|/gsd:batch-execute|Start-Process -FilePath \\$claudePath\" run-phases.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\county-of-orange\\index.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\county-of-orange\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node --check agents\\irvine\\search.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner.ps1\" -TotalCount 120"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -TotalCount 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\profile.ps1\" -TotalCount 140"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\profile.ps1\" -TotalCount 40"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1\" -TotalCount 30"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", ". \"$env:USERPROFILE\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\profile.ps1\"; Get-Command gsd-run,gsd-run-claude,gsd-auto-dev,gsd-auto-dev-codex,gsd-codex,gsd-run-codex | Select-Object Name,CommandType,Definition | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output -File | Sort-Object LastWriteTime -Descending | Select-Object -First 4 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -and $_.CommandLine -match 'gsd-runner-codex.ps1' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -ProjectPath \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\" -ContinuousImprovement -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output -File | Sort-Object LastWriteTime -Descending | Select-Object -First 8 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -and $_.CommandLine -match 'gsd-runner-codex.ps1' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Sort-Object CreationDate -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \".planning\\agent-output\\gsd-auto-dev-20260219-164144.stdout.log\", \".planning\\agent-output\\gsd-auto-dev-20260219-164144.stderr.log\" | Select-Object Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 41588 -or ($_.CommandLine -and $_.CommandLine -match 'gsd-auto-dev-20260219-164144.launch.ps1') } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output -File | Sort-Object LastWriteTime -Descending | Select-Object -First 6 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 50008 -or ($_.CommandLine -and $_.CommandLine -match 'EncodedCommand') } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('..\\lead\\newport.beach\\plan-check-active.csv','..\\lead\\laguna.beach\\plan-check-active.csv','..\\lead\\costa.mesa\\plan-check-active.csv','..\\lead\\laguna.niguel\\plan-check-active.csv','..\\lead\\san.clemente\\plan-check-active.csv','..\\lead\\irvine\\plan-check-active.csv','..\\lead\\san.juan.capistrano\\plan-check-active.csv','..\\lead\\dana.point\\plan-check-active.csv','..\\lead\\county.of.orange\\plan-check-active.csv'); foreach($p in $paths){ if(Test-Path $p){ $c=(Import-Csv $p).Count; \"$p`t$c\" }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j=Get-Content ..\\lookup-results.json -Raw | ConvertFrom-Json; $non = @(); foreach($p in $j.PSObject.Properties){ if($p.Value.architect){ $non += [pscustomobject]@{Plan=$p.Name;Architect=$p.Value.architect} } }; if($non.Count -eq 0){'No architect values in lookup-results.json'} else {$non | Format-Table -AutoSize}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Invoke-RestMethod -Uri \"https://assessedvalue.ocassessor.gov/query.php?apn=64116338\" -TimeoutSec 20 | ConvertTo-Json -Depth 5"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$csv=Import-Csv ..\\lead\\outreach\\02-19-26-burkhart-selected-enriched.csv; $csv | Group-Object 'Outreach Priority' | Select-Object Name,Count | Sort-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$csv=Import-Csv ..\\lead\\outreach\\02-19-26-burkhart-selected-enriched.csv; $csv | Group-Object City | Select-Object Name,Count | Sort-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$scanDate = Get-Date -Format 'MM-dd-yy'; $outDir=Resolve-Path ..\\lead\\costa.mesa; $csv=Join-Path $outDir \"plan-check-active-$scanDate.csv\"; node agents/costa-mesa/index.js --active-only -f csv -o \"$csv\"; if($LASTEXITCODE -eq 0){ Copy-Item -Force $csv (Join-Path $outDir 'plan-check-active.csv'); \"COUNT=$(@(Import-Csv $csv).Count)\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$body = @{ repoName='r-1645a77d'; searchSyn='{LF:Basic ~= \"ZPC-2025-0739\", option=\"DFANLT\"}'; sortColumn=''; startIdx=0; endIdx=30; getNewListing=$true; sortOrder=2; displayInGridView=$true } | ConvertTo-Json -Compress; $r = Invoke-RestMethod -Uri 'https://portal.laserfiche.com/Portal/SearchService.aspx/GetSearchListing' -Method Post -ContentType 'application/json' -Body $body -Headers @{ 'x-lf-suppress-login-redirect'='1' }; $r | ConvertTo-Json -Depth 8"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse bbc-leadgen\\scripts -Force | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node -e \"fetch('https://assessedvalue.ocassessor.gov/query.php?apn=64116338').then(r=>r.text()).then(t=>console.log(t.slice(0,160))).catch(e=>console.error('ERR',e.message))\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$roadmap = Get-Content .planning\\ROADMAP.md -Raw; [regex]::Matches($roadmap, '- \\[ \\] \\*\\*Phase (\\d+)') | ForEach-Object { $_.Groups[1].Value } | Sort-Object -Unique"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-19-26-burkhart-selected-enriched.csv'; Write-Output $rows.Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node -e \"(async()=>{const p='ZPC-2024-1613';const u='https://portal.laserfiche.com/Portal/Search.aspx?repo=r-1645a77d&searchcommand=%7BLF%3ABasic%20~%3D%20%22'+encodeURIComponent(p)+'%22%2C%20option%3D%22DFANLT%22%7D';const t=await (await fetch(u)).text();console.log('len',t.length);const m=t.match(/(\\d+)\\s+Results?/i);console.log('match',m&&m[0]);console.log(t.slice(0,300).replace(/\\n/g,' '));})();\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node -e \"(async()=>{const p='ZPC-2024-1613';const u='https://portal.laserfiche.com/Portal/Search.aspx?repo=r-1645a77d&searchcommand=%7BLF%3ABasic%20~%3D%20%22'+encodeURIComponent(p)+'%22%2C%20option%3D%22DFANLT%22%7D';const t=await (await fetch(u)).text();for (const pat of ['SearchService','GetSearchListing','searchcommand','str_json','Weblink']){console.log(pat, t.includes(pat));}console.log(t);})();\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; \"rows=$($rows.Count)\"; \"assessed=$((($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Assessed Value Total (cached)') }).Count))\"; \"owner=$((($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Owner Name') }).Count))\"; \"architect=$((($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Architect Name') }).Count))\"; \"lagunaDocs=$((($rows | ? { $_.'City Slug' -eq 'laguna.beach' -and -not [string]::IsNullOrWhiteSpace($_.'Laguna Laserfiche Docs (cached)') }).Count))\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; $rows | Where-Object { -not [string]::IsNullOrWhiteSpace($_.'Architect Name') } | Select-Object City,'Plan/Permit',Address,'Architect Name','Architect Source / Next Step' | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem docs\\review -File | Select-Object Name,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; \"rows=$($rows.Count)\"; \"assessed=$(@($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Assessed Value Total (cached)') }).Count)\"; \"owner=$(@($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Owner Name') }).Count)\"; \"architect=$(@($rows | ? { -not [string]::IsNullOrWhiteSpace($_.'Architect Name') }).Count)\"; \"lagunaDocs=$(@($rows | ? { $_.'City Slug' -eq 'laguna.beach' -and -not [string]::IsNullOrWhiteSpace($_.'Laguna Laserfiche Docs (cached)') }).Count)\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; $rows | Where-Object { -not [string]::IsNullOrWhiteSpace($_.'Architect Name') -or -not [string]::IsNullOrWhiteSpace($_.'Owner Name') } | Select-Object City,'Plan/Permit',Address,'Owner Name','Architect Name','Owner Source / Next Step','Architect Source / Next Step' | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[400..535] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; $noParcel = @($rows | ? { [string]::IsNullOrWhiteSpace($_.Parcel) }).Count; $non8 = @($rows | ? { -not [string]::IsNullOrWhiteSpace($_.Parcel) -and (($_.Parcel -replace '[^0-9]','').Length -ne 8) }).Count; $noAssessed = @($rows | ? { [string]::IsNullOrWhiteSpace($_.'Assessed Value Total (cached)') }).Count; \"noParcel=$noParcel\"; \"non8=$non8\"; \"noAssessed=$noAssessed\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content .planning\\ROADMAP.md; $c[500..575] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows = Import-Csv 'lead\\outreach\\02-20-26-burkhart-selected-enriched-public.csv'; $rows | ? { [string]::IsNullOrWhiteSpace($_.'Assessed Value Total (cached)') -and -not [string]::IsNullOrWhiteSpace($_.Parcel) } | Select-Object City,'Plan/Permit',Address,Parcel | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$apns = '42429136','43921103','05614106','05616037'; foreach($a in $apns){ try { $r = Invoke-RestMethod -Uri \"https://assessedvalue.ocassessor.gov/query.php?apn=$a\" -TimeoutSec 20; if($r.error -eq $false -and $null -ne $r.data){ \"$a -> gross=$($r.data.gross_value)\" } else { \"$a -> error=$($r.error) msg=$($r.errorMessage)\" } } catch { \"$a -> EXCEPTION\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases\\69-health-100-review-closure -File | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -and $_.CommandLine -match 'gsd-runner-codex.ps1|codex exec' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "\"csvLatest=$(Test-Path 'lead\\outreach\\latest-burkhart-selected-enriched-public.csv')\"; \"mdLatest=$(Test-Path 'lead\\outreach\\latest-burkhart-selected-email-public.md')\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem tech-web-chatai.2\\design\\figma\\v8 -Recurse -Depth 2 | Select-Object FullName,PSIsContainer | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem docs -Force | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem tech-web-chatai.2\\design\\figma\\v8 -Force | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c = Get-Content docs\\review\\TRACEABILITY-MATRIX.md; $c[490..620] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Route|path=\\\"|createBrowserRouter|Routes|Route\" tech-web-chatai.2\\src\\Client\\technijian-spa\\src\\components\\TCAIApp.tsx tech-web-chatai.2\\src\\Client\\technijian-spa\\src\\**\\*.tsx"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem tech-web-chatai.2\\src -Directory | Select-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$v8 = Get-ChildItem 'tech-web-chatai.2/design/figma/v8/src/components/screens' -Recurse -File -Include *.tsx | ForEach-Object { $_.BaseName } | Sort-Object -Unique; $spa = Get-ChildItem 'tech-web-chatai.2/src/Client/technijian-spa/src/components/screens' -Recurse -File -Include *.tsx | ForEach-Object { $_.BaseName } | Sort-Object -Unique; $missing = Compare-Object -ReferenceObject $v8 -DifferenceObject $spa -PassThru | Where-Object { $_ -in $v8 } | Sort-Object -Unique; \"V8 screen components: $($v8.Count)\"; \"SPA screen components: $($spa.Count)\"; \"V8 names missing in SPA: $($missing.Count)\"; $missing | Select-Object -First 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$spec = Get-Content 'tech-web-chatai.2/docs/spec/ui-contract.md'; $specUrls = $spec | ForEach-Object { if ($_ -match '\\| \\*\\*url\\*\\* \\|\\s*([^|]+?)\\s*\\|') { $matches[1].Trim() } } | Sort-Object -Unique; $router = Get-Content 'tech-web-chatai.2/src/Client/technijian-spa/src/router.tsx'; $routePaths = $router | ForEach-Object { if ($_ -match \"path:\\s*'([^']+)'\") { '/' + $matches[1].Trim() } } | Sort-Object -Unique; \"Spec urls: $($specUrls.Count)\"; \"Router paths: $($routePaths.Count)\"; $missing = $specUrls | Where-Object { $_ -notin $routePaths -and $_ -ne '/' }; \"Spec urls missing in router exact-match: $($missing.Count)\"; $missing | Select-Object -First 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases -Directory | Sort-Object Name | Select-Object -Last 12 Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem tech-web-chatai.2\\docs\\spec -Recurse -File | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = Get-ChildItem tech-web-chatai.2\\docs\\spec -File; foreach ($f in $files) { \"===== $($f.Name) =====\"; Get-Content $f.FullName -TotalCount 120 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "\"src/Agent exists: $(Test-Path 'tech-web-chatai.2\\src\\Agent')\"; \"src/Services/RemoteAgent exists: $(Test-Path 'tech-web-chatai.2\\src\\Services\\RemoteAgent')\"; \"generated/agent exists: $(Test-Path 'tech-web-chatai.2\\generated\\agent')\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\commands\\gsd\" -Force | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\") { Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 260 } else { 'MISSING: sdlc-review.md' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" | ForEach-Object { \"{0:D4}: {1}\" -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rows=Import-Csv 'lead/outreach/burkhart-plancheck-leads-2026-02-20.csv'; \"rows=$($rows.Count)\"; ($rows | Get-Member -MemberType NoteProperty | Select-Object -ExpandProperty Name) -join ', '"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\") { 'FOUND'; Get-Content \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" -TotalCount 220 } else { 'MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.claude\\commands\") { Get-ChildItem \"$env:USERPROFILE\\.claude\\commands\" -Recurse -File | Where-Object { $_.Name -match 'sdlc-review|code-review|review' } | Select-Object FullName | Format-Table -AutoSize } else { 'MISSING .claude/commands' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" | ForEach-Object { \"{0:D4}: {1}\" -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 240"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" -TotalCount 240"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output -File -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 8 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell|pwsh|cmd|node|codex' -and $_.CommandLine -match 'gsd-auto-dev|gsd-runner-codex|codex exec' } | Select-Object ProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\execution-log-codex.txt) { Get-Item .planning\\execution-log-codex.txt | Select-Object LastWriteTime,Length | Format-List; Get-Content .planning\\execution-log-codex.txt -Tail 80 } else { 'No .planning/execution-log-codex.txt found' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases\\69-health-100-review-closure -File | Select-Object Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Process powershell -ArgumentList '-NoExit','-Command','cd \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\"; gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item .planning\\execution-log-codex.txt | Select-Object LastWriteTime,Length | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell|pwsh|cmd|node|codex' -and $_.CommandLine -match 'gsd-auto-dev|execute-phase-70|gsd-runner-codex|codex exec' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\agent-output -File | Sort-Object LastWriteTime -Descending | Select-Object -First 20 Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\agent-output\\execute-phase-70-20260219-213549.stdout) { Get-Content .planning\\agent-output\\execute-phase-70-20260219-213549.stdout -Tail 200 } else { 'execute-phase-70 stdout file not found' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\agent-output\\execute-phase-70-20260219-213549.stderr) { Get-Content .planning\\agent-output\\execute-phase-70-20260219-213549.stderr -Tail 220 } else { 'execute-phase-70 stderr file not found' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 40696 }; if ($p) { \"Parent PID: $($p.ProcessId)\"; Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 40696 } | Select-Object ProcessId,Name,CommandLine | Format-Table -AutoSize } else { 'Parent process not found' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\gsd-run-log.txt) { Get-Content .planning\\gsd-run-log.txt -Tail 120 } else { 'No gsd-run-log.txt' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Health Score|Severity Totals|Blocker|High|Medium|Low|EXECUTIVE-SUMMARY|docs/review\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[760..940] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[520..760] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[300..430] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\commands\\gsd\" -Force | Where-Object { $_.Name -match 'add-phase|insert-phase|plan-phase|sdlc-review' } | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function Get-ReviewHealthScore|BLOCKER\\s*\\|\\s*\\(\\d\\+\\)|Severity Totals|No pending phases exist but health remains below target\" \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner.ps1\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.claude\\scripts\" -Force | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner.ps1\"; $c[300..430] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner.ps1\"; $c[220..300] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$content = Get-Content docs\\review\\EXECUTIVE-SUMMARY.md -Raw; if ($content -match '(?is)Severity\\s+Totals\\s*:\\s*.*?Blocker\\s*=\\s*(\\d+).*?High\\s*=\\s*(\\d+).*?Medium\\s*=\\s*(\\d+).*?Low\\s*=\\s*(\\d+)') { \"Parsed => Blocker=$($Matches[1]) High=$($Matches[2]) Medium=$($Matches[3]) Low=$($Matches[4])\" } else { 'Parse failed' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\" -Force | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\get-shit-done\" -Recurse -Force | Select-Object FullName,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\skills\" -Directory -Force | Where-Object { $_.Name -like 'gsd-*' } | Select-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\rules\" -Recurse -File -Force | Where-Object { $_.FullName -match 'gsd' } | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\" -Directory -Force | Where-Object { $_.Name -eq 'codex-settings' } | Select-Object FullName | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["git", "clone"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Depth 2 -Force | Select-Object FullName,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"C:\\Users\\rjain\\codex-settings\\.codex\\scripts\") { Get-ChildItem \"C:\\Users\\rjain\\codex-settings\\.codex\\scripts\" -File -Force | Select-Object Name,Length | Format-Table -AutoSize } else { 'repo missing .codex/scripts' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\agents\" -File -Force | Where-Object { $_.Name -match 'gsd|sdlc' } | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"C:\\Users\\rjain\\codex-settings\\.codex\\commands\\gsd\") { Get-ChildItem \"C:\\Users\\rjain\\codex-settings\\.codex\\commands\\gsd\" -File -Force | Select-Object Name,Length | Format-Table -AutoSize } else { 'repo missing .codex/commands/gsd' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .codex\\commands\\gsd -File | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .codex\\scripts -File | Select-Object Name,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git remote -v"], decision="allow")
prefix_rule(pattern=["git", "commit"], decision="allow")
prefix_rule(pattern=["git", "add"], decision="allow")
prefix_rule(pattern=["git", "push"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --short HEAD; git status --short"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path docs\\review\\PRIORITIZED-TASKS.md) { Get-Content docs\\review\\PRIORITIZED-TASKS.md -TotalCount 260 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path docs\\review\\EXECUTIVE-SUMMARY.md) { Get-Content docs\\review\\EXECUTIVE-SUMMARY.md -TotalCount 220 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"No pending phases after review|No pending phases exist but health remains below target|sdlc-review|phase\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c = Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[560..780] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function Get-ReviewHealthScore|pending phases|Severity Totals|PRIORITIZED-TASKS|ROADMAP|Phase\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c = Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[330..420] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.codex\\commands\\gsd\" -File | Select-Object -ExpandProperty Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\auto-dev.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-enhance.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function gsd-auto-dev|gsd-auto-dev\" \"$env:USERPROFILE\\.codex\\scripts\" \"$env:USERPROFILE\\Documents\\WindowsPowerShell\" \"$env:USERPROFILE\\Documents\\PowerShell\" -g \"*.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function gsd-auto-dev|Set-Alias gsd-auto-dev|gsd-auto-dev\" \"$env:USERPROFILE\\.codex\\scripts\" -g \"*.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"gsd-auto-dev|gsd-runner-codex|PrepModel|ExecuteModel|ReviewModel\" \"$env:USERPROFILE\\.codex\" -g \"*.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\") { Get-Content \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" -TotalCount 320 } else { 'MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content -Path $env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Command gsd-auto-dev -All | Format-List Name,CommandType,Source,Definition"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"gsd-auto-dev|gsd-runner-codex|PrepModel|ExecuteModel|ReviewModel\" \"$env:USERPROFILE\\.codex\" -g \"*.ps1\" -g \"*.psm1\" -g \"*.psd1\" -g \"*.cmd\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$PROFILE | Format-List *; if (Test-Path $PROFILE) { \"`n--- PROFILE CONTENT ---\"; Get-Content $PROFILE -TotalCount 260 } else { \"PROFILE_NOT_FOUND\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content $PROFILE -TotalCount 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", ". $PROFILE; (Get-Command gsd-auto-dev).Definition"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=$PROFILE; $i=0; Get-Content $p | ForEach-Object { $i++; if ($i -le 320) { '{0,4}: {1}' -f $i, $_ } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoProfile", "-Command", "powershell -NoProfile -Command \". 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; (Get-Command gsd-auto-dev).CommandType; (Get-Command gsd-auto-dev).Definition\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoProfile", "-Command", "$p='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; $i=0; Get-Content $p | ForEach-Object { $i++; if ($i -le 200) { '{0,4}: {1}' -f $i, $_ } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'C:\\Users\\rjain\\codex-settings') { rg -n \"gsd-auto-dev|sdlc-review|commands\\\\gsd\" 'C:\\Users\\rjain\\codex-settings' -g \"*.md\" -g \"*.ps1\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'C:\\Users\\rjain\\claude-settings') { rg -n \"gsd-auto-dev|sdlc-review|commands\\\\gsd\" 'C:\\Users\\rjain\\claude-settings' -g \"*.md\" -g \"*.ps1\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('C:\\Users\\rjain\\codex-settings','C:\\Users\\rjain\\claude-settings'); foreach($p in $paths){ if(Test-Path $p){\"EXISTS $p\"; Get-ChildItem -Force $p | Select-Object -First 20 Name,Mode } else {\"MISSING $p\"} }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (-not (Test-Path 'C:\\Users\\rjain\\claude-settings')) { git clone https://github.com/rjain557/claude-settings C:\\Users\\rjain\\claude-settings } else { 'already exists' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\claude-settings status --short; git -C C:\\Users\\rjain\\claude-settings remote -v"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\codex-settings status --short; git -C C:\\Users\\rjain\\codex-settings remote -v"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force C:\\Users\\rjain\\claude-settings | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force C:\\Users\\rjain\\codex-settings | Select-Object Name,Mode | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item -Path \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -Destination \"C:\\Users\\rjain\\codex-settings\\.codex\\commands\\gsd\\sdlc-review.md\" -Force; Copy-Item -Path \"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\" -Destination \"C:\\Users\\rjain\\claude-settings\\commands\\gsd\\sdlc-review.md\" -Force; git -C C:\\Users\\rjain\\codex-settings status --short; git -C C:\\Users\\rjain\\claude-settings status --short"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"C:\\Users\\rjain\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[10..30] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $c[10..30] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\codex-settings add .codex/commands/gsd/sdlc-review.md .codex/scripts/gsd-runner-codex.ps1; git -C C:\\Users\\rjain\\codex-settings commit -m \"feat(gsd): enforce remediation phases and default codex model split\"; git -C C:\\Users\\rjain\\codex-settings push origin main; git -C C:\\Users\\rjain\\claude-settings add commands/gsd/sdlc-review.md; git -C C:\\Users\\rjain\\claude-settings commit -m \"feat(gsd): enforce remediation phase creation in sdlc-review\"; git -C C:\\Users\\rjain\\claude-settings push origin main"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\codex-settings status --short; git -C C:\\Users\\rjain\\codex-settings rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\claude-settings status --short; git -C C:\\Users\\rjain\\claude-settings rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo = \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\"; $inner = \"Set-Location -LiteralPath `\"$repo`\"; gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement\"; $p = Start-Process -FilePath \"C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" -ArgumentList \"-NoExit\",\"-Command\",$inner -PassThru; Start-Sleep -Seconds 1; Get-CimInstance Win32_Process -Filter \"ProcessId=$($p.Id)\" | Select-Object ProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; (Get-Content $p -Raw).Replace('return ,$argList','return $argList') | Set-Content -Path $p -Encoding UTF8; 'PATCHED'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "powershell -NoProfile -Command \". 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; Set-Location -LiteralPath 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement -DryRun\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "powershell -NoProfile -Command \". 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; (Get-Command gsd-auto-dev).Definition\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "powershell -NoProfile -Command \". 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; (Get-Command _gsd_apply_auto_dev_model_defaults).Definition\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "powershell -NoProfile -Command \"function f { $args | ForEach-Object { '[' + $_ + ']' } }; f -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoProfile", "-Command", "powershell -NoProfile -Command \". 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; Set-Location -LiteralPath 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement -DryRun\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-NoProfile", "-Command", "$repo = 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $profilePath = 'C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'; $inner = \"& { . '$profilePath'; Set-Location -LiteralPath '$repo'; gsd-auto-dev -TargetScore 100 -MaxIterations 20 -StopOnNoImprovement }\"; $p = Start-Process -FilePath 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' -ArgumentList '-NoExit','-NoLogo','-Command',$inner -PassThru; Start-Sleep -Seconds 1; Get-CimInstance Win32_Process -Filter \"ProcessId=$($p.Id)\" | Select-Object ProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\claude-settings status --short; git -C C:\\Users\\rjain\\claude-settings rev-parse --abbrev-ref HEAD; git -C C:\\Users\\rjain\\claude-settings rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C C:\\Users\\rjain\\codex-settings status --short; git -C C:\\Users\\rjain\\codex-settings rev-parse --abbrev-ref HEAD; git -C C:\\Users\\rjain\\codex-settings rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$a='$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md';$b='C:\\Users\\rjain\\codex-settings\\.codex\\commands\\gsd\\sdlc-review.md'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'codex sdlc-review: same'} else {'codex sdlc-review: different'}; $a='$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1';$b='C:\\Users\\rjain\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'codex runner: same'} else {'codex runner: different'}; $a='$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md';$b='C:\\Users\\rjain\\claude-settings\\commands\\gsd\\sdlc-review.md'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'claude sdlc-review: same'} else {'claude sdlc-review: different'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$a=\"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\";$b='C:\\Users\\rjain\\codex-settings\\.codex\\commands\\gsd\\sdlc-review.md'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'codex sdlc-review: same'} else {'codex sdlc-review: different'}; $a=\"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\";$b='C:\\Users\\rjain\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'codex runner: same'} else {'codex runner: different'}; $a=\"$env:USERPROFILE\\.claude\\commands\\gsd\\sdlc-review.md\";$b='C:\\Users\\rjain\\claude-settings\\commands\\gsd\\sdlc-review.md'; if((Get-FileHash $a).Hash -eq (Get-FileHash $b).Hash){'claude sdlc-review: same'} else {'claude sdlc-review: different'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s=git -C C:\\Users\\rjain\\claude-settings status --short; if([string]::IsNullOrWhiteSpace(($s -join ''))){'claude-settings: clean'} else {$s}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s=git -C C:\\Users\\rjain\\codex-settings status --short; if([string]::IsNullOrWhiteSpace(($s -join ''))){'codex-settings: clean'} else {$s}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path AGENTS.md) { Get-Content AGENTS.md -TotalCount 200 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning\\milestones | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning\\phases | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .planning\\STATE.md | ForEach-Object {\"$i`:` $_\"; $i++} | Select-Object -First 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .planning\\STATE.md | ForEach-Object {\"$i`:` $_\"; $i++} | Select-String -Pattern \"Pending remediation phases|Stopped at:|^\\d+: Phase:|^\\d+: Plan:\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .planning\\STATE.md | ForEach-Object {\"$i`:` $_\"; $i++} | Select-Object -Skip 430 -First 20"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"gsd-sdlc-review|sdlc-review|review\" .planning scripts docs .claude 2>$null"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .agents; if (Test-Path .agents\\skills) { Get-ChildItem -Recurse -File .agents\\skills | Select-Object FullName }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"gsd:sdlc-review|sdlc-review|Skill\\(gsd:sdlc-review\\)|gsd-sdlc-review\" .claude .agents tech-web-chatai.2 .planning 2>$null"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force tech-web-chatai.2; if (Test-Path tech-web-chatai.2\\scripts) { Get-ChildItem -Recurse -File tech-web-chatai.2\\scripts | Select-Object FullName }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden -S \"sdlc-review|gsd:sdlc-review|traceability|figma|spec\" tech-web-chatai.2\\.claude tech-web-chatai.2\\scripts tech-web-chatai.2\\docs\\spec tech-web-chatai.2\\docs\\review 2>$null"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path tech-web-chatai.2\\.claude\\commands) { (Get-ChildItem -Recurse -File tech-web-chatai.2\\.claude\\commands).Count; Get-ChildItem -Recurse -File tech-web-chatai.2\\.claude\\commands | Select-Object -First 40 -ExpandProperty FullName } else { 'NO_COMMANDS_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path tech-web-chatai.2\\scripts) { (Get-ChildItem -Recurse -File tech-web-chatai.2\\scripts).Count; Get-ChildItem -Recurse -File tech-web-chatai.2\\scripts | Select-Object -First 80 -ExpandProperty FullName } else { 'NO_SCRIPTS_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\skills\") { Get-ChildItem -Force \"$env:USERPROFILE\\.codex\\skills\" | Select-Object Name,Mode } else { 'MISSING_CODEX_SKILLS' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\") { Get-ChildItem -Recurse -Force \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\" | Select-Object FullName,Length,Mode } else { 'MISSING_SKILL_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\") { Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 260 } else { 'MISSING_SKILL' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-batch-plan\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-code-review\\SKILL.md\" -TotalCount 300"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-validate\\SKILL.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-insert-phase\\SKILL.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-add-phase\\SKILL.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -File .planning\\phases\\75-sdlc-review-deterministic-parity-hardening | Select-Object Name,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n -S \"latest Figma|latest spec|deterministic|Unmapped findings: 0|Never report `100/100`|REVIEW_ROOT_CONFLICT|create remediation phases\" \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -TotalCount 360"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 320"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\"; $b=[System.IO.File]::ReadAllBytes($p); ($b[0..3] | ForEach-Object { $_.ToString('X2') }) -join ' '"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\"; $b=[System.IO.File]::ReadAllBytes($p); ($b[0..3] | ForEach-Object { $_.ToString('X2') }) -join ' '"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 8"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force -Directory | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force -Directory .. | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File .codex\\skills\\gsd-sdlc-review,.codex\\skills\\gsd-auto-dev -ErrorAction SilentlyContinue | Select-Object FullName,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .codex | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-FileHash \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -Algorithm SHA256 | Select-Object Path,Hash"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-FileHash \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Algorithm SHA256 | Select-Object Path,Hash; Get-FileHash \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Algorithm SHA256 | Select-Object Path,Hash"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-FileHash \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -Algorithm SHA256 | Select-Object Path,Hash"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -Force; Copy-Item \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Force; 'COPIED'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git add .codex/skills/gsd-sdlc-review/SKILL.md .codex/skills/gsd-auto-dev/SKILL.md"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git commit -m \"feat(skills): enforce deterministic SDLC parity and remediation phase mapping\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git push origin main"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 42592 | Select-Object Id,ProcessName,StartTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$summary='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'; if (Test-Path $summary) { $item=Get-Item $summary; $m=Select-String -Path $summary -Pattern '(?<score>\\d{1,3})\\s*/\\s*100' -AllMatches; $score=$null; if($m){ $last=$m.Matches[$m.Matches.Count-1]; $score=$last.Groups['score'].Value }; [pscustomobject]@{Path=$summary; LastWriteTime=$item.LastWriteTime; Size=$item.Length; ParsedScore=if($score){\"$score/100\"}else{'NOT_FOUND'}} } else { 'SUMMARY_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$script='C:\\Users\\rjain\\AppData\\Local\\Temp\\run-gsd-auto-dev-unattended.ps1'; if(Test-Path $script){ Get-Item $script | Select-Object FullName,LastWriteTime,Length } else {'SCRIPT_NOT_FOUND'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$id=42592; if (Get-Process -Id $id -ErrorAction SilentlyContinue) { Get-Process -Id $id | Select-Object Id,ProcessName,StartTime,CPU,Responding } else { 'RUNNER_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$id=42592; Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq $id -or ($_.Name -match 'codex') } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$summary='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'; if (Test-Path $summary) { $item=Get-Item $summary; $m=Select-String -Path $summary -Pattern '(?<score>\\d{1,3})\\s*/\\s*100' -AllMatches; $score='NOT_FOUND'; if($m -and $m.Matches.Count -gt 0){ $score = \"$($m.Matches[$m.Matches.Count-1].Groups['score'].Value)/100\" }; \"Path=$summary\"; \"LastWriteTime=$($item.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"Size=$($item.Length)\"; \"ParsedScore=$score\"; \"TopLines=\"; Get-Content $summary -TotalCount 20 } else { 'SUMMARY_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 46684 -ErrorAction SilentlyContinue; if($p){ $wmi=Get-CimInstance Win32_Process -Filter \"ProcessId=46684\"; \"Running=YES\"; \"Id=$($p.Id)\"; \"StartTime=$($p.StartTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"CPU=$($p.CPU)\"; \"Responding=$($p.Responding)\"; \"CommandLine=$($wmi.CommandLine)\" } else { 'Running=NO' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 42592 -or ($_.Name -eq 'codex.exe' -and $_.CommandLine -like '*$gsd-auto-dev*') } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$summary='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'; if (Test-Path $summary) { $item=Get-Item $summary; $m=Select-String -Path $summary -Pattern '(?<score>\\d{1,3})\\s*/\\s*100' -AllMatches; $score='NOT_FOUND'; if($m -and $m.Matches.Count -gt 0){ $score = \"$($m.Matches[$m.Matches.Count-1].Groups['score'].Value)/100\" }; \"LastWriteTime=$($item.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"Size=$($item.Length)\"; \"ParsedScore=$score\" } else { 'SUMMARY_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=42592; if (Get-Process -Id $runner -ErrorAction SilentlyContinue) { Get-Process -Id $runner | Select-Object Id,ProcessName,StartTime,CPU,Responding } else { 'RUNNER_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec --dangerously-bypass-approvals-and-sandbox -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\" '$gsd-sdlc-review'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $files=@('docs/review/EXECUTIVE-SUMMARY.md','docs/review/FULL-REPORT.md','docs/review/DEVELOPER-HANDOFF.md','docs/review/PRIORITIZED-TASKS.md','docs/review/TRACEABILITY-MATRIX.md','docs/review/layers/deterministic-parity.json','docs/review/layers/design-route-parity.json','docs/review/layers/design-screen-import-parity.json','docs/review/layers/remote-agent-four-source-parity.json','docs/review/layers/db-plan-parity.json'); foreach($r in $files){ $p=Join-Path $root $r; \"${r} => \" + (Test-Path $p) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $road=Join-Path $root '.planning/ROADMAP.md'; $state=Join-Path $root '.planning/STATE.md'; if(Test-Path $road){ 'ROADMAP_ENTRIES:'; Select-String -Path $road -Pattern '58-fix-design-route-contract|59-fix-remote-agent-spec-parity|60-fix-db-plan-inventory-parity|61-fix-backend-usp-reference-drift|Phase 58|Phase 59|Phase 60|Phase 61' | Select-Object -First 30 | ForEach-Object { $_.Line } } else {'MISSING_ROADMAP'}; if(Test-Path $state){ 'STATE_ENTRIES:'; Select-String -Path $state -Pattern 'Phase 58|Phase 59|Phase 60|Phase 61|Pending remediation phases' | Select-Object -First 30 | ForEach-Object { $_.Line } } else {'MISSING_STATE'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $f=Join-Path $root 'docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $f){ $i=Get-Item $f; $m=Select-String -Path $f -Pattern 'Health Score|Severity Totals|Deterministic Parity Totals|Unmapped findings' -SimpleMatch; \"LastWrite=$($i.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; $m | ForEach-Object { $_.Line } } else { 'MISSING_EXEC_SUMMARY' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'; $raw=Get-Content -Raw $f; $h=[regex]::Match($raw,'Health Score:\\s*\\*\\*(\\d+/100)\\*\\*'); $s=[regex]::Match($raw,'Severity Totals[^\\n]*\\*\\*(.+?)\\*\\*'); $d=[regex]::Match($raw,'Deterministic Parity Totals[^\\n]*\\*\\*(.+?)\\*\\*'); $u=[regex]::Match($raw,'Unmapped findings:\\s*\\*\\*(\\d+)\\*\\*'); \"Health=$($h.Groups[1].Value)\"; \"Severity=$($s.Groups[1].Value)\"; \"Deterministic=$($d.Groups[1].Value)\"; \"Unmapped=$($u.Groups[1].Value)\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$state='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\STATE.md'; if(Test-Path $state){ Get-Content $state -TotalCount 140 } else { 'STATE_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; if(Test-Path $road){ Get-Content $road -TotalCount 200 } else { 'ROADMAP_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n -S \"Deterministic Drift Totals|supplemental|REVIEW_PARSE_FAILURE|deterministic drift total is `0`|Do not emit `100/100` while any deterministic drift counter is non-zero\" \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = Get-ChildItem docs\\SDLC\\Phase_*.md | Sort-Object Name; foreach ($f in $files) { Write-Output \"===== $($f.Name) =====\"; Select-String -Path $f.FullName -Pattern '^# ','^## ','^### ' | ForEach-Object { $_.Line } ; Write-Output \"\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_I_Figma_Design_Update.md; for($i=0;$i -lt $c.Count;$i++){ if($c[$i] -match '^## ' -or $c[$i] -match '^### '){ '{0}: {1}' -f ($i+1), $c[$i] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_G_Completion_Release_Readiness.md; for($i=0;$i -lt $c.Count;$i++){ if($c[$i] -match '^## ' -or $c[$i] -match '^### '){ '{0}: {1}' -f ($i+1), $c[$i] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_C_UI_Prototyping_Figma_Full_Stack_Generation.md; for($i=0;$i -lt $c.Count;$i++){ if($c[$i] -match '^## ' -or $c[$i] -match '^### ' -or $c[$i] -match '^# API Build' -or $c[$i] -match '^# React Build'){ '{0}: {1}' -f ($i+1), $c[$i] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\"; $b=[System.IO.File]::ReadAllBytes($p); \"AUTO_HEAD=\" + (($b[0..3] | ForEach-Object { $_.ToString('X2') }) -join ' '); Get-Content $p -TotalCount 40"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\"; $b=[System.IO.File]::ReadAllBytes($p); \"SDLC_HEAD=\" + (($b[0..3] | ForEach-Object { $_.ToString('X2') }) -join ' '); Get-Content $p -TotalCount 40"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_C_UI_Prototyping_Figma_Full_Stack_Generation.md; $ranges=@([int[]](48,72),[int[]](350,434)); foreach($r in $ranges){ $start=$r[0]; $end=$r[1]; \"--- lines $start-$end ---\"; for($i=$start;$i -le $end;$i++){ '{0}: {1}' -f $i,$c[$i-1] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_G_Completion_Release_Readiness.md; $ranges=@([int[]](62,219),[int[]](239,272)); foreach($r in $ranges){ $start=$r[0]; $end=$r[1]; \"--- lines $start-$end ---\"; for($i=$start;$i -le $end;$i++){ '{0}: {1}' -f $i,$c[$i-1] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_I_Figma_Design_Update.md; $ranges=@([int[]](36,66),[int[]](237,261)); foreach($r in $ranges){ $start=$r[0]; $end=$r[1]; \"--- lines $start-$end ---\"; for($i=$start;$i -le $end;$i++){ '{0}: {1}' -f $i,$c[$i-1] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_E_Contract_Freeze.md; for($i=0;$i -lt $c.Count;$i++){ if($c[$i] -match '^## ' -or $c[$i] -match '^### '){ '{0}: {1}' -f ($i+1), $c[$i] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_E_Contract_Freeze.md; $ranges=@([int[]](97,247)); foreach($r in $ranges){$start=$r[0];$end=$r[1];\"--- lines $start-$end ---\";for($i=$start;$i -le $end;$i++){ '{0}: {1}' -f $i,$c[$i-1] }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_E_Contract_Freeze.md; for($i=97;$i -le 247;$i++){ '{0}: {1}' -f $i,$c[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_F_Validate_Enhance_Build.md; for($i=0;$i -lt $c.Count;$i++){ if($c[$i] -match '^## ' -or $c[$i] -match '^### '){ '{0}: {1}' -f ($i+1), $c[$i] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_F_Validate_Enhance_Build.md; for($i=57;$i -le 520;$i++){ '{0}: {1}' -f $i,$c[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_H_Clone_Intake.md; for($i=1;$i -le $c.Count;$i++){ if($i -ge 120 -and $i -le 220){ '{0}: {1}' -f $i,$c[$i-1] } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_Q_Go_Live.md; for($i=200;$i -le 320;$i++){ '{0}: {1}' -f $i,$c[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_O_DB_Promote.md; for($i=210;$i -le 320;$i++){ '{0}: {1}' -f $i,$c[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -Pattern \"Deterministic Drift Totals|supplemental|drift counter is non-zero\" | ForEach-Object { $_.Line }; Select-String -Path \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Pattern \"REVIEW_PARSE_FAILURE|deterministic drift total is `0`|Deterministic Drift Totals\" | ForEach-Object { $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec --dangerously-bypass-approvals-and-sandbox -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\" \"reply with OK\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('Phase_A_Intake_Requirements.md','Phase_B_Specification_Architecture_Pack.md','Phase_C_UI_Prototyping_Figma_Full_Stack_Generation.md','Phase_D_Business_Design_Approval.md','Phase_E_Contract_Freeze.md','Phase_F_Validate_Enhance_Build.md','Phase_G_Completion_Release_Readiness.md','Phase_H_Clone_Intake.md','Phase_I_Figma_Design_Update.md','Phase_J_Spec_Refresh.md','Phase_K_AI_Code_Update_Handoff.md','Phase_L_Alpha_Deploy_Tests.md','Phase_M_Beta_UI_Regression.md','Phase_N_DB_Rehearsal.md','Phase_O_DB_Promote.md','Phase_P_RTM_UI_Beta.md','Phase_Q_Go_Live.md','Phase_R_Closeout_Telemetry_Pruning.md'); foreach($f in $files){\"===== $f =====\"; $c=Get-Content (\"docs/SDLC/\"+$f); foreach($line in $c){ if($line -match '^### Step ' -or $line -match '^\\*\\*If .+fails' -or $line -match '^\\*\\*If Rollback' -or $line -match '^\\*\\*Rollback Decision' -or $line -match '^\\*\\*Phase .+ is not successful'){ $line } } ;\"\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content docs\\SDLC\\Phase_G_Completion_Release_Readiness.md; for($i=49;$i -le 239;$i++){ '{0}: {1}' -f $i,$c[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" add -u .codex/skills; git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" commit -m \"fix(skills): remove BOM parser failures and harden sdlc auto-dev gates\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" push origin main"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\playwright'; if(Test-Path $p){ Remove-Item -Recurse -Force $p; 'REMOVED_PLAYWRIGHT_DIR' } else { 'NO_PLAYWRIGHT_DIR' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Pattern \"final confirmation .*gsd-sdlc-review|deterministic drift total is `0`\" | ForEach-Object { $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Pattern \"final confirmation|deterministic drift total\" | ForEach-Object { $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\"; $i=1; Get-Content $p | ForEach-Object {\"$i`:` $_\"; $i++} | Select-String -Pattern \"Stop conditions|Success only if all are true|pending phase list is empty|no unmapped findings|Limit:\" -Context 0,8"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\"; $i=1; Get-Content $p | ForEach-Object {\"$i`:` $_\"; $i++} | Select-String -Pattern \"Success only if all are true|no unmapped findings|final confirmation|Limit:\" -Context 0,4"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=\"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\"; $raw=[System.IO.File]::ReadAllText($p); \"HAS_NULL=\" + $raw.Contains([char]0); $i=1; Get-Content $p | ForEach-Object {\"$i`:` $_\"; $i++} | Select-String -Pattern \"final confirmation|drift total `0`|Success only if all are true\" -Context 0,3"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item \"$env:USERPROFILE\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-auto-dev\\SKILL.md\" -Force; Copy-Item \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -Force; 'SYNCED_FINAL_TWO'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" add .codex/skills/gsd-auto-dev/SKILL.md; git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" commit -m \"chore(auto-dev): require final clean confirmation review\"; git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" push origin main"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning; if(Test-Path .planning\\phases){Get-ChildItem -Force .planning\\phases}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases -Directory | Select-Object Name | Sort-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\archive\\timeline-legacy-2026-02-21\\phases -Force | Select-Object Name,Mode | Sort-Object Name | Select-Object -First 50"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases\\62-design-route-and-screen-parity,.planning\\phases\\63-remote-agent-spec-parity,.planning\\phases\\64-db-plan-inventory-parity,.planning\\phases\\65-backend-usp-reference-parity -File | Select-Object FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.CommandLine -match '\\$gsd-auto-dev' } | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-gsd-auto-dev' } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$summary='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'; if(Test-Path $summary){ $i=Get-Item $summary; $raw=Get-Content -Raw $summary; $h=[regex]::Match($raw,'(Health Score|Health)\\s*[:]?\\s*\\*?\\*?(\\d{1,3})\\s*/\\s*100'); \"LastWrite=$($i.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; if($h.Success){\"Health=$($h.Groups[2].Value)/100\"} else {\"Health=NOT_FOUND\"} } else {'SUMMARY_NOT_FOUND'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-CimInstance Win32_Process -Filter \"ProcessId=68244\"; if($p){ $p | Select-Object ProcessId,ParentProcessId,CreationDate,@{n='CommandLine';e={$_.CommandLine}} | Format-List } else { 'NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 13292 -or ($_.Name -eq 'codex.exe' -and $_.CommandLine -match '\\$gsd-auto-dev') } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 13292 | Select-Object Id,ProcessName,StartTime,CPU,Responding"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force \"tech-web-chatai.2\\docs\\review\\layers\" | Select-Object Name,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem src -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-Content scripts\\sdlc\\deterministic-parity.ps1).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"\\bProtectedRoute\\b|path:\\s*'|path:\\s*\\\"\" src/Client/technijian-spa/src/router.tsx -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"path:\\s*['\\\"]\" src/Client/technijian-spa/src/router.tsx -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c = Get-Content docs/spec/openapi.yaml; $c[1848..1938] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/AdminController.cs\" -Pattern '[Route(\"api/admin\")]', '[HttpGet(\"audit/logs\")]', '[HttpPost(\"~/api/audit/export\")]', '[HttpGet(\"usage/metrics\")]'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/DashboardController.cs\" -Pattern '[HttpGet(\"metrics\")]', '[HttpGet(\"stats\")]', '[HttpGet(\"charts/api-usage\")]', '[HttpGet(\"charts/model-usage\")]', '[HttpGet(\"health\")]'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/AuthController.cs\" -Pattern '[Route(\"api/[controller]\")]', '[HttpGet(\"me\")]', '[HttpPost(\"logout\")]'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/AdminController.cs\" -SimpleMatch -Pattern \"[Route(\\\"api/admin\\\")]\",\"[HttpGet(\\\"audit/logs\\\")]\",\"[HttpPost(\\\"~/api/audit/export\\\")]\",\"[HttpGet(\\\"usage/metrics\\\")]\" | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/DashboardController.cs\" -SimpleMatch -Pattern \"[HttpGet(\\\"metrics\\\")]\",\"[HttpGet(\\\"stats\\\")]\",\"[HttpGet(\\\"charts/api-usage\\\")]\",\"[HttpGet(\\\"charts/model-usage\\\")]\",\"[HttpGet(\\\"health\\\")]\" | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"src/Server/Technijian.Api/Controllers/AuthController.cs\" -SimpleMatch -Pattern \"[Route(\\\"api/[controller]\\\")]\",\"[HttpGet(\\\"me\\\")]\",\"[HttpPost(\\\"logout\\\")]\" | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path 'src/Server/Technijian.Api/Controllers/AdminController.cs' -SimpleMatch -Pattern @('api/admin','[HttpGet(\"audit/logs\")]','[HttpPost(\"~/api/audit/export\")]','[HttpGet(\"usage/metrics\")]') | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path 'src/Server/Technijian.Api/Controllers/AuthController.cs' -SimpleMatch -Pattern @('api/[controller]','[HttpGet(\"me\")]','[HttpPost(\"logout\")]') | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path 'src/Server/Technijian.Api/Controllers/DashboardController.cs' -SimpleMatch -Pattern @('[HttpGet(\"metrics\")]','[HttpGet(\"stats\")]','[HttpGet(\"charts/api-usage\")]','[HttpGet(\"charts/model-usage\")]','[HttpGet(\"health\")]') | ForEach-Object { \"{0}:{1}:{2}\" -f $_.Path.Replace((Get-Location).Path+'\\\\',''), $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = @('src/Client/technijian-spa/src/components/screens/CreateAssistant.tsx','src/Client/technijian-spa/src/components/screens/WorkflowBuilderFixed2.tsx','src/Client/technijian-spa/src/components/screens/admin/TenantsFixed.tsx','src/Client/technijian-spa/src/components/screens/admin/TenantEditNew.tsx'); foreach($f in $files){ if(Test-Path $f){\"EXISTS $f\"} else {\"MISSING $f\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files = @('src/Client/technijian-spa/src/components/screens/AssistantCreate.tsx','src/Client/technijian-spa/src/components/screens/WorkflowBuilder.tsx','src/Client/technijian-spa/src/components/screens/admin/Tenants.tsx','src/Client/technijian-spa/src/components/screens/admin/TenantEdit.tsx'); foreach($f in $files){ if(Test-Path $f){\"EXISTS $f\"} else {\"MISSING $f\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path 'scripts/sdlc/deterministic-parity.ps1' -SimpleMatch -Pattern @('CouncilController =','AgentsController =','$councilControllerPaths =',' $agentsControllerPaths =','OpenApiCouncil','OpenApiAgents','RemoteAgentRequired','ApiSpMap','BackendSpRefs') | ForEach-Object { \"scripts/sdlc/deterministic-parity.ps1:{0}:{1}\" -f $_.LineNumber, $_.Line.Trim() }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning | Select-Object Name,Length,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning\\phases | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning\\phases\\65-backend-usp-reference-parity | Select-Object Name,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content -Path"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='scripts\\sdlc\\_overwrite-test.tmp'; Set-Content -Path $p -Value 'v1' -Force; Set-Content -Path $p -Value 'v2' -Force; Get-Content $p"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "attrib \"scripts\\sdlc\\deterministic-parity.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "icacls \"scripts\\sdlc\\deterministic-parity.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \"scripts\\sdlc\\deterministic-parity.ps1\" | Select-Object FullName,Attributes,IsReadOnly,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \"scripts\\sdlc\\deterministic-parity.ps1\" | Format-List FullName,Attributes,LinkType,Target"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Rename-Item -Path \"scripts\\sdlc\\deterministic-parity.ps1\" -NewName \"deterministic-parity.ps1.bak\" -Force"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force scripts\\sdlc | Select-Object Name,Length,Mode,Attributes"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content -Path \"scripts\\sdlc\\foo.ps1\" -Value \"Write-Output 'ok'\" -Force; Get-Content scripts\\sdlc\\foo.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Rename-Item -Path \"scripts\\sdlc\\foo.ps1\" -NewName \"deterministic-parity.ps1\" -Force; Get-ChildItem scripts\\sdlc | Select-Object Name,Length,Attributes"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content -Path \"scripts\\sdlc\\deterministic-parity.ps1\" -Value \"# test`nWrite-Output 'x'\" -Force; Get-Content scripts\\sdlc\\deterministic-parity.ps1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Content -Path \"scripts\\sdlc\\patch-test.txt\" -Value \"a\" -Force"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$big = ('line`n' * 5000); Set-Content -Path \"scripts\\sdlc\\big-test.txt\" -Value $big -Force; (Get-Item scripts\\sdlc\\big-test.txt).Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item \"scripts\\sdlc\\deterministic-parity.ps1.bak\" \"scripts\\sdlc\\deterministic-parity.ps1\" -Force; (Get-Item scripts\\sdlc\\deterministic-parity.ps1).Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity.ps1; $start=($c | Select-String -Pattern '^\\$paths\\s*=\\s*@\\{' -SimpleMatch).LineNumber; $c[($start-1)..($start+20)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity.ps1; $start=($c | Select-String -Pattern '$paths = @{').LineNumber; $c[($start-2)..($start+20)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path scripts\\sdlc\\deterministic-parity.ps1 -Pattern 'paths = @{' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item \"scripts\\sdlc\\deterministic-parity.ps1.bak\" \"scripts\\sdlc\\deterministic-parity.ps1\" -Force; (Get-Content scripts\\sdlc\\deterministic-parity.ps1 | Measure-Object -Line).Lines"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item \"scripts\\sdlc\\deterministic-parity.ps1.bak\" \"scripts\\sdlc\\deterministic-parity-expanded.ps1\" -Force; (Get-Content scripts\\sdlc\\deterministic-parity-expanded.ps1 | Measure-Object -Line).Lines"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='scripts\\sdlc\\deterministic-parity-expanded.ps1'; $text=Get-Content -Raw $path; $old='$openApiPaths = @(Get-OpenApiPaths -OpenApiPath $paths.OpenApi)`r`n$councilControllerPaths = @(Get-ControllerRoutes -ControllerPath $paths.CouncilController)`r`n$agentsControllerPaths = @(Get-ControllerRoutes -ControllerPath $paths.AgentsController)'; $new='$openApiPaths = @(Get-OpenApiPaths -OpenApiPath $paths.OpenApi)`r`n$councilControllerPaths = @(Get-ControllerRoutes -ControllerPath $paths.CouncilController)`r`n$agentsControllerPaths = @(Get-ControllerRoutes -ControllerPath $paths.AgentsController)`r`n$controllerInventory = Get-ControllerRouteInventory -ControllersRoot $paths.ControllersRoot`r`n$allControllerPaths = @($controllerInventory.allRoutes)'; $text=$text.Replace($old,$new); Set-Content -Path $path -Value $text -Force;"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='scripts\\sdlc\\deterministic-parity-expanded.ps1'; $text=Get-Content -Raw $path; $old='$missingCouncilInOpenApi = @(Get-SortedDifference -Left $councilControllerPaths -Right $openApiCouncilPaths)`r`n$extraCouncilInOpenApi = @(Get-SortedDifference -Left $openApiCouncilPaths -Right $councilControllerPaths)`r`n$missingAgentsInOpenApi = @(Get-SortedDifference -Left $agentsControllerPaths -Right $openApiAgentPaths)`r`n$extraAgentsInOpenApi = @(Get-SortedDifference -Left $openApiAgentPaths -Right $agentsControllerPaths)'; $new='$missingCouncilInOpenApi = @(Get-SortedDifference -Left $councilControllerPaths -Right $openApiCouncilPaths)`r`n$extraCouncilInOpenApi = @(Get-SortedDifference -Left $openApiCouncilPaths -Right $councilControllerPaths)`r`n$missingAgentsInOpenApi = @(Get-SortedDifference -Left $agentsControllerPaths -Right $openApiAgentPaths)`r`n$extraAgentsInOpenApi = @(Get-SortedDifference -Left $openApiAgentPaths -Right $agentsControllerPaths)`r`n$missingAllControllersInOpenApi = @(Get-SortedDifference -Left $allControllerPaths -Right $openApiPaths)`r`n$extraAllControllersInOpenApi = @(Get-SortedDifference -Left $openApiPaths -Right $allControllerPaths)'; $text=$text.Replace($old,$new); Set-Content -Path $path -Value $text -Force;"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity-expanded.ps1; $i=($c | Select-String -Pattern '\\$mismatchCounts\\s*=\\s*\\[ordered\\]@\\{' ).LineNumber; $c[($i-1)..($i+25)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity-expanded.ps1; $m=Select-String -Path scripts\\sdlc\\deterministic-parity-expanded.ps1 -Pattern '\\$mismatchCounts\\s*=\\s*\\[ordered\\]@\\{'; $i=$m[0].LineNumber; $c[($i-1)..($i+25)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity-expanded.ps1; $start=($c | Select-String -Pattern 'openApiAgents = \\[ordered\\]@\\{' ).LineNumber; $c[($start-1)..($start+20)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$c=Get-Content scripts\\sdlc\\deterministic-parity-expanded.ps1; $m=Select-String -Path scripts\\sdlc\\deterministic-parity-expanded.ps1 -Pattern 'openApiAgents = \\[ordered\\]@\\{'; $start=$m[0].LineNumber; $c[($start-1)..($start+20)] -join \"`n\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force scripts\\sdlc | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --show-toplevel; git status --short"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force docs | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg --files .planning\\codebase\\figma .planning\\codebase\\specs src client server 2>$null"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -Depth 3 design | Select-Object FullName,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& .\\scripts\\sdlc\\deterministic-parity.ps1 -RepoRoot . -PassThruJson"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem docs\\spec -Force | Select-Object Name,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js init resume"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git reflog -n 20 --date=local"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File | Sort-Object LastWriteTime -Descending | Select-Object -First 12 FullName,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File | Where-Object { $_.FullName -notmatch '\\\\.git\\\\' } | Sort-Object LastWriteTime -Descending | Select-Object -First 15 FullName,@{Name='LastWrite';Expression={$_.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss')}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File | Where-Object { $_.FullName -notmatch '\\\\.git\\\\' } | Sort-Object LastWriteTime -Descending | Select-Object -First 15 | ForEach-Object { \"{0}  {1}\" -f $_.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'), $_.FullName }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File | Group-Object Extension | Sort-Object Count -Descending | Select-Object -First 20 Count,Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths = @('.planning/ROADMAP.md','.planning/STATE.md','docs/spec','docs/review','design/figma','src/Client','src/Server','db'); foreach($p in $paths){ if(Test-Path $p){\"FOUND  $p\"} else {\"MISSING $p\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('src/Client/mytest-spa/src','src/Server/MyTest.Api/Controllers','db/sql','docs/spec/openapi.yaml','docs/spec/ui-contract.md','docs/spec/apitospmap.csv','docs/spec/db-plan.md','design/figma'); foreach($p in $paths){ if(Test-Path $p){\"FOUND  $p\"} else {\"MISSING $p\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/SDLC/phase.g.reporeorg/output/validation-report.json'; $c=Get-Content $p; $start=265; $end=305; for($i=$start;$i -le $end;$i++){ if($i -lt $c.Length){ \"{0}:{1}\" -f ($i+1), $c[$i] }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Recurse -File | Where-Object { $_.Name -match 'figma|storyboard|ui-contract|openapi|apitospmap|db-plan|remote-agent|spec' } | Sort-Object LastWriteTime -Descending | Select-Object -First 40 | ForEach-Object { \"{0}  {1}\" -f $_.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'), $_.FullName }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Status:\\s*ALL SCREENS COMPLETE|Gaps Identified:\\s*NONE|OVERALL\\*\\* \\| \\*\\*45/100\\*\\* \\| \\*\\*85/100\\*\\*|/docs/sdlc/spec/openapi.yaml|/docs/spec/|exists\\\": true\" docs/SDLC/Phase_F_Validation_Report.md docs/SDLC/phase.f.storyboards/output/validation-report.md docs/SDLC/phase.g.reporeorg/output/validation-report.json docs/SDLC/phase.g.reporeorg/output/FINAL_VALIDATION_REPORT.md -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$missing=@('src/Client','src/Server','db','docs/spec','design/figma','.planning/ROADMAP.md','.planning/STATE.md'); foreach($m in $missing){ if(-not (Test-Path $m)){\"MISSING $m\"} else {\"FOUND $m\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$patterns=@('*.cs','*.csproj','*.sln','*.ts','*.tsx','*.js','*.jsx','*.sql','openapi.yaml','openapi.json','ui-contract.md','apitospmap.csv','db-plan.md'); foreach($pat in $patterns){ $count=(Get-ChildItem -Recurse -File -Filter $pat | Measure-Object).Count; \"{0}={1}\" -f $pat,$count }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "New-Item -ItemType Directory -Force -Path 'docs/review'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$checks=@('scripts/sdlc/deterministic-parity.ps1','scripts/sdlc','scripts','.planning'); foreach($c in $checks){ if(Test-Path $c){\"FOUND $c\"} else {\"MISSING $c\"}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path 'C:/Users/rjain/.codex/skills/gsd-sdlc-review/SKILL.md' | Select-String -Pattern 'Mandatory pre-review checkpoint and milestone rotation|git commit -m|git push origin|gsd:complete-milestone|gsd:new-milestone|implementation evidence census|stale-report contradiction checks' -Context 0,1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Test-Path 'C:/Users/rjain/.codex/skills/gsd-sdlc-review/SKILL.md'; if($?){Get-Content -Path 'C:/Users/rjain/.codex/skills/gsd-sdlc-review/SKILL.md' -TotalCount 40}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git ls-remote https://github.com/rjain557/codex-skills.git HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-skills'){ 'FOUND c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-skills' } else { 'MISSING c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-skills' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\anthropic-skills\\.git'){ git -C 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\anthropic-skills' remote -v } else { 'skip' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\anthropic-skills\\.git'){ 'FOUND anthopic-skills git repo' } else { 'NO anthopic-skills git repo' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --show-toplevel; git status --short --branch; git remote -v"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Copy-Item -Path 'C:/Users/rjain/.codex/skills/gsd-sdlc-review/SKILL.md' -Destination 'c:/Users/rjain/OneDrive - Technijian, Inc/Documents/VSCode/codex-settings/.codex/skills/gsd-sdlc-review/SKILL.md' -Force"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git add .codex/skills/gsd-sdlc-review/SKILL.md; git commit -m \"skill(gsd-sdlc-review): enforce deterministic deep review and milestone checkpoint\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", ". $PROFILE; Get-Command gsd-auto-dev | Format-List Name,CommandType,Source,Definition"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$project='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc'; $logDir=Join-Path $project '.planning\\logs'; New-Item -ItemType Directory -Force -Path $logDir | Out-Null; $ts=Get-Date -Format 'yyyyMMdd-HHmmss'; $log=Join-Path $logDir \"gsd-auto-dev-$ts.log\"; $inner=\". `$PROFILE; gsd-auto-dev -ProjectPath '$project' -TargetScore 100 -MaxIterations 50 -PrepTimeout 60 -ExecuteTimeout 90 -ReviewTimeout 90 -VerifyTimeout 30 *>&1 | Tee-Object -FilePath '$log'\"; Start-Process -FilePath 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' -ArgumentList '-NoExit','-Command',$inner -WorkingDirectory $project; Write-Output \"STARTED_LOG=$log\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process | Where-Object { $_.ProcessName -like 'powershell*' } | Select-Object Id,ProcessName,StartTime | Sort-Object StartTime -Descending | Select-Object -First 5"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105027.log'; if(Test-Path $log){ (Get-Item $log).Length } else { -1 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105027.log'; if(Test-Path $log){ Get-Content -Path $log -Tail 40 } else { 'LOG_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process | Where-Object { $_.ProcessName -like 'powershell*' } | Select-Object Id,ProcessName,StartTime | Sort-Object StartTime -Descending | Select-Object -First 6"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105110.log'; Start-Sleep -Seconds 2; if(Test-Path $log){ Get-Content -Path $log -Tail 80 } else { 'LOG_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --short HEAD; git status --short --branch"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev' } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$pids=@(123596,122508); foreach($id in $pids){ if(Get-Process -Id $id -ErrorAction SilentlyContinue){ Stop-Process -Id $id -Force; \"STOPPED $id\" } else { \"MISSING $id\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$project='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc'; $logDir=Join-Path $project '.planning\\logs'; New-Item -ItemType Directory -Force -Path $logDir | Out-Null; $ts=Get-Date -Format 'yyyyMMdd-HHmmss'; $log=Join-Path $logDir \"gsd-auto-dev-$ts.log\"; $inner=\". `$PROFILE; gsd-auto-dev -ProjectPath '$project' -TargetScore 100 -MaxIterations 50 -PrepTimeout 60 -ExecuteTimeout 90 -ReviewTimeout 90 -VerifyTimeout 30 -PrepModel '' -ExecuteModel '' -ReviewModel '' *>&1 | Tee-Object -FilePath '$log'\"; Start-Process -FilePath 'C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe' -ArgumentList '-NoExit','-Command',$inner -WorkingDirectory $project; Write-Output \"STARTED_LOG=$log\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; Start-Sleep -Seconds 3; if(Test-Path $log){ Get-Content -Path $log -Tail 80 } else { 'LOG_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-20260221-105224.log' } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; Start-Sleep -Seconds 12; Get-Content -Path $log -Tail 80"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"$env:USERPROFILE\\.codex\\config.toml\") { Get-Content \"$env:USERPROFILE\\.codex\\config.toml\" } else { 'NO_CONFIG' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex debug --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.codex\\config.toml\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex review --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"$env:USERPROFILE\\.codex\\config.toml\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex features --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -TotalCount 340"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"param\\(|PrepModel|ExecuteModel|ReviewModel|Build-CodexExecCommand|research|plan|execute|review|codex exec\" -n \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" | Select-Object -Skip 340"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec \"Reply with exactly: ok\" -c model_reasoning_effort=medium -m gpt-5.3-codex --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --cd \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"execute-phase-\\$p|Invoke-CodexWithTimeout -Prompt \\\"\\$execSkill \\$p\\\"|ReasoningEffort|Models:|Reason:\" \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -Pattern \"execute-phase-\\$p\" -Context 2,3"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path \"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\" -SimpleMatch -Pattern \"execute-phase-$p\" -Context 2,3"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path=\"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile($path,[ref]$tokens,[ref]$errors) | Out-Null; if($errors -and $errors.Count -gt 0){ $errors | ForEach-Object { $_.Message }; exit 1 } else { 'PARSER_OK' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git add .codex/scripts/gsd-runner-codex.ps1; git commit -m \"runner(gsd-auto-dev): set per-step reasoning effort defaults and normalize model aliases\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js init new-milestone"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force .planning | Where-Object {$_.Name -like '*AUDIT*' -or $_.Name -like 'v*-MILESTONE-AUDIT.md'} | Select-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git add .codex/skills/gsd-sdlc-review/SKILL.md; git commit -m \"skill(gsd-sdlc-review): use executive summary as publication commit message\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$logDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs'; Get-ChildItem -Path $logDir -File | Sort-Object LastWriteTime -Descending | Select-Object -First 5 FullName,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; if(Test-Path $log){ Get-Content -Path $log -Tail 140 } else { 'LOG_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; Get-Content -Path $log -Tail 50"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 135084 -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,CPU,Responding"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; (Get-Item $log).Length; (Get-Item $log).LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& powershell -NoProfile -ExecutionPolicy Bypass -File '.\\run-autodev-headless.ps1' -DryRun -MaxOuterLoops 1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item 'C:/Users/rjain/.codex/skills/gsd-auto-dev/SKILL.md' | Select-Object FullName,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item 'C:/Users/rjain/.codex/skills/gsd-sdlc-review/SKILL.md' | Select-Object FullName,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& powershell -NoProfile -ExecutionPolicy Bypass -File '.\\run-autodev-headless.ps1' -MaxOuterLoops 12 -AutoDevMaxCycles 20"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& powershell -NoProfile -ExecutionPolicy Bypass -File '.\\run-autodev-headless.ps1' -Runner claude -MaxOuterLoops 12 -AutoDevMaxCycles 20"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Name powershell | Sort-Object StartTime -Descending | Select-Object -First 3 Id,StartTime,MainWindowTitle"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem '.planning/agent-output' -Filter 'auto-dev-run-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 3 Name,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Name claude -ErrorAction SilentlyContinue | Select-Object Id,StartTime,ProcessName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process -Filter \"Name = 'claude.exe'\" | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "where.exe claude"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem '.planning/agent-output' -Filter 'auto-dev-run-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 5 Name,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Name claude -ErrorAction SilentlyContinue | Select-Object Id,CPU,StartTime,Responding"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -like '*$gsd-auto-dev --write --max-cycles 20*' } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -like '*run-autodev-headless.ps1*' } | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$logDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs'; $latest=Get-ChildItem -Path $logDir -File | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($latest){ \"LOG=$($latest.FullName)\"; \"LASTWRITE=$($latest.LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"SIZE=$($latest.Length)\"; Get-Content -Path $latest.FullName -Tail 140 } else { 'NO_LOGS' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; (Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'); (Get-Item $log).Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& powershell -NoProfile -ExecutionPolicy Bypass -File '.\\run-autodev-headless.ps1' -Runner codex -MaxOuterLoops 1 -AutoDevMaxCycles 1"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.CommandLine -like '*$gsd-auto-dev*' } | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec \"$gsd-help\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec '$gsd-help'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; if(Test-Path $log){ \"LASTWRITE=$((Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"SIZE=$((Get-Item $log).Length)\"; Get-Content -Path $log -Tail 160 } else { 'LOG_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; Start-Sleep -Seconds 6; \"LASTWRITE=$((Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; Get-Content -Path $log -Tail 60"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem \"$env:USERPROFILE\\.claude\\scripts\" -Force | Select-Object Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content \"$env:USERPROFILE\\.claude\\scripts\\gsd-runner-gemini.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc' -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 56024 }).CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path 'docs/review/EXECUTIVE-SUMMARY.md') { Get-Content 'docs/review/EXECUTIVE-SUMMARY.md' -TotalCount 30 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; if(Test-Path $log){ \"LASTWRITE=$((Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; \"SIZE=$((Get-Item $log).Length)\"; Get-Content -Path $log -Tail 180 } else { 'LOG_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; Start-Sleep -Seconds 4; \"LASTWRITE=$((Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; Get-Content -Path $log -Tail 40"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git add .codex/skills/gsd-sdlc-review/SKILL.md; git commit -m \"skill(gsd-sdlc-review): auto-remediate git push failures before proceeding\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$latest = Get-ChildItem '.planning/agent-output' -Filter 'auto-dev-run-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($latest){Get-Content $latest.FullName -Tail 80}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --short HEAD; git status --short --branch; git log -1 --oneline"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; if(Test-Path $log){ Get-Content -Path $log -Tail 120 } else { 'LOG_NOT_FOUND' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev' } | Select-Object ProcessId,CreationDate"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; \"LASTWRITE=$((Get-Item $log).LastWriteTime.ToString('yyyy-MM-dd HH:mm:ss'))\"; Get-Content -Path $log -Tail 35"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"$env:USERPROFILE\\.codex\\skills\\gsd-sdlc-review\\SKILL.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"$env:USERPROFILE\\.codex\\commands\\gsd\\sdlc-review.md\" -TotalCount 260"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-sdlc\\tech-sdlc\\.planning\\logs\\gsd-auto-dev-20260221-105224.log'; rg -n \"git add|git commit|git push|ROOT-BLOCKER-PUSH-FAILED|publication commit|milestone rotation\" $log -S"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& powershell -NoProfile -ExecutionPolicy Bypass -File '.\\run-autodev-headless.ps1' -Runner codex -MaxOuterLoops 1 -AutoDevMaxCycles 1 -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"Get-Content -Raw 'C:/Users/rjain/.codex/skills|Get-Content -Raw \\\"C:/Users/rjain/.codex/skills|\\.codex/skills\" -S -uu \"$env:USERPROFILE\\.codex\\commands\\gsd\" \"$env:USERPROFILE\\.codex\\scripts\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 38832 }).CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path=\"$env:USERPROFILE\\.codex\\scripts\\gsd-runner-codex.ps1\"; $start=220; $end=300; $c=Get-Content $path; for($i=$start;$i -le $end;$i++){ if($i -le $c.Length){ '{0}:{1}' -f $i,$c[$i-1] }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p = Get-Process -Id 38832 -ErrorAction SilentlyContinue; if($p){[PSCustomObject]@{Status='RUNNING';Pid=$p.Id;CPU=[math]::Round($p.CPU,2);StartTime=$p.StartTime}} else {[PSCustomObject]@{Status='NOT_RUNNING';Pid=38832}}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1'; $tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile($p,[ref]$tokens,[ref]$errors) | Out-Null; if($errors -and $errors.Count -gt 0){ $errors | ForEach-Object { \"$($_.Extent.StartLineNumber):$($_.Extent.StartColumnNumber) $($_.Message)\" }; exit 1 } else { 'PowerShell parse check passed.' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\.codex\" rev-parse --is-inside-work-tree"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1\") { 'HAS_CODEX_SETTINGS_COPY' } else { 'NO_CODEX_SETTINGS_COPY' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1'; $tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile($p,[ref]$tokens,[ref]$errors) | Out-Null; if($errors -and $errors.Count -gt 0){ $errors | ForEach-Object { \"$($_.Extent.StartLineNumber):$($_.Extent.StartColumnNumber) $($_.Message)\" }; exit 1 } else { 'Source parse check passed.' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$a='C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1'; $b='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1'; $ha=(Get-FileHash $a -Algorithm SHA256).Hash; $hb=(Get-FileHash $b -Algorithm SHA256).Hash; \"global=$ha\"; \"repo=$hb\"; if($ha -eq $hb){ 'HASH_MATCH' } else { 'HASH_DIFFER' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\\.codex\\scripts\\gsd-runner-codex.ps1'; $tokens=$null; $errors=$null; [System.Management.Automation.Language.Parser]::ParseFile($p,[ref]$tokens,[ref]$errors) | Out-Null; if($errors -and $errors.Count -gt 0){ $errors | ForEach-Object { \"$($_.Extent.StartLineNumber):$($_.Extent.StartColumnNumber) $($_.Message)\" }; exit 1 } else { 'codex-settings parse check passed.' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" add .codex/scripts/gsd-runner-codex.ps1 && git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" commit -m \"Use global .codex/skills docs for all /gsd command resolution\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" add .codex/scripts/gsd-runner-codex.ps1; if ($LASTEXITCODE -ne 0) { exit $LASTEXITCODE }; git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" commit -m \"Use global .codex/skills docs for all /gsd command resolution\"; exit $LASTEXITCODE"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p = Get-Process -Id 38832 -ErrorAction SilentlyContinue; if($p){\"RUNNING PID=$($p.Id) CPU=$([math]::Round($p.CPU,2)) START=$($p.StartTime)\"} else {\"NOT_RUNNING PID=38832\"}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"C:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\codex-settings\" rev-parse --short HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \"C:\\Users\\rjain\\.codex\\commands\\gsd\\auto-dev.md\") { Get-Content -Path \"C:\\Users\\rjain\\.codex\\commands\\gsd\\auto-dev.md\" -TotalCount 220 } else { 'NO auto-dev.md' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Location; Get-ChildItem -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \"tech-sdlc\" -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"tech-sdlc\" rev-parse --show-toplevel; git -C \"tech-sdlc\" status --short"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Set-Location \"tech-sdlc\"; '/gsd:sdlc-review' | codex exec - --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --cd . -m gpt-5.3-codex -c model_reasoning_effort=xhigh"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 115000 -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,CPU"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -like '*run-autodev-progress-monitor.ps1*' } | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "(Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 100492 }).CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 100492 -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,CPU"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and ($_.CommandLine -like '*autodev-monitor-10min.ps1*' -or $_.CommandLine -like '*AutoDev Progress Monitor*' -or $_.CommandLine -like '*autodev-progress-10min.log*') } | Select-Object ProcessId,ParentProcessId,CreationDate"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Force run-autodev*.ps1 | Select-Object Name,Length,LastWriteTime; if (Test-Path .\\run-autodev-headless.ps1) { Write-Host '--- run-autodev-headless.ps1 ---'; Get-Content .\\run-autodev-headless.ps1 -TotalCount 260 }; if (Test-Path .\\run-autodev-progress-monitor.ps1) { Write-Host '--- run-autodev-progress-monitor.ps1 ---'; Get-Content .\\run-autodev-progress-monitor.ps1 -TotalCount 260 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { ($_.Name -match 'powershell|pwsh|codex') -and ($_.CommandLine -match 'auto-dev|gsd-auto-dev|autodev-progress|run-autodev') } | Select-Object ProcessId,ParentProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\agent-output\\auto-dev-run-20260221-120058.log) { Write-Host '--- auto-dev log tail ---'; Get-Content .planning\\agent-output\\auto-dev-run-20260221-120058.log -Tail 60 }; if (Test-Path .planning\\agent-output\\autodev-progress-10min.log) { Write-Host '--- progress log tail ---'; Get-Content .planning\\agent-output\\autodev-progress-10min.log -Tail 40 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -in @('powershell.exe','codex.exe') -and $_.CommandLine -match 'run-autodev-headless|\\$gsd-auto-dev --write --max-cycles 20' } | Select-Object ProcessId,ParentProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning\\agent-output -Filter 'auto-dev-run-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('LatestRunLog: ' + $log.FullName); Write-Host ('LastWrite: ' + $log.LastWriteTime); Write-Host ('Size: ' + $log.Length); Write-Host '--- tail ---'; Get-Content $log.FullName -Tail 30 } else { Write-Host 'No auto-dev run logs found.' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$paths=@('docs/review/EXECUTIVE-SUMMARY.md','tech-web-mytest/docs/review/EXECUTIVE-SUMMARY.md'); foreach($p in $paths){ if(Test-Path $p){ Write-Host \"--- $p ---\"; $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)Health(?:\\s+score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); [PSCustomObject]@{Path=$p;Health=($(if($h.Success){$h.Groups[1].Value}else{'unknown'}));Drift=($(if($d.Success){$d.Groups[1].Value}else{'unknown'}));Unmapped=($(if($u.Success){$u.Groups[1].Value}else{'unknown'}));LastWrite=(Get-Item $p).LastWriteTime} | Format-List } else { Write-Host \"--- $p (missing) ---\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning\\agent-output -Filter 'auto-dev-run-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if(-not $log){ Write-Host 'No run log.'; exit 0 }; Write-Host ('Log='+$log.FullName); $patterns=@('gsd-sdlc-review','sdlc review','Starting deterministic SDLC review','pending phases','Phase 82','Phase 83','Phase 84','execute-phase','research-phase','plan-phase'); foreach($p in $patterns){ Write-Host ('--- pattern: '+$p+' ---'); Select-String -Path $log.FullName -Pattern $p -CaseSensitive:$false | Select-Object -First 5 | ForEach-Object { '{0}:{1}' -f $_.LineNumber, $_.Line.Trim() } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path .planning/STATE.md){ Write-Host '--- STATE key lines ---'; Select-String -Path .planning/STATE.md -Pattern 'CURRENT_PHASE|NEXT_ACTION|LAST_COMPLETED_PHASE|PENDING_PHASES|ACTIVE_MILESTONE|STATUS' -CaseSensitive:$false | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line.Trim() } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path .planning/ROADMAP.md){ Write-Host '--- ROADMAP pending phase lines ---'; Select-String -Path .planning/ROADMAP.md -Pattern '^- \\[ \\] \\*\\*Phase' | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line.Trim() } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning\\agent-output -Filter 'auto-dev-run-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('LatestRunLog: '+$log.Name); Write-Host ('LastWrite: '+$log.LastWriteTime); Write-Host ('Size: '+$log.Length); Get-Content $log.FullName -Tail 40 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 38832 -ErrorAction SilentlyContinue; [PSCustomObject]@{Now=(Get-Date); Exists=([bool]$p); CPU=($(if($p){$p.CPU}else{$null})); StartTime=($(if($p){$p.StartTime}else{$null})); Responding=($(if($p){$p.Responding}else{$null}))} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p1=Get-Process -Id 38832 -ErrorAction SilentlyContinue; $cpu1=if($p1){$p1.CPU}else{$null}; Start-Sleep -Seconds 5; $p2=Get-Process -Id 38832 -ErrorAction SilentlyContinue; $cpu2=if($p2){$p2.CPU}else{$null}; [PSCustomObject]@{CPU1=$cpu1;CPU2=$cpu2;Delta=($(if(($null -ne $cpu1)-and($null -ne $cpu2)){[math]::Round($cpu2-$cpu1,4)}else{$null}))} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning\\agent-output -Filter 'auto-dev-run-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if(-not $log){ Write-Host 'No run log'; exit 0 }; $p='docs/review/EXECUTIVE-SUMMARY.md'; $s1=Get-Item $log.FullName; $c1=if(Test-Path $p){Get-Content -Raw $p}else''; $h1=[regex]::Match($c1,'(?im)Health(?:\\s+score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100').Groups[1].Value; $d1=[regex]::Match($c1,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)').Groups[1].Value; $u1=[regex]::Match($c1,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)').Groups[1].Value; Start-Sleep -Seconds 20; $s2=Get-Item $log.FullName; $c2=if(Test-Path $p){Get-Content -Raw $p}else''; $h2=[regex]::Match($c2,'(?im)Health(?:\\s+score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100').Groups[1].Value; $d2=[regex]::Match($c2,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)').Groups[1].Value; $u2=[regex]::Match($c2,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)').Groups[1].Value; [PSCustomObject]@{Log=$log.Name;SizeBefore=$s1.Length;SizeAfter=$s2.Length;SizeDelta=($s2.Length-$s1.Length);LastWriteBefore=$s1.LastWriteTime;LastWriteAfter=$s2.LastWriteTime;HealthBefore=$h1;DriftBefore=$d1;UnmappedBefore=$u1;HealthAfter=$h2;DriftAfter=$d2;UnmappedAfter=$u2} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 38832 -ErrorAction SilentlyContinue; if($p){ [PSCustomObject]@{Now=(Get-Date);Alive=$true;CPU=$p.CPU;WorkingSetMB=[math]::Round($p.WorkingSet64/1MB,1)}|Format-List } else { [PSCustomObject]@{Now=(Get-Date);Alive=$false}|Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n --hidden --no-ignore \"gsd-auto-dev|\\$gsd-auto-dev|gsd:sdlc-review|gsd-batch-execute\" ."], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning\\agent-output\" -Filter \"gsd-auto-dev-*.launch.ps1\" | Select-Object FullName,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning\\agent-output\" -File | Sort-Object LastWriteTime -Descending | Select-Object -First 40 Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning\\agent-output\" -Filter \"gsd-auto-dev-*.launch.ps1\" | Sort-Object LastWriteTime -Descending | Select-Object -ExpandProperty FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1\" | Select-Object -Index (760..1220)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \"C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1\" | Select-Object -Index (320..760)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning\\agent-output\" -Filter \"gsd-auto-dev-*.stderr.log\" | Sort-Object LastWriteTime -Descending | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning\\agent-output\" -Filter \"gsd-auto-dev-*.stdout.log\" | Sort-Object LastWriteTime -Descending | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f=(Get-ChildItem -Path \".planning\\agent-output\" -Filter \"gsd-auto-dev-*.stdout.log\" | Sort-Object LastWriteTime -Descending | Select-Object -Skip 2 -First 1).FullName; if($f){Write-Host \"FILE=$f\"; Get-Content -Path $f -TotalCount 260} else {Write-Host \"NOFILE\"}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "\"Reply with exactly: ok\" | codex exec - --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --cd \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\" -m gpt-5.3-codex"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p = \".planning\\agent-output\\_write_probe.txt\"; Set-Content -Path $p -Value \"ok\" -Encoding UTF8; Get-Content -Path $p; Remove-Item $p -Force"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --abbrev-ref HEAD; git rev-parse --short HEAD; git status --porcelain"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$sum='docs\\review\\EXECUTIVE-SUMMARY.md'; if(Test-Path $sum){Get-Content $sum -TotalCount 180}else{'MISSING'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rm='.planning\\ROADMAP.md'; if(Test-Path $rm){(Select-String -Path $rm -Pattern '^- \\[ \\] \\*\\*Phase (\\d+)' -AllMatches).Matches | ForEach-Object { $_.Groups[1].Value } | Sort-Object -Unique | ForEach-Object { $_ }}else{'MISSING'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path .planning -Force | Select-Object Name,Mode"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path \".planning\\ROADMAP.md\"){Get-Content -Path \".planning\\ROADMAP.md\" -TotalCount 80}else{\"ROADMAP missing\"}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path \"tech-web-chatai.2\\.planning\\ROADMAP.md\"){Get-Content -Path \"tech-web-chatai.2\\.planning\\ROADMAP.md\" -TotalCount 80}else{\"nested ROADMAP missing\"}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "& 'C:\\Users\\rjain\\.codex\\scripts\\gsd-runner-codex.ps1' -ProjectPath 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2' -ContinuousImprovement -TargetScore 100 -MaxIterations 1 -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "\"/gsd:auto-dev --write --max-cycles 1\" | codex exec - --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check --cd \"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\" -m gpt-5.3-codex"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning\\agent-output -Filter 'auto-dev-run-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('Log='+$log.Name); Write-Host ('LastWrite='+$log.LastWriteTime); Write-Host ('Size='+$log.Length); Write-Host '--- tail ---'; Get-Content $log.FullName -Tail 25 } else { Write-Host 'No auto-dev run logs found.' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$m='.planning/agent-output/autodev-progress-10min.log'; if(Test-Path $m){ Write-Host ('MonitorLastWrite=' + (Get-Item $m).LastWriteTime); Get-Content $m -Tail 3 } else { Write-Host 'Monitor log missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $p){ $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)Health(?:\\s+score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); [PSCustomObject]@{Path=$p;Health=($(if($h.Success){$h.Groups[1].Value}else{'unknown'}));Drift=($(if($d.Success){$d.Groups[1].Value}else{'unknown'}));Unmapped=($(if($u.Success){$u.Groups[1].Value}else{'unknown'}));LastWrite=(Get-Item $p).LastWriteTime} | Format-List } else { Write-Host 'Summary missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$now=Get-Date; $head=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-headless\\.ps1' } | Select-Object -First 1; $codex=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.CommandLine -like '*$gsd-auto-dev --write --max-cycles 20*' } | Select-Object -First 1; $mon=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-progress-monitor\\.ps1' } | Select-Object -First 1; [PSCustomObject]@{Timestamp=$now;AutoDevWindowPid=($head.ProcessId);CodexPid=($codex.ProcessId);MonitorWindowPid=($mon.ProcessId)} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ErrorActionPreference='Continue'; $repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-web-mytest'; Set-Location $repo; if(-not (Test-Path '.planning/agent-output')){ New-Item -ItemType Directory -Path '.planning/agent-output' -Force | Out-Null }; $stamp=Get-Date -Format 'yyyyMMdd-HHmmss'; $log=\".planning/agent-output/sdlc-review-run-$stamp.log\"; Write-Host \"Log: $log\"; codex exec --dangerously-bypass-approvals-and-sandbox -C $repo '$gsd-sdlc-review' *>&1 | Tee-Object -FilePath $log; Write-Host \"EXIT=$LASTEXITCODE\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$sum='tech-web-chatai.2/docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $sum){Get-Content $sum -TotalCount 120}else{'MISSING'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'codex|powershell' -and ($_.CommandLine -match 'gsd|auto-dev|gsd-runner-codex|/gsd:auto-dev') } | Select-Object Name,ProcessId,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$rm='tech-web-chatai.2/.planning/ROADMAP.md'; if(Test-Path $rm){$m=(Select-String -Path $rm -Pattern '^- \\[ \\] \\*\\*Phase\\s+(\\d+)' -AllMatches); if($m){$m.Matches | ForEach-Object { $_.Groups[1].Value } | Sort-Object -Unique} else {'none'}} else {'MISSING'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git -C \"tech-web-chatai.2\" rev-parse --short HEAD; git -C \"tech-web-chatai.2\" status --short | Select-Object -First 50"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $p){ Write-Host ('FILE=' + $p); Select-String -Path $p -Pattern '^## Health','^Health:','^Deterministic Drift Totals:','^Unmapped findings:','^Top findings','APISP-CONTROLLER-DRIFT','APISP-SP-DRIFT','^Publication status','Commit SHA','Target branch' -CaseSensitive:$false | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/FULL-REPORT.md'; if(Test-Path $p){ Write-Host ('FILE=' + $p); Select-String -Path $p -Pattern 'Figma/versioned deliverable','UI contract canonical equivalent','OpenAPI:','API-SP map:','DB plan:','Remote agent spec:','OpenClaw remote agent spec:','Deterministic Drift Totals:','Unmapped findings:','APISP-CONTROLLER-DRIFT','APISP-SP-DRIFT' -CaseSensitive:$false | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'sdlc-review-run-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('Log=' + $log.FullName); Write-Host ('LastWrite=' + $log.LastWriteTime); Write-Host ('Size=' + $log.Length); Get-Content $log.FullName -Tail 20 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 15; $runDir = \".planning\\agent-output\\gsd-auto-dev-20260221-145359\"; Get-ChildItem -Path $runDir -Force | Select-Object Name,Length,LastWriteTime; if(Test-Path (Join-Path $runDir 'status.json')){Get-Content -Path (Join-Path $runDir 'status.json') -Raw}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases -Directory | Select-Object Name,LastWriteTime | Sort-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 127172 -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,HasExited"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Content -Path \".planning\\agent-output\\gsd-auto-dev-controller.ps1\" | Select-Object -Index (310..345)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"\\$cycle:\" \".planning\\agent-output\\gsd-auto-dev-controller.ps1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ErrorActionPreference='Continue'; $repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-web-mytest'; Set-Location $repo; if(-not (Test-Path '.planning/agent-output')){ New-Item -ItemType Directory -Path '.planning/agent-output' -Force | Out-Null }; $log='.planning/agent-output/add-phase-apisp-controller-' + (Get-Date -Format 'yyyyMMdd-HHmmss') + '.log'; Write-Host ('Log: ' + $log); codex exec --dangerously-bypass-approvals-and-sandbox -C $repo '$gsd-add-phase APISP-CONTROLLER-DRIFT controller route parity remediation' *>&1 | Tee-Object -FilePath $log; Write-Host ('EXIT=' + $LASTEXITCODE)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 5; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; if(Test-Path $statusPath){$status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;updated_at=$status.updated_at}|ConvertTo-Json -Compress}else{[pscustomobject]@{running=[bool]$proc;state='missing';cycle=$null}|ConvertTo-Json -Compress}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 25; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;stop_reason=$status.stop_reason;updated_at=$status.updated_at}|ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 25; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;updated_at=$status.updated_at}|ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ErrorActionPreference='Continue'; $repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-web-mytest'; Set-Location $repo; if(-not (Test-Path '.planning/agent-output')){ New-Item -ItemType Directory -Path '.planning/agent-output' -Force | Out-Null }; $log='.planning/agent-output/add-phase-apisp-sp-' + (Get-Date -Format 'yyyyMMdd-HHmmss') + '.log'; Write-Host ('Log: ' + $log); codex exec --dangerously-bypass-approvals-and-sandbox -C $repo '$gsd-add-phase APISP-SP-DRIFT stored procedure parity remediation' *>&1 | Tee-Object -FilePath $log; Write-Host ('EXIT=' + $LASTEXITCODE)"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\"; Get-ChildItem -Path $runDir -Force | Select-Object Name,Length,LastWriteTime; if(Test-Path (Join-Path $runDir 'controller.log')){Write-Host '---controller tail---'; Get-Content -Path (Join-Path $runDir 'controller.log') -Tail 40}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 30; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;updated_at=$status.updated_at}|ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 300; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; $logPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\controller.log\"; $logTail = if(Test-Path $logPath){ (Get-Content -Path $logPath -Tail 5) -join \"`n\" } else {\"\"}; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;stop_reason=$status.stop_reason;updated_at=$status.updated_at;log_tail=$logTail}|ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"APISP-CONTROLLER-DRIFT|APISP-SP-DRIFT|Phase 87|Phase 89|Phase 90\" docs/review .planning/ROADMAP.md .planning/STATE.md } else { Get-ChildItem docs/review -Recurse -File | Select-String -Pattern \"APISP-CONTROLLER-DRIFT|APISP-SP-DRIFT|Phase 87|Phase 89|Phase 90\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases -Directory | Where-Object { $_.Name -match '^89-|^90-' } | Select-Object Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .planning/ROADMAP.md | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content docs/review/TRACEABILITY-MATRIX.md | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content docs/review/FULL-REPORT.md | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content docs/review/EXECUTIVE-SUMMARY.md | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path .planning/ROADMAP.md -Pattern 'Depends on' | ForEach-Object { '{0}: {1}' -f $_.LineNumber, $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$lines=Get-Content .planning/ROADMAP.md; 'L75=[' + $lines[74] + ']'; 'L90=[' + $lines[89] + ']'; 'L107=[' + $lines[106] + ']';"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='.planning/ROADMAP.md'; $text=Get-Content -Raw $path; $text=[regex]::Replace($text,'(?m)^\\*\\*Execution Order:\\*\\*.*$','**Execution Order:** 86 -> 87 -> 89 -> 90 -> 88',1); Set-Content -Path $path -Value $text -Encoding utf8; Write-Host 'updated'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"APISP-CONTROLLER-DRIFT|APISP-SP-DRIFT|Remediation mapping: Phase 87|-> Phase 87|\\| Phase 87 \\|\" docs/review .planning/ROADMAP.md .planning/STATE.md } else { Write-Host 'rg missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path .planning/ROADMAP.md -Pattern 'Execution Order|Depends on' | ForEach-Object { '{0}: {1}' -f $_.LineNumber, $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases/90-apisp-sp-drift-stored-procedure-parity-remediation -Force | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases/89-apisp-controller-drift-controller-route-parity-remediation -Force | Select-Object Name,Mode,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item docs/review/PRIORITIZED-TASKS.md | Select-Object FullName,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path docs/review/EXECUTIVE-SUMMARY.md -Pattern 'APISP-CONTROLLER-DRIFT -> Phase 89','APISP-SP-DRIFT -> Phase 90' | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path docs/review/FULL-REPORT.md -Pattern 'Remediation mapping: Phase 89','Remediation mapping: Phase 90' | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }; Select-String -Path docs/review/TRACEABILITY-MATRIX.md -Pattern '\\| Phase 89 \\|','\\| Phase 90 \\|' | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path .planning/ROADMAP.md -Pattern 'Phases 86-90','Phase 89: APISP-CONTROLLER-DRIFT','Phase 90: APISP-SP-DRIFT','Execution Order','Depends on\\*\\*: Phase 90','Depends on:\\*\\* Phase 87','Depends on:\\*\\* Phase 89' -AllMatches | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path .planning/STATE.md -Pattern 'Phase: 86 of 90','Phase 89 added','Phase 90 added' | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$a=Test-Path '.planning/phases/89-apisp-controller-drift-controller-route-parity-remediation'; $b=Test-Path '.planning/phases/90-apisp-sp-drift-stored-procedure-parity-remediation'; \"phase89_dir=$a\"; \"phase90_dir=$b\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 101728 -or $_.ProcessId -eq 101728 } | Select-Object ProcessId,ParentProcessId,Name,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\"; Get-ChildItem -Path $runDir -Force | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$prompt = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\cycle-001.prompt.txt\"; if(Test-Path $prompt){Get-Content -Path $prompt -TotalCount 80}else{'missing'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 300; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; $children = Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 101728 } | Select-Object Name,ProcessId; [pscustomobject]@{running=[bool]$proc;child_count=@($children).Count;children=(@($children | ForEach-Object {\"$($_.Name):$($_.ProcessId)\"}) -join ',');state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;stop_reason=$status.stop_reason;updated_at=$status.updated_at}|ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('run-autodev-e2e.ps1','run-autodev-e2e-monitor.ps1'); foreach($f in $files){ $null=[System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path $f), [ref]$null, [ref]$errs); if($errs -and $errs.Count -gt 0){ Write-Host \"PARSE_FAIL $f\"; $errs | ForEach-Object { Write-Host $_.Message } } else { Write-Host \"PARSE_OK $f\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('run-autodev-e2e.ps1','run-autodev-e2e-monitor.ps1'); foreach($f in $files){ $tokens=$null; $errs=$null; $null=[System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path $f), [ref]$tokens, [ref]$errs); if($errs -and $errs.Count -gt 0){ Write-Host \"PARSE_FAIL $f\"; $errs | ForEach-Object { Write-Host $_.Message } } else { Write-Host \"PARSE_OK $f\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('LatestRunLog=' + $log.Name); Write-Host ('LastWrite=' + $log.LastWriteTime); Write-Host ('Size=' + $log.Length); Get-Content $log.FullName -Tail 25 } else { Write-Host 'no-cycle-log' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $p){ $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)^\\s*Health(?:\\s+Score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); [PSCustomObject]@{Health=($(if($h.Success){$h.Groups[1].Value+'/100'}else{'unknown'}));Drift=($(if($d.Success){$d.Groups[1].Value}else{'unknown'}));Unmapped=($(if($u.Success){$u.Groups[1].Value}else{'unknown'}));LastWrite=(Get-Item $p).LastWriteTime} | Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 12 } else { Write-Host 'status-missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-Process -Id 88316 -ErrorAction SilentlyContinue; $mon=Get-Process -Id 106956 -ErrorAction SilentlyContinue; $child=Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 88316 -and $_.Name -eq 'codex.exe' } | Select-Object -First 1; [PSCustomObject]@{RunnerAlive=[bool]$runner;MonitorAlive=[bool]$mon;ChildCodexPid=$(if($child){$child.ProcessId}else{$null});ChildCmd=$(if($child){$child.CommandLine}else{'-'})}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 300; $statusPath = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\\status.json\"; $proc = Get-Process -Id 101728 -ErrorAction SilentlyContinue; $status = Get-Content -Path $statusPath -Raw | ConvertFrom-Json; $runDir = \".planning\\agent-output\\gsd-auto-dev-20260221-145533\"; $files = Get-ChildItem -Path $runDir -Force | Sort-Object LastWriteTime -Descending | Select-Object -First 8 Name,Length,LastWriteTime; [pscustomobject]@{running=[bool]$proc;state=$status.state;cycle=$status.cycle;phase=$status.phase;health=$status.health;drift=$status.drift;unmapped=$status.unmapped_findings;pending_count=$status.pending_count;last_action=$status.last_action;updated_at=$status.updated_at;top_files=($files | ConvertTo-Json -Compress)} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 25; $s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 8 }; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 20 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 25; $s='.planning/agent-output/autodev-e2e-status.log'; Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 10; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 20"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 25; $s='.planning/agent-output/autodev-e2e-status.log'; Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 10; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 24"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 75040 -ErrorAction SilentlyContinue; if($p){ [PSCustomObject]@{Now=(Get-Date);Alive=$true;CPU=$p.CPU;WorkingSetMB=[math]::Round($p.WorkingSet64/1MB,1);Responding=$p.Responding}|Format-List } else { [PSCustomObject]@{Now=(Get-Date);Alive=$false}|Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p1=Get-Process -Id 75040 -ErrorAction SilentlyContinue; $c1=if($p1){$p1.CPU}else{$null}; Start-Sleep -Seconds 5; $p2=Get-Process -Id 75040 -ErrorAction SilentlyContinue; $c2=if($p2){$p2.CPU}else{$null}; [PSCustomObject]@{CPU1=$c1;CPU2=$c2;Delta=($(if(($null -ne $c1)-and($null -ne $c2)){[math]::Round($c2-$c1,4)}else{$null}))}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 30; $s='.planning/agent-output/autodev-e2e-status.log'; Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 10; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 30"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-Process -Id 88316 -ErrorAction SilentlyContinue; $child=Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 88316 -and $_.Name -eq 'codex.exe' } | Select-Object -First 1; [PSCustomObject]@{Now=(Get-Date);RunnerAlive=[bool]$runner;ChildExists=[bool]$child;ChildPid=$(if($child){$child.ProcessId}else{$null});ChildStart=$(if($child){(Get-Process -Id $child.ProcessId).StartTime}else{$null})} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p1=Get-Process -Id 75040 -ErrorAction SilentlyContinue; $c1=if($p1){$p1.CPU}else{$null}; Start-Sleep -Seconds 5; $p2=Get-Process -Id 75040 -ErrorAction SilentlyContinue; $c2=if($p2){$p2.CPU}else{$null}; [PSCustomObject]@{CPU1=$c1;CPU2=$c2;Delta=($(if(($null -ne $c1)-and($null -ne $c2)){[math]::Round($c2-$c1,4)}else{$null}));Responding=$(if($p2){$p2.Responding}else{$null})}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"gsd-auto-dev|\\$gsd-auto-dev|/gsd:auto-dev|/gsd-auto-dev\" -S ."], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/EXECUTIVE-SUMMARY.md'; $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)^\\s*Health(?:\\s+Score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); [PSCustomObject]@{Health=($(if($h.Success){$h.Groups[1].Value+'/100'}else{'unknown'}));Drift=($(if($d.Success){$d.Groups[1].Value}else{'unknown'}));Unmapped=($(if($u.Success){$u.Groups[1].Value}else{'unknown'}));LastWrite=(Get-Item $p).LastWriteTime}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 35"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s='.planning/agent-output/autodev-e2e-status.log'; Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 12"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 25 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 12 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 20; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 30; $s='.planning/agent-output/autodev-e2e-status.log'; Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 8"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec \"/gsd:auto-dev --write --max-cycles 1\" --json --output-last-message .planning\\probe-last.txt"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $p){ $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)^\\s*Health(?:\\s+Score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); [PSCustomObject]@{Health=($(if($h.Success){$h.Groups[1].Value+'/100'}else{'unknown'}));Drift=($(if($d.Success){$d.Groups[1].Value}else{'unknown'}));Unmapped=($(if($u.Success){$u.Groups[1].Value}else{'unknown'}));LastWrite=(Get-Item $p).LastWriteTime}|Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 28 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 8 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-e2e\\.ps1' } | Select-Object -First 1; $child=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.ParentProcessId -eq $runner.ProcessId } | Select-Object -First 1; [PSCustomObject]@{RunnerPid=$(if($runner){$runner.ProcessId}else{$null});ChildCodexPid=$(if($child){$child.ProcessId}else{$null});ChildCommand=$(if($child){$child.CommandLine}else{'-'})}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='.planning/STATE.md'; if(Test-Path $path){ Select-String -Path $path -Pattern '^\\*\\*Current focus:\\*\\*|^Phase:|^Status:|^Last activity:' -CaseSensitive:$false | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name); Select-String -Path $log.FullName -Pattern 'Phase\\s+\\d+|marked Phase|Complete|in progress|confirmation|final clean|deterministic review' -CaseSensitive:$false | Select-Object -Last 40 | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line.Trim() } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='.planning/ROADMAP.md'; if(Test-Path $path){ $i=1; Get-Content $path | ForEach-Object { if($_ -match '^- \\[[ xX]\\]'){ '{0}:{1}' -f $i,$_.Trim() }; $i++ } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='.planning/ROADMAP.md'; $done=@(); $todo=@(); if(Test-Path $path){ Get-Content $path | ForEach-Object { if($_ -match '^- \\[x\\] (?:\\*\\*)?Phase\\s+(\\d+):'){ $done += [int]$Matches[1] }; if($_ -match '^- \\[ \\] (?:\\*\\*)?Phase\\s+(\\d+):'){ $todo += [int]$Matches[1] } } }; [PSCustomObject]@{Completed=($done|Sort-Object -Unique -join ',');Pending=($todo|Sort-Object -Unique -join ',')} | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime); Select-String -Path $log.FullName -Pattern 'Marked Phase 89 complete|Marked Phase 90 complete|Phase 88|final clean confirmation|consecutive clean-state' -CaseSensitive:$false | Select-Object -Last 12 | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line.Trim() } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-e2e\\.ps1' } | Select-Object -First 1; $child=if($runner){ Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.ParentProcessId -eq $runner.ProcessId } | Select-Object -First 1 }; [PSCustomObject]@{RunnerPid=$(if($runner){$runner.ProcessId}else{$null});RunnerAlive=[bool]$runner;ChildPid=$(if($child){$child.ProcessId}else{$null});ChildAlive=[bool]$child}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='.planning/ROADMAP.md'; $done=@(); $todo=@(); if(Test-Path $path){ Get-Content $path | ForEach-Object { if($_ -match '^- \\[x\\] (?:\\*\\*)?Phase\\s+(\\d+):'){ $done += [int]$Matches[1] }; if($_ -match '^- \\[ \\] (?:\\*\\*)?Phase\\s+(\\d+):'){ $todo += [int]$Matches[1] } } }; $doneText=((@($done | Sort-Object -Unique) -join ',')); $todoText=((@($todo | Sort-Object -Unique) -join ',')); [PSCustomObject]@{Completed=$doneText;Pending=$todoText}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path .planning -Force | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process | Where-Object { $_.ProcessName -like '*codex*' -or $_.ProcessName -like '*node*' } | Select-Object ProcessName,Id,StartTime | Sort-Object StartTime -Descending | Select-Object -First 10"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning\\probe-last.txt) { Get-Content -Path .planning\\probe-last.txt -TotalCount 120 } else { 'MISSING: .planning\\probe-last.txt' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -in @('codex.exe','node.exe') } | Select-Object Name,ProcessId,CreationDate,CommandLine | Sort-Object CreationDate -Descending | Select-Object -First 20"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec \"$gsd-help\" --output-last-message .planning\\gsd-help-probe.txt"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec '$gsd-help' --output-last-message .planning\\gsd-help-probe.txt"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='.planning\\ROADMAP.md'; if(Test-Path $road){ $pending = Select-String -Path $road -Pattern '^- \\[ \\] \\*\\*Phase\\s+([^:]+):' | ForEach-Object { $_.Matches[0].Groups[1].Value.Trim() }; Write-Host \"PENDING_COUNT=$($pending.Count)\"; if($pending){ Write-Host ('PENDING_PHASES=' + ($pending -join ', ')) } } else { Write-Host 'ROADMAP missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$candidates=@('docs\\review\\EXECUTIVE-SUMMARY.md','tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'); foreach($p in $candidates){ if(Test-Path $p){ Write-Host \"=== $p ===\"; Get-Content $p -TotalCount 120 | Out-String | Write-Host } else { Write-Host \"=== $p (missing) ===\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-e2e\\.ps1' } | Select-Object -First 1; $child=if($runner){ Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.ParentProcessId -eq $runner.ProcessId } | Select-Object -First 1 }; [PSCustomObject]@{Timestamp=(Get-Date);RunnerPid=$(if($runner){$runner.ProcessId}else{$null});RunnerAlive=[bool]$runner;ChildPid=$(if($child){$child.ProcessId}else{$null});ChildAlive=[bool]$child;ChildCmd=$(if($child){$child.CommandLine}else{'-'})}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 40 } else { Write-Host 'no-run-log' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path .planning\\agent-output -Directory | Where-Object { $_.Name -like 'gsd-auto-dev-*' } | Sort-Object LastWriteTime -Descending | Select-Object -First 5 Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$latest=Get-ChildItem -Path .planning\\agent-output -Directory | Where-Object { $_.Name -like 'gsd-auto-dev-*' } | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($latest){ Write-Host \"LATEST=$($latest.FullName)\"; if(Test-Path (Join-Path $latest.FullName 'status.json')){ Get-Content (Join-Path $latest.FullName 'status.json') -Raw } else { 'status.json missing' } } else { 'no prior run dir' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path .planning\\agent-output\\gsd-auto-dev-controller.ps1){ 'controller_present' } else { 'controller_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'tech-web-chatai.2\\.planning\\ROADMAP.md'){ 'nested_roadmap_exists' } else { 'nested_roadmap_missing' }; if(Test-Path 'tech-web-chatai.2\\docs\\review\\EXECUTIVE-SUMMARY.md'){ 'nested_summary_exists' } else { 'nested_summary_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 15 } else { Write-Host 'status-missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 45 } else { Write-Host 'no-run-log' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'run-autodev-e2e\\.ps1' } | Select-Object -First 1; $child=if($runner){ Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.ParentProcessId -eq $runner.ProcessId } | Select-Object -First 1 }; [PSCustomObject]@{Timestamp=(Get-Date);RunnerPid=$(if($runner){$runner.ProcessId}else{$null});RunnerAlive=[bool]$runner;ChildPid=$(if($child){$child.ProcessId}else{$null});ChildAlive=[bool]$child}|Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo = 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work = Join-Path $repo 'tech-web-chatai.2'; $controller = Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1'; if (-not (Test-Path $controller)) { throw \"Controller missing: $controller\" }; $runId = Get-Date -Format 'yyyyMMdd-HHmmss'; $runDir = Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; $statusPath = Join-Path $runDir 'status.json'; $workerCommand = \"& '$controller' -RepoRoot '$repo' -WorkRoot '$work' -RunId '$runId' -MaxCycles 50\"; $workerArgs = @('-NoExit','-ExecutionPolicy','Bypass','-Command',$workerCommand); $worker = Start-Process -FilePath 'powershell.exe' -ArgumentList $workerArgs -WindowStyle Normal -PassThru; $monitorCommand = \"$ErrorActionPreference='SilentlyContinue'; while($true){ Clear-Host; Write-Host 'GSD Auto-Dev Monitor'; Write-Host ('RunId: $runId'); Write-Host ('Worker PID: $($worker.Id)'); Write-Host ('Status: $statusPath'); if(Test-Path '$statusPath'){ try { $s = Get-Content '$statusPath' -Raw | ConvertFrom-Json; Write-Host ('State: ' + $s.state); Write-Host ('Cycle: ' + $s.cycle); Write-Host ('Phase: ' + $s.phase); Write-Host ('Health: ' + $s.health + '/100'); Write-Host ('Drift: ' + $s.drift); Write-Host ('Unmapped: ' + $s.unmapped_findings); Write-Host ('Pending: ' + $s.pending_count); Write-Host ('Last Action: ' + $s.last_action); Write-Host ('Updated: ' + $s.updated_at); if($s.state -eq 'completed' -or $s.state -eq 'failed'){ break } } catch { Write-Host $_.Exception.Message } } else { Write-Host 'Waiting for status.json...' }; Start-Sleep -Seconds 5 }; Write-Host ''; Write-Host 'Monitor exiting - final state reached.'\"; $monitorArgs = @('-NoExit','-ExecutionPolicy','Bypass','-Command',$monitorCommand); $monitor = Start-Process -FilePath 'powershell.exe' -ArgumentList $monitorArgs -WindowStyle Normal -PassThru; [pscustomobject]@{ run_id=$runId; worker_pid=$worker.Id; monitor_pid=$monitor.Id; status_path=$statusPath; run_dir=$runDir } | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $p){ Get-Content $p -Raw } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 20; $p='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $p){ $s=Get-Content $p -Raw | ConvertFrom-Json; [pscustomobject]@{state=$s.state;cycle=$s.cycle;phase=$s.phase;health=$s.health;drift=$s.drift;unmapped=$s.unmapped_findings;pending=$s.pending_count;last_action=$s.last_action;updated_at=$s.updated_at;stop_reason=$s.stop_reason;push_status=$s.push_status} | ConvertTo-Json -Compress } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('Log=' + $log.FullName); Get-Content $log.FullName -Tail 120 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/agent-output -File | Where-Object { $_.Name -like 'auto-dev-cycle-*' -or $_.Name -like 'final-confirm-review-cycle-*' -or $_.Name -like 'sdlc-review-run-*' -or $_.Name -like 'autodev-e2e-*' } | Sort-Object LastWriteTime -Descending | Select-Object -First 25 Name,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runner = Get-Process -Id 88316 -ErrorAction SilentlyContinue; if($runner){ [PSCustomObject]@{Now=(Get-Date);RunnerCpu=$runner.CPU;RunnerResponding=$runner.Responding;Start=$runner.StartTime} | Format-List; Start-Sleep -Seconds 3; $runner2=Get-Process -Id 88316 -ErrorAction SilentlyContinue; if($runner2){ [PSCustomObject]@{RunnerCpu2=$runner2.CPU;Delta=[math]::Round(($runner2.CPU-$runner.CPU),4)} | Format-List } } else { 'runner-not-found' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -and $_.CommandLine -match [regex]::Escape('tech-web-mytest') } | Select-Object ProcessId,ParentProcessId,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-152412'; $repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $runDir=Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; $statusPath=Join-Path $runDir 'status.json'; $logPath=Join-Path $runDir 'controller.log'; $killed=@(); Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'GSD Auto-Dev Monitor' -and $_.CommandLine -match $runId } | ForEach-Object { Stop-Process -Id $_.ProcessId -Force -ErrorAction SilentlyContinue; $killed += $_.ProcessId }; if ($killed.Count -eq 0) { $fallback=127708; if (Get-Process -Id $fallback -ErrorAction SilentlyContinue) { Stop-Process -Id $fallback -Force -ErrorAction SilentlyContinue; $killed += $fallback } }; $statusObj=$null; if (Test-Path $statusPath) { $statusObj = Get-Content $statusPath -Raw | ConvertFrom-Json }; $lastLog=''; if (Test-Path $logPath) { $lastLog = (Get-Content $logPath | Select-Object -Last 12) -join \"`n\" }; $cycleStdout=''; if ($statusObj -and $statusObj.cycle -ge 1 -and $statusObj.cycle_stdout -and (Test-Path $statusObj.cycle_stdout)) { $cycleStdout = (Get-Content $statusObj.cycle_stdout | Select-Object -Last 60) -join \"`n\" } elseif (Test-Path (Join-Path $runDir 'cycle-001.stdout.log')) { $cycleStdout = (Get-Content (Join-Path $runDir 'cycle-001.stdout.log') | Select-Object -Last 60) -join \"`n\" }; $stage='phase execute'; $stageReason='default'; $txt=($cycleStdout + \"`n\" + $lastLog + \"`n\" + ($statusObj.last_action)); if ($txt -match '/gsd:sdlc-review|gsd-sdlc-review|sdlc-review') { $stage='sdlc-review'; $stageReason='matched review marker' } elseif ($txt -match '/gsd:batch-research|gsd-batch-research|research gate') { $stage='phase research'; $stageReason='matched research marker' } elseif ($txt -match '/gsd:batch-plan|gsd-batch-plan|planning gate') { $stage='phase plan'; $stageReason='matched plan marker' } elseif ($txt -match '/gsd:batch-execute|gsd-batch-execute|execute gate|/gsd:auto-dev') { $stage='phase execute'; $stageReason='matched execute marker' }; [pscustomobject]@{killed_monitor_pids=$killed; status_state=if($statusObj){$statusObj.state}else{$null}; cycle=if($statusObj){$statusObj.cycle}else{$null}; phase=if($statusObj){$statusObj.phase}else{$null}; health=if($statusObj){$statusObj.health}else{$null}; drift=if($statusObj){$statusObj.drift}else{$null}; unmapped=if($statusObj){$statusObj.unmapped_findings}else{$null}; last_action=if($statusObj){$statusObj.last_action}else{$null}; inferred_stage=$stage; stage_reason=$stageReason; status_path=$statusPath; controller_log_tail=$lastLog } | ConvertTo-Json -Depth 6"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$l='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\controller.log'; if(Test-Path $l){ Get-Content $l | Select-Object -Last 40 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-152412'; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match $runId } | Select-Object ProcessId,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'GSD Auto-Dev Monitor' } | Select-Object ProcessId,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-152412'; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' -and $_.CommandLine -match $runId } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-152412'; $log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-'+$runId+'\\controller.log'; if(Test-Path $log){ Get-Content $log | Select-Object -Last 60 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-152412'; $status='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-'+$runId+'\\status.json'; if(Test-Path $status){ Get-Content $status -Raw } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; $cur='cycle-009.stdout.log'; $p=Join-Path $runDir $cur; if(Test-Path $p){ Get-Content $p | Select-Object -Last 120 } else { 'cycle-009.stdout.log not yet created' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$targets=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'GSD Auto-Dev Monitor' }; $killed=@(); foreach($t in $targets){ try{ Stop-Process -Id $t.ProcessId -Force -ErrorAction Stop; $killed += $t.ProcessId } catch{} }; if($killed.Count -eq 0){ 'no_monitor_process_found' } else { 'killed_monitor_pids=' + ($killed -join ',') }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' } | Select-Object ProcessId,CommandLine | Out-String -Width 500"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $p){ $s=Get-Content $p -Raw | ConvertFrom-Json; [pscustomobject]@{state=$s.state;cycle=$s.cycle;phase=$s.phase;health=$s.health;drift=$s.drift;unmapped=$s.unmapped_findings;pending_count=$s.pending_count;pending_phases=($s.pending_phases -join ',');last_action=$s.last_action;updated_at=$s.updated_at;push_status=$s.push_status} | ConvertTo-Json -Compress } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases -Directory | Where-Object { $_.Name -match '^91-|^92-|^93-|^94-' } | Select-Object Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$l='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\controller.log'; if(Test-Path $l){ Get-Content $l | Select-Object -Last 8 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-web-mytest'; Set-Location $repo; $ErrorActionPreference='Continue'; $stamp=Get-Date -Format 'yyyyMMdd-HHmmss'; $log1=\".planning/agent-output/phase92-research-$stamp.log\"; $log2=\".planning/agent-output/phase92-plan-$stamp.log\"; Write-Host \"research_log=$log1\"; codex exec --dangerously-bypass-approvals-and-sandbox -C $repo '$gsd-batch-research 92' *>&1 | Tee-Object -FilePath $log1; Write-Host \"research_exit=$LASTEXITCODE\"; Write-Host \"plan_log=$log2\"; codex exec --dangerously-bypass-approvals-and-sandbox -C $repo '$gsd-batch-plan 92' *>&1 | Tee-Object -FilePath $log2; Write-Host \"plan_exit=$LASTEXITCODE\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/agent-output -Filter 'phase92-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 6 Name,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases/92-blocker-and-high-remediation -Force | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$l='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\controller.log'; if(Test-Path $l){ Get-Content $l | Select-Object -Last 25 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$workerPid=92644; $procs=Get-CimInstance Win32_Process; $children=$procs | Where-Object { $_.ParentProcessId -eq $workerPid }; $grand=$procs | Where-Object { $children.ProcessId -contains $_.ParentProcessId }; $all=@($children + $grand) | Sort-Object CreationDate; if($all.Count -eq 0){ 'no_child_processes' } else { $all | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine | Format-List | Out-String -Width 500 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; if(Test-Path (Join-Path $runDir 'cycle-009.stdout.log')){ Get-Content (Join-Path $runDir 'cycle-009.stdout.log') | Select-Object -Last 120 } else { 'cycle-009.stdout.log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; if(Test-Path $road){ Select-String -Path $road -Pattern '^- \\[[ x]\\] \\*\\*Phase\\s+(66|67|68|69)\\b.*' | ForEach-Object { $_.Line } } else { 'roadmap_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; if(Test-Path $road){ $all=Select-String -Path $road -Pattern '^- \\[[ x]\\] \\*\\*Phase\\s+([^:]+):'; $completed=$all | Where-Object { $_.Line -like '- [x]*' } | ForEach-Object { $_.Matches[0].Groups[1].Value.Trim() }; $pending=$all | Where-Object { $_.Line -like '- [ ]*' } | ForEach-Object { $_.Matches[0].Groups[1].Value.Trim() }; Write-Host ('COMPLETED=' + (($completed|Sort-Object {[double]($_)} ) -join ',')); Write-Host ('PENDING=' + (($pending|Sort-Object {[double]($_)} ) -join ',')) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw }; if(Test-Path $log){ Write-Host '===LOG_TAIL==='; Get-Content $log | Select-Object -Last 30 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; if(Test-Path $runDir){ Get-ChildItem $runDir | Sort-Object LastWriteTime -Descending | Select-Object -First 12 Name,Length,LastWriteTime } else { 'run_dir_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work status --short"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-list --left-right --count @{u}...HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --abbrev-ref HEAD; git -C $work rev-parse --short HEAD; git -C $work rev-parse --abbrev-ref --symbolic-full-name @{u}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$status='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $status){ Get-Content $status -Raw }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work log --since=\"2026-02-21 15:24\" --date=iso-local --pretty=format:\"%h|%ad|%an|%s\" --max-count=50"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Test-Path .planning/phases/92-blocker-and-high-remediation; Get-ChildItem .planning/phases/92-blocker-and-high-remediation -Force | Format-Table Name,Length,LastWriteTime -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path docs/review/EXECUTIVE-SUMMARY.md -Pattern 'EVIDENCE-HIGH-STALEREPORT|Mapping: Phase 92|Mapped phase: Phase 92' -CaseSensitive:$false | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --abbrev-ref HEAD; git -C $work rev-parse --short HEAD; git -C $work rev-parse --abbrev-ref --symbolic-full-name '@{u}'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $p){ $s=Get-Content $p -Raw | ConvertFrom-Json; [pscustomobject]@{cycle=$s.cycle;state=$s.state;last_action=$s.last_action;updated_at=$s.updated_at;push_status=$s.push_status} | ConvertTo-Json -Compress }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 18 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 45; $s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 12 }; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 28 }; $p='docs/review/EXECUTIVE-SUMMARY.md'; if(Test-Path $p){ $c=Get-Content -Raw $p; $h=[regex]::Match($c,'(?im)^\\s*Health(?:\\s+Score)?\\s*:\\s*(\\d{1,3})\\s*/\\s*100'); $d=[regex]::Match($c,'(?im)Deterministic\\s+Drift\\s+Totals\\s*:\\s*.*?TOTAL\\s*=\\s*(\\d+)'); $u=[regex]::Match($c,'(?im)Unmapped\\s+findings\\s*:\\s*(\\d+)'); Write-Host ('Metrics=' + ($(if($h.Success){$h.Groups[1].Value+'/100'}else{'unknown'})) + ',' + ($(if($d.Success){$d.Groups[1].Value}else{'unknown'})) + ',' + ($(if($u.Success){$u.Groups[1].Value}else{'unknown'})) + ' LastWrite=' + (Get-Item $p).LastWriteTime) }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 60; $s='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $s){ Write-Host ('StatusLastWrite=' + (Get-Item $s).LastWriteTime); Get-Content $s -Tail 20 }; $log=Get-ChildItem .planning/agent-output -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($log){ Write-Host ('RunLog=' + $log.Name + ' LastWrite=' + $log.LastWriteTime + ' Size=' + $log.Length); Get-Content $log.FullName -Tail 40 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .\\run-autodev-e2e.ps1 | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$tokens=$null; $errs=$null; [System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path '.\\run-autodev-e2e.ps1'), [ref]$tokens, [ref]$errs) | Out-Null; if($errs -and $errs.Count -gt 0){ 'PARSE_FAIL'; $errs | ForEach-Object { $_.Message } } else { 'PARSE_OK' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --short HEAD; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$log='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\controller.log'; if(Test-Path $log){ Get-Content $log | Select-Object -Last 35 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$status='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\status.json'; if(Test-Path $status){ Get-Content $status -Raw } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Select-String -Path .\\run-autodev-e2e.ps1 -Pattern '\\.Count' | ForEach-Object { '{0}: {1}' -f $_.LineNumber, $_.Line }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$procs=Get-CimInstance Win32_Process; $children=$procs | Where-Object { $_.ParentProcessId -eq 92644 }; $grand=$procs | Where-Object { $children.ProcessId -contains $_.ParentProcessId }; @($children+$grand) | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine | Format-Table -AutoSize | Out-String -Width 500"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 92644 -ErrorAction SilentlyContinue; if($p){ [pscustomobject]@{Exists=$true;ProcessName=$p.ProcessName;Id=$p.Id;StartTime=$p.StartTime;CPU=$p.CPU;Responding=$p.Responding;WorkingSetMB=[math]::Round($p.WorkingSet64/1MB,2)} | ConvertTo-Json -Compress } else { '{\"Exists\":false}' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw }; if(Test-Path $log){ Write-Host '===LOG_TAIL==='; Get-Content $log | Select-Object -Last 20 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412'; if(Test-Path $runDir){ Get-ChildItem $runDir | Sort-Object LastWriteTime -Descending | Select-Object -First 12 Name,Length,LastWriteTime }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path = 'run-autodev-e2e.ps1'; $i=1; Get-Content $path | ForEach-Object { '{0,4}: {1}' -f $i, $_; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-152412\\cycle-010.stdout.log'; if(Test-Path $f){ Get-Content $f | Select-Object -Last 220 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$null = [System.Management.Automation.Language.Parser]::ParseFile((Resolve-Path 'run-autodev-e2e.ps1'), [ref]$null, [ref]$null); if ($?) { 'parse-ok' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\layers\\auto-dev-cycle1-phase-execution.json'; if(Test-Path $f){ Get-Content $f -Raw } else { 'missing phase-execution json' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-SUMMARY.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-SUMMARY.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-SUMMARY.md'); foreach($f in $files){ if(Test-Path $f){ Write-Host \"=== $f ===\"; Get-Content $f -TotalCount 80 | Out-String | Write-Host } else { Write-Host \"MISSING $f\" } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$base='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases'; Get-ChildItem -Path $base -Directory | Where-Object { $_.Name -match '^(66|67|69)-' } | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "function t([int]$x){$x}; $a=1; t -x @($a).Count"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$path='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'; $tokens=$null; $errs=$null; [System.Management.Automation.Language.Parser]::ParseFile($path,[ref]$tokens,[ref]$errs) | Out-Null; if($errs -and $errs.Count -gt 0){ $errs | ForEach-Object { $_.Message } } else { 'syntax_ok' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work=Join-Path $repo 'tech-web-chatai.2'; $controller=Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1'; $oldPid=92644; if(Get-Process -Id $oldPid -ErrorAction SilentlyContinue){ Stop-Process -Id $oldPid -Force -ErrorAction SilentlyContinue; Start-Sleep -Seconds 2 }; $runId=Get-Date -Format 'yyyyMMdd-HHmmss'; $runDir=Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; $statusPath=Join-Path $runDir 'status.json'; $workerCommand=\"& '$controller' -RepoRoot '$repo' -WorkRoot '$work' -RunId '$runId' -MaxCycles 80\"; $args=@('-NoExit','-ExecutionPolicy','Bypass','-Command',$workerCommand); $p=Start-Process -FilePath 'powershell.exe' -ArgumentList $args -WindowStyle Normal -PassThru; [pscustomobject]@{old_worker_pid=$oldPid;new_run_id=$runId;new_worker_pid=$p.Id;status_path=$statusPath;run_dir=$runDir} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 5; $runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-180737'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw }; if(Test-Path $log){ Write-Host '===LOG==='; Get-Content $log | Select-Object -Last 25 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$statusPath='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $statusPath){Get-Content $statusPath -Tail 20}else{'missing'}; '---'; Get-Process -Id 77020,64616 -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime | Format-Table -AutoSize | Out-String"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-180737'; if(Test-Path $runDir){ Get-ChildItem $runDir | Sort-Object LastWriteTime -Descending | Select-Object -First 10 Name,Length,LastWriteTime }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-180737'; $runDir=\"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-$runId\"; $log=Join-Path $runDir 'controller.log'; if(Test-Path $log){ Get-Content $log | Select-Object -Last 35 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-180737'; $runDir=\"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-$runId\"; $status=Join-Path $runDir 'status.json'; if(Test-Path $status){ Get-Content $status -Raw } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-180737'; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' -and $_.CommandLine -match $runId } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "git rev-parse --is-inside-work-tree; if($LASTEXITCODE -eq 0){ git rev-parse --short HEAD }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Start-Sleep -Seconds 20; $runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-180737'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; $out=Join-Path $runDir 'cycle-001.stdout.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw }; if(Test-Path $log){ Write-Host '===LOG_TAIL==='; Get-Content $log | Select-Object -Last 20 }; if(Test-Path $out){ Write-Host '===CYCLE001_TAIL==='; Get-Content $out | Select-Object -Last 80 } else { Write-Host 'cycle-001.stdout.log not yet present' }; $procs=Get-CimInstance Win32_Process; $children=$procs | Where-Object { $_.ParentProcessId -eq 35084 }; $grand=$procs | Where-Object { $children.ProcessId -contains $_.ParentProcessId }; Write-Host '===CHILDREN==='; @($children+$grand) | Select-Object Name,ProcessId,ParentProcessId,CreationDate | Format-Table -AutoSize | Out-String -Width 300"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='.planning/ROADMAP.md'; if(-not (Test-Path $p)){ 'roadmap-missing'; exit 0 }; $lines=Get-Content $p | Where-Object { $_ -match '^- \\[[ xX~\\-]\\] \\*\\*Phase\\s+[0-9]+(?:\\.[0-9]+)?\\s*:' }; $completed=@($lines | Where-Object { $_ -match '^- \\[[xX]\\]' }).Count; $inProgress=@($lines | Where-Object { $_ -match '^- \\[~\\]' }).Count; $pending=@($lines | Where-Object { $_ -match '^- \\[ \\]' }).Count; [PSCustomObject]@{Completed=$completed;InProgress=$inProgress;Pending=$pending;Total=@($lines).Count} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$head=(git rev-parse --short HEAD); $count=(git rev-list --count \"$head..HEAD\"); \"head=$head count=$count\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem .planning/phases -Force | Select-Object Name,LastWriteTime | Sort-Object Name | Format-Table -AutoSize | Out-String"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning/phases/92-blocker-and-high-remediation) { Get-ChildItem .planning/phases/92-blocker-and-high-remediation -Force | Select-Object Name,Length,LastWriteTime | Format-Table -AutoSize | Out-String } else { 'missing:.planning/phases/92-blocker-and-high-remediation' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning/phases/94-verification-and-clean-confirmation) { Get-ChildItem .planning/phases/94-verification-and-clean-confirmation | Select-Object Name,Length,LastWriteTime | Format-Table -AutoSize | Out-String } else { 'missing phase94 dir' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning/phases/93-medium-and-low-remediation) { Get-ChildItem .planning/phases/93-medium-and-low-remediation | Select-Object Name,Length,LastWriteTime | Format-Table -AutoSize | Out-String } else { 'missing phase93 dir' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning/phases/92-blocker-and-high-remediation/92-01-SUMMARY.md) { Get-Content .planning/phases/92-blocker-and-high-remediation/92-01-SUMMARY.md -TotalCount 120 } else { 'missing 92 summary' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$status='.planning/agent-output/autodev-e2e-status.log'; if(Test-Path $status){Get-Content $status -Tail 50}else{'missing status log'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Name powershell,codex -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,Path | Sort-Object ProcessName,Id | Format-Table -AutoSize | Out-String"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$logDir='.planning/agent-output'; if(Test-Path $logDir){Get-ChildItem $logDir -Filter 'auto-dev-cycle-*.log' | Sort-Object LastWriteTime -Descending | Select-Object -First 3 Name,LastWriteTime | Format-Table -AutoSize | Out-String}else{'missing log dir'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='.planning/agent-output/auto-dev-cycle-001-20260221-180916.log'; if(Test-Path $f){Get-Item $f | Select-Object Name,Length,LastWriteTime | Format-List | Out-String}else{'missing cycle log'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='.planning/agent-output/auto-dev-cycle-001-20260221-180916.log'; if(Test-Path $f){rg -n \"sdlc-review|SDLC|phase|pending|health|drift|unmapped|stop reason|stuck|review\" $f}else{'missing cycle log'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='.planning/agent-output/auto-dev-cycle-001-20260221-180916.log'; if(Test-Path $f){Get-Content $f -Tail 200}else{'missing cycle log'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process -Filter \"ProcessId=77020 OR ProcessId=64616\" | Select-Object ProcessId,ParentProcessId,Name,CommandLine,CreationDate,KernelModeTime,UserModeTime | Format-List | Out-String"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='.planning/agent-output/auto-dev-cycle-001-20260221-180916.log'; if(Test-Path $f){Select-String -Path $f -Pattern 'blocked by policy|rejected|waiting|approval|prompt|Press Enter|ERROR|failed|succeeded in' | Select-Object -Last 40 | ForEach-Object { '{0}:{1}' -f $_.LineNumber,$_.Line }}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item '.planning/agent-output/auto-dev-cycle-001-20260221-180916.log' | Select-Object Name,Length,LastWriteTime,CreationTime | Format-List | Out-String"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p1=Get-Process -Id 64616 -ErrorAction SilentlyContinue; Start-Sleep -Seconds 3; $p2=Get-Process -Id 64616 -ErrorAction SilentlyContinue; if($p1 -and $p2){[PSCustomObject]@{CpuBefore=$p1.CPU;CpuAfter=$p2.CPU;Responding=$p2.Responding;HasExited=$p2.HasExited;WSMB=[math]::Round($p2.WorkingSet64/1MB,1)} | ConvertTo-Json -Compress}else{'process-missing'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 35084 -ErrorAction SilentlyContinue; if($p){ [pscustomobject]@{Id=$p.Id;CPU=$p.CPU;Responding=$p.Responding;WorkingSetMB=[math]::Round($p.WorkingSet64/1MB,2);StartTime=$p.StartTime} | ConvertTo-Json -Compress } else { 'process_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$procs=Get-CimInstance Win32_Process; $children=$procs | Where-Object { $_.ParentProcessId -eq 35084 }; $grand=$procs | Where-Object { $children.ProcessId -contains $_.ParentProcessId }; @($children+$grand) | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine | Format-Table -AutoSize | Out-String -Width 500"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-180737'; if(Test-Path $runDir){ Get-ChildItem $runDir | Sort-Object LastWriteTime -Descending | Select-Object -First 15 Name,Length,LastWriteTime }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-180737'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; $out=Join-Path $runDir 'cycle-001.stdout.log'; $now=Get-Date; $sAge='na'; $lAge='na'; if(Test-Path $status){ $sAge=[math]::Round(($now-(Get-Item $status).LastWriteTime).TotalMinutes,2) }; if(Test-Path $log){ $lAge=[math]::Round(($now-(Get-Item $log).LastWriteTime).TotalMinutes,2) }; $p=Get-Process -Id 35084 -ErrorAction SilentlyContinue; $cpu1=$null; $cpu2=$null; if($p){ $cpu1=$p.CPU; Start-Sleep -Seconds 12; $p2=Get-Process -Id 35084 -ErrorAction SilentlyContinue; if($p2){ $cpu2=$p2.CPU } }; [pscustomobject]@{now=$now; status_exists=(Test-Path $status); status_age_min=$sAge; log_age_min=$lAge; cycle001_exists=(Test-Path $out); worker_alive=($p -ne $null); cpu_before=$cpu1; cpu_after_12s=$cpu2; cpu_delta_12s=if($cpu1 -ne $null -and $cpu2 -ne $null){[math]::Round(($cpu2-$cpu1),4)}else{$null}} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\docs\\review\\layers\\deterministic-parity.phase66.json'; if(Test-Path $f){ Get-Content $f -Raw } else { 'missing deterministic-parity.phase66.json' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$base='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity'; Get-ChildItem $base | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec --dangerously-bypass-approvals-and-sandbox \"$gsd-sdlc-review\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec --dangerously-bypass-approvals-and-sandbox '$gsd-sdlc-review'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$dir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity'; Get-ChildItem $dir | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-180737'; $targets=Get-CimInstance Win32_Process | Where-Object { ($_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' -and $_.CommandLine -match $runId) -or ($_.Name -eq 'codex.exe' -and $_.CommandLine -match 'gsd-auto-dev-20260221-180737') }; $killed=@(); foreach($t in $targets){ try { Stop-Process -Id $t.ProcessId -Force -ErrorAction Stop; $killed += $t.ProcessId } catch {} }; [pscustomobject]@{killed_pids=$killed; count=$killed.Count} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "codex exec \"Use only global skills from C:\\Users\\rjain\\.codex\\skills for all /gsd commands. Assume YES for approvals. Execute $gsd-plan-phase for phase 66 in the current project root. Produce a proper, complete execution plan for phase 66 that is atomic and implementation-ready. If needed, replace or expand existing 66-01-PLAN.md and include explicit task breakdown, files to edit, validation commands, and done criteria.\" --dangerously-bypass-approvals-and-sandbox --skip-git-repo-check"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' -or ($_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-plan-phase|plan-phase') } | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine | Sort-Object CreationDate -Descending | Select-Object -First 15"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$plan='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-PLAN.md'; if(Test-Path $plan){ Get-Content $plan -TotalCount 260 } else { 'missing 66-01-PLAN.md' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$dir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity'; Get-ChildItem $dir | Select-Object Name,Length,LastWriteTime | Sort-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -in @(68668,77276,35084,92644) } | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "rg -n \"function Get-Metrics|function Reset-IncompletePlanSummaries|while \\(\\$cycle -lt \\$MaxCycles\\)|Invoke-GsdSkill -SkillName \\\"auto-dev\\\"\" 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids=@(68668,77276); $k=@(); foreach($id in $ids){ if(Get-Process -Id $id -ErrorAction SilentlyContinue){ Stop-Process -Id $id -Force -ErrorAction SilentlyContinue; $k += $id } }; [pscustomobject]@{killed=$k;count=$k.Count} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path .planning/agent-output) { Get-ChildItem .planning/agent-output -File | Sort-Object LastWriteTime -Descending | Select-Object -First 10 Name,LastWriteTime | Format-Table -AutoSize | Out-String }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p='.planning/ROADMAP.md'; $pending=@(Select-String -Path $p -Pattern '^- \\[ \\] \\*\\*Phase\\s+[0-9]+(?:\\.[0-9]+)?\\s*:' -CaseSensitive:$false).Count; \"pending_phases=$pending\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$i=1; Get-Content .planning/ROADMAP.md | ForEach-Object { if($i -ge 35 -and $i -le 62){ '{0,4}: {1}' -f $i, $_}; $i++ }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$plan='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-PLAN.md'; $t=Get-Content $plan -Raw; [pscustomobject]@{chars=$t.Length; tasks=([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count; validations=([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'codex.exe' } | Select-Object ProcessId,ParentProcessId,CreationDate,CommandLine | Sort-Object CreationDate -Descending | Select-Object -First 12"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-PLAN.md'; Select-String -Path $f -Pattern '^## Objective|^## Scope|^## Tasks|^## Validation|^## Done Criteria' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'; Select-String -Path $f -Pattern '^function Test-PlanCompleteness|^function Ensure-PhasePlansReady|plans_replanned|plan_verification|Reset-IncompletePlanSummaries -Phases' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'; Select-String -Path $f -Pattern 'Ensure-PhasePlansReady -Phases|Replanned \\$replannedCount phase|Plan verification still failing' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' } | Select-Object ProcessId,CreationDate,CommandLine; if(Test-Path (Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1')){ 'controller_present' } else { 'controller_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --abbrev-ref HEAD; git -C $work rev-parse --short HEAD; git -C $work rev-parse --abbrev-ref --symbolic-full-name '@{u}'; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 86180 -or $_.ParentProcessId -eq 86180 } | Select-Object Name,ProcessId,ParentProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work=Join-Path $repo 'tech-web-chatai.2'; $controller=Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1'; if(-not (Test-Path $controller)){ throw \"Controller missing: $controller\" }; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' } | ForEach-Object { Stop-Process -Id $_.ProcessId -Force -ErrorAction SilentlyContinue }; $runId=Get-Date -Format 'yyyyMMdd-HHmmss'; $runDir=Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; New-Item -ItemType Directory -Path $runDir -Force | Out-Null; $startHead=(git -C $work rev-parse HEAD 2>$null).Trim(); $branch=(git -C $work rev-parse --abbrev-ref HEAD 2>$null).Trim(); $upstream=(git -C $work rev-parse --abbrev-ref --symbolic-full-name '@{u}' 2>$null).Trim(); $meta=[ordered]@{ run_id=$runId; started_at=(Get-Date).ToString('s'); repo_root=$repo; work_root=$work; branch=$branch; upstream=$upstream; start_head=$startHead; }; $metaPath=Join-Path $runDir 'session-meta.json'; $meta | ConvertTo-Json -Depth 5 | Set-Content -Path $metaPath -Encoding UTF8; $statusPath=Join-Path $runDir 'status.json'; $workerCommand=\"& '$controller' -RepoRoot '$repo' -WorkRoot '$work' -RunId '$runId' -MaxCycles 200\"; $args=@('-NoExit','-ExecutionPolicy','Bypass','-Command',$workerCommand); $proc=Start-Process -FilePath 'powershell.exe' -ArgumentList $args -WindowStyle Normal -PassThru; [pscustomobject]@{run_id=$runId; worker_pid=$proc.Id; status_path=$statusPath; run_dir=$runDir; session_meta=$metaPath; start_head=$startHead; branch=$branch; upstream=$upstream} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$latest=Get-ChildItem -Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output' -Directory | Where-Object { $_.Name -like 'gsd-auto-dev-*' } | Sort-Object LastWriteTime -Descending | Select-Object -First 1; if($latest){ $status=Join-Path $latest.FullName 'status.json'; $meta=Join-Path $latest.FullName 'session-meta.json'; Write-Host \"LATEST=$($latest.Name)\"; if(Test-Path $meta){ Write-Host '===META==='; Get-Content $meta -Raw }; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw } else { 'status_missing' } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; Get-ChildItem -Path (Join-Path $repo '.planning\\agent-output') -Directory | Where-Object { $_.Name -like 'gsd-auto-dev-*' } | Sort-Object LastWriteTime -Descending | Select-Object -First 5 Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work=Join-Path $repo 'tech-web-chatai.2'; $controller=Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1'; if(-not (Test-Path $controller)){ throw \"missing controller\" }; $runId=Get-Date -Format 'yyyyMMdd-HHmmss'; $cmd=\"& '$controller' -RepoRoot '$repo' -WorkRoot '$work' -RunId '$runId' -MaxCycles 200\"; $p=Start-Process -FilePath 'powershell.exe' -ArgumentList @('-NoExit','-ExecutionPolicy','Bypass','-Command',$cmd) -WindowStyle Normal -PassThru; Write-Output (\"RUN_ID=\"+$runId); Write-Output (\"PID=\"+$p.Id); Write-Output (\"RUN_DIR=\"+(Join-Path $repo ('.planning\\agent-output\\gsd-auto-dev-'+$runId)));"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --short HEAD; git -C $work rev-parse HEAD; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-183431'; Start-Sleep -Seconds 3; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw } else { 'status_missing' }; if(Test-Path $log){ Write-Host '===LOG==='; Get-Content $log | Select-Object -Last 20 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $start='2e983e985d5356ce544f49bbb0e6fff51dcdc77f'; git -C $work rev-parse --short HEAD; git -C $work rev-list --count \"$start..HEAD\"; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-183431'; if(Test-Path $runDir){ Get-ChildItem $runDir | Sort-Object LastWriteTime -Descending | Select-Object -First 12 Name,Length,LastWriteTime }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; if(Test-Path $road){ Select-String -Path $road -Pattern '^- \\[[ x]\\] \\*\\*Phase\\s+(66|67|68|69)\\b.*' | ForEach-Object { $_.Line } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-183431'; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' -and $_.CommandLine -match $runId } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-183431'; $runDir=\"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-$runId\"; $log=Join-Path $runDir 'controller.log'; if(Test-Path $log){ Get-Content $log | Select-Object -Last 50 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runId='20260221-183431'; $runDir=\"c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-$runId\"; $status=Join-Path $runDir 'status.json'; if(Test-Path $status){ Get-Content $status -Raw } else { 'status_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$p=Get-Process -Id 98948 -ErrorAction SilentlyContinue; if($p){ $cpu1=$p.CPU; Start-Sleep -Seconds 10; $p2=Get-Process -Id 98948 -ErrorAction SilentlyContinue; $cpu2=if($p2){$p2.CPU}else{$null}; [pscustomobject]@{worker_alive=($p2 -ne $null);cpu_before=$cpu1;cpu_after_10s=$cpu2;cpu_delta_10s=if($cpu1 -ne $null -and $cpu2 -ne $null){[math]::Round(($cpu2-$cpu1),4)}else{$null};responding=if($p2){$p2.Responding}else{$null}} | ConvertTo-Json -Compress } else { '{\"worker_alive\":false}' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-183431'; $out=Join-Path $runDir 'cycle-001.stdout.log'; if(Test-Path $out){ Get-Content $out | Select-Object -Last 80 } else { 'cycle-001.stdout.log missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-183431'; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; $out=Join-Path $runDir 'cycle-001.stdout.log'; $now=Get-Date; [pscustomobject]@{status_exists=(Test-Path $status); status_lastwrite=if(Test-Path $status){(Get-Item $status).LastWriteTime}else{$null}; status_age_min=if(Test-Path $status){[math]::Round(($now-(Get-Item $status).LastWriteTime).TotalMinutes,2)}else{$null}; log_exists=(Test-Path $log); log_lastwrite=if(Test-Path $log){(Get-Item $log).LastWriteTime}else{$null}; log_age_min=if(Test-Path $log){[math]::Round(($now-(Get-Item $log).LastWriteTime).TotalMinutes,2)}else{$null}; cycle001_exists=(Test-Path $out); cycle001_lastwrite=if(Test-Path $out){(Get-Item $out).LastWriteTime}else{$null}; cycle001_size=if(Test-Path $out){(Get-Item $out).Length}else{$null}} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-183431'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $log){ Get-Content $log | Select-Object -Last 25 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$targets=Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' }; $k=@(); foreach($t in $targets){ try { Stop-Process -Id $t.ProcessId -Force -ErrorAction Stop; $k += $t.ProcessId } catch {} }; [pscustomobject]@{killed=$k;count=$k.Count} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $road=Join-Path $work '.planning\\ROADMAP.md'; Select-String -Path $road -Pattern 'Phase 66|Phase 67|Phase 68|Phase 69' -Context 0,1 | ForEach-Object { $_.Context.PreContext + $_.Line + $_.Context.PostContext }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $state=Join-Path $work '.planning\\STATE.md'; if(Test-Path $state){ Get-Content $state -TotalCount 120 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; Get-ChildItem -Path (Join-Path $work '.planning\\phases') -Directory | Where-Object { $_.Name -match '^(66|67|68|69)' } | Sort-Object Name | Select-Object Name,FullName"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js init phase-op \"66\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js phase insert \"66\" \"OpenAPI controller parity scope split: route groups A (admin/auth/billing/core)\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$road='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; $lines=Get-Content $road; for($i=1;$i -le $lines.Count;$i++){ if($i -ge 1 -and $i -le 220){ if($lines[$i-1] -match 'Phase 66|Phase 67|Phase 68|Phase 69|Status: Active remediation|required|Pending'){ '{0,4}: {1}' -f $i,$lines[$i-1] } } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases' -Directory | Where-Object { $_.Name -match '^\\d+\\.\\d+' } | Select-Object -First 20 Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md'){ Get-Content -Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md' -TotalCount 100 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if(Test-Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-RESEARCH.md'){ Get-Content -Path 'c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-RESEARCH.md' -TotalCount 80 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $src=Join-Path $root 'docs\\review\\layers\\deterministic-parity.phase66.json'; if(-not (Test-Path $src)){ throw 'missing source parity json' }; $obj=Get-Content $src -Raw | ConvertFrom-Json; $m=@($obj.details.openApiAllControllers.missingInOpenApi); $e=@($obj.details.openApiAllControllers.extraInOpenApi); $batchAPrefixes=@('admin','auth','billing','dashboard','directory','help','invoices','limits','memory'); function GroupRoutes([object[]]$routes){ $a=@(); $b=@(); foreach($r in $routes){ if(-not $r){ continue }; $first=($r -replace '^/+','').Split('/')[0].ToLowerInvariant(); if($batchAPrefixes -contains $first){ $a+=$r } else { $b+=$r } }; return @{a=$a;b=$b} }; $gm=GroupRoutes $m; $ge=GroupRoutes $e; $outA=[ordered]@{ phase='66'; label='openapi-controller-parity-batch-a'; prefixes=$batchAPrefixes; missingInOpenApi_count=$gm.a.Count; extraInOpenApi_count=$ge.a.Count; missingInOpenApi=$gm.a; extraInOpenApi=$ge.a; generated_at=(Get-Date).ToString('s') }; $outB=[ordered]@{ phase='66.1'; label='openapi-controller-parity-batch-b'; prefixes='all remaining route groups not in batch A'; missingInOpenApi_count=$gm.b.Count; extraInOpenApi_count=$ge.b.Count; missingInOpenApi=$gm.b; extraInOpenApi=$ge.b; generated_at=(Get-Date).ToString('s') }; $dstA=Join-Path $root 'docs\\review\\layers\\openapi-controller-workset.phase66-a.json'; $dstB=Join-Path $root 'docs\\review\\layers\\openapi-controller-workset.phase66-1-b.json'; $outA | ConvertTo-Json -Depth 8 | Set-Content -Path $dstA -Encoding UTF8; $outB | ConvertTo-Json -Depth 8 | Set-Content -Path $dstB -Encoding UTF8; [pscustomobject]@{phase66_a_missing=$gm.a.Count;phase66_a_extra=$ge.a.Count;phase66_1_b_missing=$gm.b.Count;phase66_1_b_extra=$ge.b.Count;file_a=$dstA;file_b=$dstB} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-PLAN.md'); foreach($f in $files){ if(Test-Path $f){ $t=Get-Content $f -Raw; [pscustomobject]@{file=$f;chars=$t.Length;tasks=([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count;valid=([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count;hasObjective=($t -match '## Objective');hasScope=($t -match '## Scope');hasTasks=($t -match '## Tasks');hasValidation=($t -match '## Validation');hasDone=($t -match '## Done Criteria')} } } | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-PLAN.md'); $rows=@(); foreach($f in $files){ if(Test-Path $f){ $t=Get-Content $f -Raw; $rows += [pscustomobject]@{file=$f;chars=$t.Length;tasks=([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count;valid=([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count;hasObjective=($t -match '## Objective');hasScope=($t -match '## Scope');hasTasks=($t -match '## Tasks');hasValidation=($t -match '## Validation');hasDone=($t -match '## Done Criteria')} } }; $rows | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'; Select-String -Path $f -Pattern '^function Get-PendingPhases|^function Reset-IncompletePlanSummaries|^function Get-PhasePlanFiles|^function Ensure-PhasePlansReady|phase = if \\(\\$initialMetrics.pending_count' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$root='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; if(Test-Path (Join-Path $root 'scripts\\sdlc\\check-stale-report-claims.ps1')){'exists'} else {'missing'}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66.1-openapi-controller-surface-parity-batch-b\\66.1-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-PLAN.md'); $rows=@(); foreach($f in $files){ if(Test-Path $f){ $t=Get-Content $f -Raw; $missing=@(); foreach($s in @('## Objective','## Scope','## Tasks','## Validation','## Done Criteria')){ if($t -notmatch [regex]::Escape($s)){ $missing += $s } }; $rows += [pscustomobject]@{file=$f;chars=$t.Length;tasks=([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count;valid=([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count;missing=($missing -join ',');pass=((($missing.Count -eq 0) -and (([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count -ge 5) -and (([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count -ge 2) -and ($t.Length -ge 1200)))} } }; $rows | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66.1-openapi-controller-surface-parity-batch-b\\66.1-01-PLAN.md'; Select-String -Path $f -Pattern '^phase_id:|^# Phase 66\\.1:|^## Objective|^## Scope|^## Tasks|^## Validation|^## Done Criteria' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-controller.ps1'; Select-String -Path $f -Pattern '^function Normalize-PhaseToken|^function Get-PhasePrefix|^function Get-PendingPhases|^function Test-PlanCompleteness|^function Ensure-PhasePlansReady|plan verification failed; plans_replanned|Reset-IncompletePlanSummaries -Phases' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\STATE.md'; Select-String -Path $f -Pattern '^Generated:|^Phase:|^Plan:|Phase 66\\.1|openapi-controller-workset' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\ROADMAP.md'; Select-String -Path $f -Pattern '^Status:|\\*\\*Phase 66:|\\*\\*Phase 66\\.1:|\\*\\*Phase 67:|\\*\\*Phase 69:' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$files=@('c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66-openapi-controller-surface-parity\\66-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\66.1-openapi-controller-surface-parity-batch-b\\66.1-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md','c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-PLAN.md'); $rows=@(); foreach($f in $files){ $t=Get-Content $f -Raw; $rows += [pscustomobject]@{file=$f;chars=$t.Length;tasks=([regex]::Matches($t,'(?m)^\\d+\\.\\s+')).Count;valid=([regex]::Matches($t,'(?m)^-\\s+`[^`]+`')).Count} }; $rows | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\69-stale-report-contradiction-remediation\\69-01-PLAN.md'; Select-String -Path $f -Pattern '^# Phase 69|^## Objective|^## Scope|^## Tasks|^## Validation|^## Done Criteria' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$f='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2\\.planning\\phases\\67-frontend-openapi-client-parity\\67-01-PLAN.md'; Select-String -Path $f -Pattern '^# Phase 67:|^## Objective|^## Scope|^## Tasks|^## Validation|^## Done Criteria' | Select-Object LineNumber,Line"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; Get-ChildItem -Path (Join-Path $work '.planning\\phases') -Directory | Where-Object { $_.Name -match '^(66|66\\.1|67|69)' } | Sort-Object {[double](($_.Name -split '-')[0])},Name | Select-Object Name"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work=Join-Path $repo 'tech-web-chatai.2'; $controller=Join-Path $repo '.planning\\agent-output\\gsd-auto-dev-controller.ps1'; if(-not (Test-Path $controller)){ throw \"Controller missing: $controller\" }; Get-CimInstance Win32_Process | Where-Object { $_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' } | ForEach-Object { Stop-Process -Id $_.ProcessId -Force -ErrorAction SilentlyContinue }; $runId=Get-Date -Format 'yyyyMMdd-HHmmss'; $runDir=Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; New-Item -ItemType Directory -Path $runDir -Force | Out-Null; $startHead=(git -C $work rev-parse HEAD 2>$null).Trim(); $branch=(git -C $work rev-parse --abbrev-ref HEAD 2>$null).Trim(); $upstream=(git -C $work rev-parse --abbrev-ref --symbolic-full-name '@{u}' 2>$null).Trim(); $meta=[ordered]@{ run_id=$runId; started_at=(Get-Date).ToString('s'); repo_root=$repo; work_root=$work; branch=$branch; upstream=$upstream; start_head=$startHead; max_cycles=200 }; $metaPath=Join-Path $runDir 'session-meta.json'; $meta | ConvertTo-Json -Depth 6 | Set-Content -Path $metaPath -Encoding UTF8; $statusPath=Join-Path $runDir 'status.json'; $workerCommand=\"& '$controller' -RepoRoot '$repo' -WorkRoot '$work' -RunId '$runId' -MaxCycles 200\"; $args=@('-NoExit','-ExecutionPolicy','Bypass','-Command',$workerCommand); $p=Start-Process -FilePath 'powershell.exe' -ArgumentList $args -WindowStyle Normal -PassThru; [pscustomobject]@{run_id=$runId;worker_pid=$p.Id;run_dir=$runDir;status_path=$statusPath;session_meta=$metaPath;start_head=$startHead;branch=$branch;upstream=$upstream} | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repo='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2'; $work=Join-Path $repo 'tech-web-chatai.2'; $runId='20260221-190713'; $runDir=Join-Path $repo \".planning\\agent-output\\gsd-auto-dev-$runId\"; $meta=[ordered]@{ run_id=$runId; started_at=(Get-Date).ToString('s'); repo_root=$repo; work_root=$work; start_head=(git -C $work rev-parse HEAD 2>$null).Trim(); branch=(git -C $work rev-parse --abbrev-ref HEAD 2>$null).Trim(); upstream=(git -C $work rev-parse --abbrev-ref --symbolic-full-name '@{u}' 2>$null).Trim(); max_cycles=200; worker_pid=73576 }; $meta | ConvertTo-Json -Depth 6 | Set-Content -Path (Join-Path $runDir 'session-meta.json') -Encoding UTF8; Get-Content -Path (Join-Path $runDir 'session-meta.json') -Raw"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ProcessId -eq 73576 -or ($_.Name -eq 'powershell.exe' -and $_.CommandLine -match 'gsd-auto-dev-controller\\.ps1' -and $_.CommandLine -match '20260221-190713') } | Select-Object ProcessId,CreationDate,CommandLine"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; git -C $work rev-parse --short HEAD; git -C $work rev-list --count 'b0218b31806bf05dcf94c62d49ca34aa7e424f73..HEAD'; git -C $work rev-list --left-right --count '@{u}...HEAD'"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\.planning\\agent-output\\gsd-auto-dev-20260221-190713'; Start-Sleep -Seconds 4; $status=Join-Path $runDir 'status.json'; $log=Join-Path $runDir 'controller.log'; if(Test-Path $status){ Write-Host '===STATUS==='; Get-Content $status -Raw } else { 'status_missing' }; if(Test-Path $log){ Write-Host '===LOG==='; Get-Content $log | Select-Object -Last 30 } else { 'log_missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" roadmap analyze"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init progress --include state,roadmap,project,config"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" progress bar --raw"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init progress --include state,roadmap,project,config | ConvertFrom-Json; [pscustomobject]@{ project_exists=$j.project_exists; roadmap_exists=$j.roadmap_exists; state_exists=$j.state_exists; milestone_version=$j.milestone_version; completed_count=$j.completed_count; phase_count=$j.phase_count; current_phase=($j.current_phase | ConvertTo-Json -Compress); next_phase=($j.next_phase | ConvertTo-Json -Compress); paused_at=$j.paused_at; model_profile=$j.config.model_profile } | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init progress --include state,roadmap,project,config | ConvertFrom-Json; [pscustomobject]@{ has_config=($null -ne $j.config); has_config_content=($null -ne $j.config_content); config_type=($j.config.GetType().FullName); config_content_type=($j.config_content.GetType().FullName) } | ConvertTo-Json -Compress"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.Name -match 'powershell|pwsh' } | Select-Object ProcessId, Name, CreationDate, CommandLine | Sort-Object CreationDate | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output\" -Recurse -File | Where-Object { $_.Name -match '20260221-190713|status|progress|cycle|summary|report|log' } | Select-Object FullName,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Select-Object -First 40 | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output\" -Force | Select-Object Name,LastWriteTime,Length,Mode | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-190713\" -Recurse -File | Select-Object FullName,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-190713\" -Recurse -File | Sort-Object LastWriteTime -Descending | Select-Object -First 30 @{Name='Path';Expression={$_.FullName.Replace((Get-Location).Path + '\\\\','')}}, LastWriteTime, Length | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 73576 | Select-Object Id,ProcessName,StartTime,CPU,WS,PM,Handles,Responding | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 73576 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Process -Id 57180 | Select-Object Id,ProcessName,StartTime,CPU,WS,PM,Handles,Responding | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 57180 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 87056,58852; foreach ($pid in $ids) { Write-Output \"--- Parent PID $pid ---\"; Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq $pid } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$idList = 87056,58852; foreach ($procId in $idList) { Write-Output \"--- Parent PID $procId ---\"; Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq $procId } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 121252 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 69116 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 131816 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 73576,57180,121252,131816; $before = @{}; foreach ($i in $ids) { try { $p=Get-Process -Id $i -ErrorAction Stop; $before[$i]=$p.CPU } catch {} }; Start-Sleep -Seconds 5; foreach ($i in $ids) { try { $p=Get-Process -Id $i -ErrorAction Stop; $delta = [math]::Round(($p.CPU - $before[$i]),3); [pscustomobject]@{ Id=$i; Name=$p.ProcessName; CPU=$p.CPU; Delta5s=$delta; Responding=$p.Responding } } catch { [pscustomobject]@{ Id=$i; Name='(exited)'; CPU=$null; Delta5s=$null; Responding=$null } } } | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 73576,57180,121252,131816; $before = @{}; foreach ($i in $ids) { try { $p=Get-Process -Id $i -ErrorAction Stop; $before[$i]=$p.CPU } catch {} }; Start-Sleep -Seconds 5; $rows = @(); foreach ($i in $ids) { try { $p=Get-Process -Id $i -ErrorAction Stop; $delta = [math]::Round(($p.CPU - $before[$i]),3); $rows += [pscustomobject]@{ Id=$i; Name=$p.ProcessName; CPU=$p.CPU; Delta5s=$delta; Responding=$p.Responding } } catch { $rows += [pscustomobject]@{ Id=$i; Name='(exited)'; CPU=$null; Delta5s=$null; Responding=$null } } }; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \".planning/agent-output/gsd-auto-dev-20260221-190713/*\" | Select-Object Name,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-190713/incomplete-summary-archive\" -Recurse -File | Select-Object FullName,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$repoRoot = (Get-Location).Path; $workRoot = Join-Path $repoRoot \"tech-web-chatai.2\"; $scriptPath = Join-Path $repoRoot \".planning\\agent-output\\gsd-auto-dev-controller.ps1\"; if (-not (Test-Path $scriptPath)) { throw \"Controller script not found: $scriptPath\" }; $runId = Get-Date -Format \"yyyyMMdd-HHmmss\"; $argList = \"-NoExit -ExecutionPolicy Bypass -Command & '$scriptPath' -RepoRoot '$repoRoot' -WorkRoot '$workRoot' -RunId '$runId' -MaxCycles 200\"; Start-Process -FilePath \"powershell.exe\" -ArgumentList $argList -WindowStyle Normal; Write-Output $runId"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \".planning/agent-output/gsd-auto-dev-20260221-191233\" | Select-Object FullName,LastWriteTime | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$meta = Get-Content \".planning/agent-output/gsd-auto-dev-20260221-191233/session-meta.json\" | ConvertFrom-Json; git rev-list --count \"$($meta.start_head)..HEAD\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -like '*20260221-191233*' -or $_.CommandLine -like '*gsd-auto-dev-controller.ps1*' } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-191233\" -Force | Select-Object Name,LastWriteTime,Length,Mode | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$statusPath = \".planning/agent-output/gsd-auto-dev-20260221-191233/status.json\"; $logPath = \".planning/agent-output/gsd-auto-dev-20260221-191233/controller.log\"; Start-Sleep -Seconds 25; Write-Output \"--- status ---\"; if (Test-Path $statusPath) { Get-Content $statusPath }; Write-Output \"--- log tail ---\"; if (Test-Path $logPath) { Get-Content $logPath -Tail 20 }; Write-Output \"--- process ---\"; Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -like '*RunId ''20260221-191233''*' -or $_.CommandLine -like '*gsd-auto-dev-controller.ps1*20260221-191233*' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -like '*RunId ''20260221-191233''*' -or $_.CommandLine -like '*gsd-auto-dev-controller.ps1*20260221-191233*' } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "if (Test-Path \".planning/agent-output/gsd-auto-dev-20260221-191233/session-meta.json\") { $meta = Get-Content \".planning/agent-output/gsd-auto-dev-20260221-191233/session-meta.json\" | ConvertFrom-Json; if ($meta.start_head -and $meta.work_root) { git -C $meta.work_root rev-list --count \"$($meta.start_head)..HEAD\" } else { 0 } } else { 0 }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 87980 } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-191233\" -Recurse -File | Select-Object FullName,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Select-Object -First 20 | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 87980 } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$start='2026-02-21 19:12:33'; $work='tech-web-chatai.2'; $base = git -C $work rev-list -1 --before=\"$start\" HEAD; if ($base) { git -C $work rev-list --count \"$base..HEAD\" } else { git -C $work rev-list --count HEAD }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='tech-web-chatai.2'; $up=(git -C $work rev-parse --abbrev-ref --symbolic-full-name \"@{u}\" 2>$null); if ($LASTEXITCODE -eq 0 -and $up) { git -C $work rev-list --left-right --count \"$up...HEAD\" } else { 'no-upstream' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='tech-web-chatai.2'; $start='2026-02-21 19:12:33'; git -C $work log --since=\"$start\" --pretty=format:\"%h %ad %s\" --date=iso --max-count=10"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$phases='66','66.1','67','69'; $phasesRoot='tech-web-chatai.2/.planning/phases'; foreach($p in $phases){ if($p -match '\\.') { $prefix=$p } else { $prefix = '{0:D2}' -f [int]$p }; $dirs=Get-ChildItem -Path $phasesRoot -Directory -Filter \"$prefix-*\" -ErrorAction SilentlyContinue; $plan=0; $sum=0; foreach($d in $dirs){ $plan += (Get-ChildItem -Path $d.FullName -File -Filter \"$prefix-*-PLAN.md\" -ErrorAction SilentlyContinue | Measure-Object).Count; $sum += (Get-ChildItem -Path $d.FullName -File -Filter \"$prefix-*-SUMMARY.md\" -ErrorAction SilentlyContinue | Measure-Object).Count }; [pscustomobject]@{Phase=$p;Directories=$dirs.Count;PlanCount=$plan;SummaryCount=$sum} } | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-191233\" -Recurse -File | Select-Object FullName,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Select-Object -First 30 | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Item \".planning/agent-output/gsd-auto-dev-20260221-191233/status.json\" -ErrorAction SilentlyContinue | Select-Object FullName,LastWriteTime,Length | Format-List; Get-Content \".planning/agent-output/gsd-auto-dev-20260221-191233/status.json\" -ErrorAction SilentlyContinue"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 87980,113976; $before=@{}; foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $before[$id]=[double]$p.CPU } catch{} }; Start-Sleep -Seconds 8; $rows=@(); foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $delta=[math]::Round(([double]$p.CPU - $before[$id]),3); $rows += [pscustomobject]@{ Id=$id; Name=$p.ProcessName; CPU=[math]::Round([double]$p.CPU,3); Delta8s=$delta; Responding=$p.Responding } } catch { $rows += [pscustomobject]@{ Id=$id; Name='(exited)'; CPU=$null; Delta8s=$null; Responding=$null } } }; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$runDir = \".planning/agent-output/gsd-auto-dev-20260221-191233\"; Get-ChildItem -Path $runDir -Filter \"cycle-001*.log\" -File -ErrorAction SilentlyContinue | Select-Object Name,LastWriteTime,Length | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 113976 } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$pids = @(Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 113976 } | Select-Object -ExpandProperty ProcessId); if ($pids.Count -gt 0) { Get-Process -Id $pids -ErrorAction SilentlyContinue | Select-Object Id,ProcessName,StartTime,CPU,Responding | Format-Table -AutoSize }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$children = Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 113976 }; if ($children) { $ids = $children.ProcessId; foreach ($cid in $ids) { Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq $cid } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List } }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-Date -Format \"yyyy-MM-dd HH:mm:ss\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -in 97220,82960 } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 113976,77760,97220,82960; $before=@{}; foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $before[$id]=[double]$p.CPU } catch{} }; Start-Sleep -Seconds 8; $rows=@(); foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $delta=[math]::Round(([double]$p.CPU - $before[$id]),3); $rows += [pscustomobject]@{ Id=$id; Name=$p.ProcessName; CPU=[math]::Round([double]$p.CPU,3); Delta8s=$delta; Responding=$p.Responding } } catch { $rows += [pscustomobject]@{ Id=$id; Name='(exited)'; CPU=$null; Delta8s=$null; Responding=$null } } }; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='tech-web-chatai.2'; $start='2026-02-21 19:12:33'; git -C $work log --since=\"$start\" --pretty=format:\"%h %ad %s\" --date=iso --max-count=6"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='tech-web-chatai.2'; $start='2026-02-21 19:12:33'; git -C $work log --since=\"$start\" --pretty=format:\"%h %ad %s\" --date=iso --max-count=12"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/agent-output/gsd-auto-dev-20260221-191233\" -Force | Select-Object Name,LastWriteTime,Length | Sort-Object LastWriteTime -Descending | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='tech-web-chatai.2'; git -C $work log --since=\"2026-02-21 19:42:02\" --pretty=format:\"%h %ad %s\" --date=iso --max-count=5"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 87980; $before=@{}; foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $before[$id]=[double]$p.CPU } catch{} }; Start-Sleep -Seconds 8; $rows=@(); foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $delta=[math]::Round(([double]$p.CPU - $before[$id]),3); $rows += [pscustomobject]@{ Id=$id; Name=$p.ProcessName; CPU=[math]::Round([double]$p.CPU,3); Delta8s=$delta; Responding=$p.Responding } } catch { $rows += [pscustomobject]@{ Id=$id; Name='(exited)'; CPU=$null; Delta8s=$null; Responding=$null } } }; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.ParentProcessId -eq 76000 } | Select-Object ProcessId,ParentProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$ids = 76000; $before=@{}; foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $before[$id]=[double]$p.CPU } catch{} }; Start-Sleep -Seconds 8; $rows=@(); foreach($id in $ids){ try{ $p=Get-Process -Id $id -ErrorAction Stop; $delta=[math]::Round(([double]$p.CPU - $before[$id]),3); $rows += [pscustomobject]@{ Id=$id; Name=$p.ProcessName; CPU=[math]::Round([double]$p.CPU,3); Delta8s=$delta; Responding=$p.Responding } } catch { $rows += [pscustomobject]@{ Id=$id; Name='(exited)'; CPU=$null; Delta8s=$null; Responding=$null } } }; $rows | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$pid = 87980; if (Get-Process -Id $pid -ErrorAction SilentlyContinue) { Stop-Process -Id $pid -Force -ErrorAction Stop; \"stopped:$pid\" } else { \"not-running:$pid\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$targetPid = 87980; if (Get-Process -Id $targetPid -ErrorAction SilentlyContinue) { Stop-Process -Id $targetPid -Force -ErrorAction Stop; \"stopped:$targetPid\" } else { \"not-running:$targetPid\" }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init phase-op \"66\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init phase-op \"66.1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init phase-op \"67\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" init phase-op \"69\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" phase remove \"69\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" phase remove \"67\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" phase remove \"66.1\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" phase remove \"66\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" commit \"chore: cancel pending remediation phases 66, 66.1, 67, 69\" --files .planning/"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" commit --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -like '*gsd-auto-dev-controller.ps1*' } | Select-Object ProcessId,Name,CreationDate,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$work='c:\\Users\\rjain\\OneDrive - Technijian, Inc\\Documents\\VSCode\\tech-webt-chatai.2\\tech-web-chatai.2'; $up=(git -C $work rev-parse --abbrev-ref --symbolic-full-name \"@{u}\" 2>$null); if($LASTEXITCODE -eq 0 -and $up){ git -C $work rev-list --left-right --count \"$up...HEAD\" } else { 'no-upstream' }"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" --help"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = Get-Content \"docs/review/layers/deterministic-parity-run.json\" | ConvertFrom-Json; $oc = $j.details.openApiAllControllers; \"controllerRouteCount=$($oc.controllerRouteCount) openApiRouteCount=$($oc.openApiRouteCount) missing=$($oc.missingInOpenApi.Count) extra=$($oc.extraInOpenApi.Count)\"; $oc.byController | Sort-Object routeCount -Descending | Select-Object controller,routeCount | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = Get-Content \"docs/review/layers/stale-report-scan.json\" | ConvertFrom-Json; [pscustomobject]@{ mismatchCount=$j.mismatchCount; scannedFiles=$j.scannedFiles } | ConvertTo-Json -Compress; $j.mismatches | Select-Object source,line,path | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = Get-Content \"docs/review/layers/deterministic-parity-run.json\" | ConvertFrom-Json; $fo = $j.details.frontendOpenApi; [pscustomobject]@{ clientOperationCount=$fo.clientOperationCount; openApiOperationCount=$fo.openApiOperationCount; missingInOpenApiCount=$fo.missingInOpenApi.Count; extraInOpenApiCount=$fo.extraInOpenApi.Count } | ConvertTo-Json -Compress; \"MISSING:\"; $fo.missingInOpenApi; \"EXTRA:\"; $fo.extraInOpenApi"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = Get-Content \"docs/review/layers/stale-report-scan.json\" | ConvertFrom-Json; $rows = @(); foreach($m in $j.mismatches){ $rows += [pscustomobject]@{ source=($m.source -replace [regex]::Escape((Get-Location).Path + '\\\\'),''); line=$m.line; path=$m.path } }; $rows | ConvertTo-Json -Depth 4"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$j = Get-Content \"docs/review/layers/deterministic-parity-run.json\" | ConvertFrom-Json; $missing = $j.details.openApiAllControllers.missingInOpenApi; $extra = $j.details.openApiAllControllers.extraInOpenApi; function Group-Routes($routes){ $map=@{}; foreach($r in $routes){ $parts=$r.Trim('/').Split('/'); if($parts.Count -eq 0){continue}; $key=$parts[0]; if($key -eq 'admin' -and $parts.Count -gt 1){ $key = \"admin/$($parts[1])\" }; if($key -eq 'tenant'){ $key='tenant-*' }; if($key -eq 'tenants'){ $key='tenants-*' }; if(-not $map.ContainsKey($key)){ $map[$key]=0}; $map[$key]++ }; $map.GetEnumerator() | Sort-Object Name }; \"MISSING GROUPS\"; Group-Routes $missing | ForEach-Object {\"$($_.Name): $($_.Value)\"}; \"EXTRA GROUPS\"; Group-Routes $extra | ForEach-Object {\"$($_.Name): $($_.Value)\"}"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "node \"C:/Users/rjain/.claude/get-shit-done/bin/gsd-tools.js\" phase add \"openapi-parity-admin-audit-surface\""], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/phases\" -Directory | Select-Object Name | Sort-Object Name | Format-Table -AutoSize"], decision="allow")
prefix_rule(pattern=["C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-ChildItem -Path \".planning/phases\" -Recurse -File -Filter \"*-CONTEXT.md\" | Select-Object FullName | Sort-Object FullName | Format-Table -AutoSize"], decision="allow")
